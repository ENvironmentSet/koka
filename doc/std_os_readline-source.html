<!DOCTYPE html>
<html>
<!-- NO_CLICK_TRACKING -->

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>readline.kk documentation</title>
</head>

<body class="koka doc body"><div class="madoko">
<pre class="koka source"><span class="comment">/&#42;---------------------------------------------------------------------------
  Copyright 2012-2016 Microsoft Corporation.

  This is free software; you can redistribute it and/or modify it under the
  terms of the Apache License, Version 2.0. A copy of the License can be
  found in the file "license.txt" at the root of this distribution.
---------------------------------------------------------------------------&#42;/</span>

<span class="comment">/&#42; Read user input from the console.

   test &#96;std/async&#96; and &#96;module std/time/instant&#96;.
&#42;/</span>
<span class="kw">module</span> readline

<span class="kw">import</span> async

<span class="kw">external</span> include {
  cs file <span class="st">"readline-inline.cs"</span>
	js file <span class="st">"readline-inline.js"</span>
}

<span class="comment">// Displays &#96;query&#96; to the user (with a space attached) and issues a &#96;readline&#96; for the user response.
</span><span class="decl-fun" id="question"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_os_readline.html#question">question<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>readline<span class="fslash last">/</span></span>question: <span class="tp sp">(</span><span class="tp tpp">query</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">asyncx</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">&gt;</span> <span class="tp">string</span></span></a>( <a class="pp">query<span class="pc">query: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="std_async-source.html#type_space_asyncx"><span class="tp"><span class="effect">asyncx</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>asyncx: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core-source.html#type_space_console"><span class="tp"><span class="effect">console</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
	<a class="pp" href="std_core-source.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">query<span class="pc">query: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">" "</span>)
	<a class="pp" href="#readline">readline<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>readline<span class="fslash last">/</span></span>readline: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">asyncx</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">&gt;</span> <span class="tp">string</span></span></a>()
</span>}

<span class="comment">// Read a line of input from the user.
</span><span class="decl-fun" id="readline"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_os_readline.html#readline">readline<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>readline<span class="fslash last">/</span></span>readline: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">asyncx</span><span class="tp sp">,</span><span class="tp">console</span><span class="tp sp">&gt;</span> <span class="tp">string</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="std_async-source.html#type_space_asyncx"><span class="tp"><span class="effect">asyncx</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>asyncx: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core-source.html#type_space_console"><span class="tp"><span class="effect">console</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>console: <span class="tp">X</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
	<a class="pp" href="std_async-source.html#await_exn1">await-exn1<span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>await<span class="dash">-</span>exn1: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">setup</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">cb</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">null</span><span class="tp sp">&lt;</span><span class="tp">exception</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">async</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a> <span class="kw">fun</span>(<a class="pp">cb<span class="pc">cb: <span class="tp sp">(</span><span class="tp">null</span><span class="tp sp">&lt;</span><span class="tp">exception</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>) {
		<span class="kw">val</span> <a class="pp">id<span class="pc">id: <span class="tp">any</span></span></a> <span class="kw">=</span> <a class="pp" href="#prim_readline">prim-readline<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>readline<span class="fslash last">/</span></span>prim<span class="dash">-</span>readline: <span class="tp sp">(</span><span class="tp tpp">cb</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">null</span><span class="tp sp">&lt;</span><span class="tp">exception</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">any</span></span></a>(<a class="pp">cb<span class="pc">cb: <span class="tp sp">(</span><span class="tp">null</span><span class="tp sp">&lt;</span><span class="tp">exception</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>)
		<a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( { <a class="pp" href="#prim_cancel_readline">prim-cancel-readline<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>readline<span class="fslash last">/</span></span>prim<span class="dash">-</span>cancel<span class="dash">-</span>readline: <span class="tp sp">(</span><span class="tp tpp">id</span> <span class="tp kw op">:</span> <span class="tp">any</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">id<span class="pc">id: <span class="tp">any</span></span></a>) })
	}
</span>}

<span class="decl-fun" id="prim_readline"><span class="kw">extern</span> <a class="pp" href="std_os_readline.html#prim_readline">prim-readline<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>readline<span class="fslash last">/</span></span>prim<span class="dash">-</span>readline: <span class="tp sp">(</span><span class="tp tpp">cb</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">null</span><span class="tp sp">&lt;</span><span class="tp">exception</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">any</span></span></a>( <a class="pp">cb<span class="pc">cb: <span class="tp sp">(</span><span class="tp">null</span><span class="tp sp">&lt;</span><span class="tp">exception</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="std_core-source.html#type_space_null"><span class="tp">null</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>null: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_exception"><span class="tp">exception</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exception: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">,</span><a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="std_core-source.html#type_space_any"><span class="tp">any</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>any: <span class="tp">V</span></span></a> {
  cs <span class="st">"&#95;Readline.Readline"</span>
	js <span class="st">"&#95;readline"</span>
</span>}

<span class="decl-fun" id="prim_cancel_readline"><span class="kw">extern</span> <a class="pp" href="std_os_readline.html#prim_cancel_readline">prim-cancel-readline<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>readline<span class="fslash last">/</span></span>prim<span class="dash">-</span>cancel<span class="dash">-</span>readline: <span class="tp sp">(</span><span class="tp tpp">id</span> <span class="tp kw op">:</span> <span class="tp">any</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <a class="pp">id<span class="pc">id: <span class="tp">any</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_any"><span class="tp">any</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>any: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> {
  cs <span class="st">"&#95;Readline.CancelReadline"</span>
	js <span class="st">"&#95;cancel&#95;readline"</span>
</span>}
</pre>

</div></body>
</html>
