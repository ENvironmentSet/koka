
<!DOCTYPE html>
<html>
<!-- NO_CLICK_TRACKING -->

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>std/time/ut1 documentation</title>
</head>

<body class="koka doc body"><div class="madoko">
<h1><a class="link" href="std_time_ut1-source.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1</span></a><a class="link" href="toc.html"><span class="toc-link">&#x25b2;toc</span></a></h1>
<div class="toc code"><ul class="toc"><li><a class="link" href="#deltat"><span class="kw">fun</span>&nbsp;deltat</a></li><li><a class="link" href="#load_iersA"><span class="kw">fun</span>&nbsp;load<span class="dash">-</span>iersA</a></li><li><a class="link" href="#load_iersA_all"><span class="kw">fun</span>&nbsp;load<span class="dash">-</span>iersA<span class="dash">-</span>all</a></li><li><a class="link" href="#load_iersA_daily"><span class="kw">fun</span>&nbsp;load<span class="dash">-</span>iersA<span class="dash">-</span>daily</a></li><li><a class="link" href="#ts_ut1_approx"><span class="kw">val</span>&nbsp;ts<span class="dash">-</span>ut1<span class="dash">-</span>approx</a></li><li><a class="link" href="#ts_ut1_create"><span class="kw">fun</span>&nbsp;ts<span class="dash">-</span>ut1<span class="dash">-</span>create</a></li><li><a class="link" href="#ts_ut1_load"><span class="kw">fun</span>&nbsp;ts<span class="dash">-</span>ut1<span class="dash">-</span>load</a></li><li><a class="link" href="#ts_ut2_approx"><span class="kw">val</span>&nbsp;ts<span class="dash">-</span>ut2<span class="dash">-</span>approx</a></li><li><a class="link" href="#ts_ut2_create"><span class="kw">fun</span>&nbsp;ts<span class="dash">-</span>ut2<span class="dash">-</span>create</a></li></ul></div>
<div class="doc koka comment">

<p class="p noindent"> The UT1 (and UT2) time scale and calendar.
</p>
<p class="p indent">The UT1 time scale is based on the rotation of the earth where one rotation is 86400 seconds.
The exact UT1 time can only be determined by measuring the Earth&#39;s rotation angle very precisely.
The International Earth Rotation Service
(IERS) issues&nbsp;<a href="https://www.iers.org/IERS/EN/Publications/Bulletins/bulletins.html">bulletin A</a>
containing accurate (UT1 - UTC) deltas.
</p>
<p class="p indent">The library provides the <code class="koka">cal<span class="dash">-</span>ut1<span class="dash">-</span>load</code> function to automatically cache and download the latest USNO
bulletin A information (<code class="code code2">finals2000A</code> <code class="code code2">all</code> and <code class="code code2">daily</code>) to calculate UT1 very accurately from
1972 until about 3 months from now (using predicted values). By default it downloads daily data
every week and full data about every 8 weeks. For dates outside this range, the library uses its builtin
tables and approximations:
</p>
<ul class="ul list-star compact">
<li class="li ul-li list-star-li compact-li">monthly determined tables for any observed date (usually &gt; 1973 up to the compiler release (2019))
</li>
<li class="li ul-li list-star-li compact-li">quarterly prediction tables for dates after that (2019) up to about 10 years (2027)
</li>
<li class="li ul-li list-star-li compact-li">yearly historic tables for dates &gt;= 1750 and before 1973
</li>
<li class="li ul-li list-star-li compact-li">fitted parabolic approximations for dates between -500 and 2150; (Espenak &amp; Meeus 2006)
</li>
<li class="li ul-li list-star-li compact-li">generic parabolic approximation for dates &lt; -500 and dates &gt; 2150 (Morrison and Stephenson, 2004.)
</li></ul>

<p class="p noindent">You can also use <code class="koka">cal<span class="dash">-</span>ut1<span class="dash">-</span>approx</code> to not download any recent data and always use approximated values.
</p>
<p class="p indent">Usage:
</p>
<p class="p indent"><pre class="koka source"><span class="plaincode">val cal-ut1 = cal-ut1-load()
val i = now()
i.time().show.println              // in UTC
i.time(cal=cal-ut1).show.println   // in UT1
</span><span class="nicecode"><span class="kw">val</span> cal<span class="dash">-</span>ut1 <span class="kw">=</span> cal<span class="dash">-</span>ut1<span class="dash">-</span>load()
<span class="kw">val</span> i <span class="kw">=</span> now()
i<span class="kw op">.</span>time()<span class="kw op">.</span>show<span class="kw op">.</span>println              <span class="comment">// in UTC
</span>i<span class="kw op">.</span>time(cal<span class="kw">=</span>cal<span class="dash">-</span>ut1)<span class="kw op">.</span>show<span class="kw op">.</span>println   <span class="comment">// in UT1
</span></span></pre>.
</p></div>
<div class="decl" id="deltat"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_ut1-source.html#deltat">deltat</a></span>( <span class="tp tpp">i</span> <span class="tp sp">:</span>&nbsp;<a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>, <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp sp">:</span>&nbsp;<a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a></div><div class="doc koka comment">

<p class="p noindent"> Calculate &#916;T (= TT - UT1);
If the <code class="koka">dt<span class="dash">-</span>override</code> function returns <code class="koka"><a class="pp" href="std_core.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>, it tries in order:
</p>
<ul class="ul list-star compact">
<li class="li ul-li list-star-li compact-li">monthly determined tables for any observed date (usually &gt; 1973 up to now (2016))
</li>
<li class="li ul-li list-star-li compact-li">quarterly prediction tables for dates &gt; now (2016) up to about 10 years (2025)
</li>
<li class="li ul-li list-star-li compact-li">yearly historic tables for dates &gt;= 1750
</li>
<li class="li ul-li list-star-li compact-li">fitted parabolic approximations for dates between -500 and 2150; (Espenak &amp; Meeus 2006)
</li>
<li class="li ul-li list-star-li compact-li">generic parabolic approximation for dates &lt; -500 and dates &gt; 2150 (Morrison and Stephenson, 2004.).
</div></div>
<div class="decl" id="load_iersA"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_ut1-source.html#load_iersA">load<span class="dash">-</span>iersA</a></span>( <span class="tp tpp">basename</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">baseurl</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">verbose</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> ) <span class="tp sp">:</span>&nbsp;<span class="tp sp">&lt;</span><a class="pp" href="std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span></div><div class="doc koka comment">
 Load&nbsp;<a href="http://www.usno.navy.mil/USNO/earth-orientation/eo-products/weekly">IERS bulletin A</a>
 information for precise UT1 determination. Loads and caches both the <em class="em-low1">daily</em> and <em class="em-low1">all</em>
 data. Downloads a fresh daily file about every week (<code class="koka">download<span class="dash">-</span>delay</code>) with a given <code class="koka">download<span class="dash">-</span>timeout</code> (=<code class="koka"><span class="number">5</span></code>s).
 The full data is refreshed only every <code class="koka"><span class="number">8</span><span class="op">&#42;</span>download<span class="dash">-</span>delay</code> (=<code class="koka"><span class="number">8</span><span class="kw op">.</span><a class="pp" href="std_time_duration.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>). The <code class="koka"><a class="pp" href="std_os_path.html#basename">basename<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>basename: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a></code> gives
 the basic file name <code class="koka">finals2000A</code> and the <code class="koka">baseurl</code> the download URL
 (= <a href="http://maia.usno.navy.mil/ser7/" class="texturl monospace">http://&#8203;maia.&#8203;usno.&#8203;navy.&#8203;mil/&#8203;ser7/&#8203;</a>).
 Set the <code class="koka">baseurl</code> to the empty string to suppress automatic downloading. The files are cached
 in the <code class="koka">config<span class="op"><span class="divide">/</span></span></code> directory of the application installation directory.
 Set the optional parameter <code class="koka">verbose</code> to <code class="koka"><a class="pp" href="std_core.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a></code> to suppress trace messages on downloads or errors.
</li></ul>
</div></div>
<div class="decl" id="load_iersA_all"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_ut1-source.html#load_iersA_all">load<span class="dash">-</span>iersA<span class="dash">-</span>all</a></span>( <span class="tp tpp">fname</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">url</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">verbose</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> ) <span class="tp sp">:</span>&nbsp;<span class="tp sp">&lt;</span><a class="pp" href="std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span></div><div class="doc koka comment">

<p class="p noindent">   Load&nbsp;<a href="http://www.usno.navy.mil/USNO/earth-orientation/eo-products/weekly">IERS bulletin A</a>
   information for precise UT1 determination. Loads the full bulletin A data since 1973
   with about 1 year of predictions. Uses linear interpolation between daily UT1-UTC values.
   By default loads the file <code class="koka">fname</code> (= <code class="koka"><span class="st">&#34;config/finals2000A.all&#34;</span></code> in the application directory).
   If the file is not present, it will be downloaded from <code class="koka">url</code>. The default <code class="koka">url</code> is:<br>
   <a href="http://maia.usno.navy.mil/ser7/finals2000A.all" class="texturl monospace">http://&#8203;maia.&#8203;usno.&#8203;navy.&#8203;mil/&#8203;ser7/&#8203;finals2000A.&#8203;all</a><br>
   Set the <code class="koka">url</code> to the empty string to suppress automatic downloading.
   If the file is older than <code class="koka">download<span class="dash">-</span>delay</code> (=<code class="koka"><span class="number">4</span><span class="kw op">.</span><a class="pp" href="std_time_duration.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>) the file is automatically refreshed from <code class="koka">url</code>.
   The <code class="koka">download<span class="dash">-</span>timeout</code> (=<code class="koka"><span class="number">20</span><span class="kw op">.</span>seconds</code>) gives the maximum time for downloading to finish (the
   full data is about 3mb in size).
   Set the optional parameter <code class="koka">verbose</code> to <code class="koka"><a class="pp" href="std_core.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a></code> to suppress trace messages on downloads or errors.
</p></div></div>
<div class="decl" id="load_iersA_daily"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_ut1-source.html#load_iersA_daily">load<span class="dash">-</span>iersA<span class="dash">-</span>daily</a></span>( <span class="tp tpp">fname</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">url</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">verbose</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> ) <span class="tp sp">:</span>&nbsp;<span class="tp sp">&lt;</span><a class="pp" href="std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span></div><div class="doc koka comment">

<p class="p noindent">   Load the daily&nbsp;<a href="http://www.usno.navy.mil/USNO/earth-orientation/eo-products/weekly">IERS bulletin A</a>
   information for precise UT1 determination. The daily file contains information for the past 90 days
   with 90 days of predictions. This file is about 40kb and much smaller than the full data.
   Uses linear interpolation between daily UT1-UTC values.
   By default loads the file <code class="koka">fname</code> (= <code class="koka"><span class="st">&#34;config/finals2000A.daily&#34;</span></code> in the application directory).
   If the file is not present, it will be downloaded from <code class="koka">url</code>. The default <code class="koka">url</code> is:<br>
   <a href="http://maia.usno.navy.mil/ser7/finals2000A.daily" class="texturl monospace">http://&#8203;maia.&#8203;usno.&#8203;navy.&#8203;mil/&#8203;ser7/&#8203;finals2000A.&#8203;daily</a><br>
   Set the <code class="koka">url</code> to the empty string to suppress automatic downloading.
   If the file is older than <code class="koka">download<span class="dash">-</span>delay</code> (=<code class="koka"><span class="number">1</span><span class="kw op">.</span><a class="pp" href="std_time_duration.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>) the file is automatically refreshed from <code class="koka">url</code>.
   The <code class="koka">download<span class="dash">-</span>timeout</code> (=<code class="koka"><span class="number">5</span><span class="kw op">.</span>seconds</code>) gives the maximum time for downloading to finish.
   Set the optional parameter <code class="koka">verbose</code> to <code class="koka"><a class="pp" href="std_core.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a></code> to suppress trace messages on downloads or errors.
</p></div></div>
<div class="decl" id="ts_ut1_approx"><div class="header code"><span class="def"><span class="kw">val</span>&nbsp;<a class="link" href="std_time_ut1-source.html#ts_ut1_approx">ts<span class="dash">-</span>ut1<span class="dash">-</span>approx</a></span><span class="tp sp">:</span>&nbsp;<a class="pp" href="std_time_instant.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a></div><div class="doc koka comment">

<p class="p noindent">   The default UT1 (Universal time 1) timescale
   Uses builtin approximation of UT1 time as described in <code class="koka"><a class="pp" href="#deltat">deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp">duration</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>.
   To calculate UT1 more precisely, use <code class="koka">cal<span class="dash">-</span>ut1<span class="dash">-</span>load</code> (or <code class="koka">cal<span class="dash">-</span>ut1<span class="dash">-</span>create</code>).
</p></div></div>
<div class="decl" id="ts_ut1_create"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_ut1-source.html#ts_ut1_create">ts<span class="dash">-</span>ut1<span class="dash">-</span>create</a></span>( <span class="tp tpp">dt</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp sp">:</span>&nbsp;<a class="pp" href="std_time_instant.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a></div><div class="doc koka comment">

<p class="p noindent">   Takes an optional <code class="koka">dt</code> parameter to calculate &#916;T (=TT - UT1)
   more precisely. The <code class="koka">dt</code> functions should return <code class="koka"><a class="pp" href="std_core.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> for instants
   outside its range so the builtin methods can be used in that case (see <code class="koka"><a class="pp" href="#deltat">deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp">duration</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>).
</p></div></div>
<div class="decl" id="ts_ut1_load"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_ut1-source.html#ts_ut1_load">ts<span class="dash">-</span>ut1<span class="dash">-</span>load</a></span>( <span class="tp tpp">basename</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">baseurl</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">verbose</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> ) <span class="tp sp">:</span>&nbsp;<span class="tp sp">&lt;</span><a class="pp" href="std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_time_instant.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a></div><div class="doc koka comment">

<p class="p noindent">   Create a new UT1 calendar using&nbsp;<a href="http://www.usno.navy.mil/USNO/earth-orientation/eo-products/weekly">IERS bulletin A</a>
   data for precise UT1 calculation. Uses linear interpolation between daily UT1-UTC values.
   This is a convenience function that composes <code class="koka">load<span class="dash">-</span>iers<span class="dash">-</span>ut1</code> and <code class="koka">cal<span class="dash">-</span>ut1<span class="dash">-</span>create</code>.
<br>
   By default loads the daily and full data from the files <code class="koka"><a class="pp" href="std_os_path.html#basename">basename<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>basename: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a></code> (= <code class="koka"><span class="st">&#34;config/finals2000A&#34;</span></code> in the application directory).
   If the files are not present, they will be downloaded from <code class="koka">url</code>. The default <code class="koka">url</code> is:<br>
   <a href="http://maia.usno.navy.mil/ser7" class="texturl monospace">http://&#8203;maia.&#8203;usno.&#8203;navy.&#8203;mil/&#8203;ser7</a><br>
   Set the <code class="koka">url</code> to the empty string to suppress automatic downloading.
   If the <code class="code code2">.daily</code> file is older than <code class="koka">download<span class="dash">-</span>delay</code> (=<code class="koka"><span class="number">1</span><span class="kw op">.</span><a class="pp" href="std_time_duration.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>) the file is automatically refreshed from <code class="koka">url</code>.
   The <code class="koka">download<span class="dash">-</span>timeout</code> (=<code class="koka"><span class="number">5</span><span class="kw op">.</span>seconds</code>) gives the maximum time for downloading to finish (daily file is about 40kb).
   If the <code class="code code2">.all</code> file is older than <code class="koka"><span class="number">8</span><span class="op">&#42;</span>download<span class="dash">-</span>delay</code> the file is automatically refreshed from <code class="koka">url</code>.
   The <code class="koka"><span class="number">4</span><span class="op">&#42;</span>download<span class="dash">-</span>timeout</code> (=<code class="koka"><span class="number">20</span><span class="kw op">.</span>seconds</code>) gives the maximum time for downloading to finish (<code class="code code2">.all</code> file is about 3mb).
   Set the optional parameter <code class="koka">verbose</code> to <code class="koka"><a class="pp" href="std_core.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a></code> to suppress trace messages on downloads or errors.
</p></div></div>
<div class="decl" id="ts_ut2_approx"><div class="header code"><span class="def"><span class="kw">val</span>&nbsp;<a class="link" href="std_time_ut1-source.html#ts_ut2_approx">ts<span class="dash">-</span>ut2<span class="dash">-</span>approx</a></span><span class="tp sp">:</span>&nbsp;<a class="pp" href="std_time_instant.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a></div><div class="doc koka comment">

<p class="p noindent">   The default UT2 (Universal time 2) timescale.
   Uses builtin approximation of UT2 time as described in <code class="koka"><a class="pp" href="#deltat">deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp">duration</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>.
   To calculate UT2 more precisely, use <code class="koka">cal<span class="dash">-</span>ut2<span class="dash">-</span>load</code> (or <code class="koka">cal<span class="dash">-</span>ut2<span class="dash">-</span>create</code>).
</p></div></div>
<div class="decl" id="ts_ut2_create"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_ut1-source.html#ts_ut2_create">ts<span class="dash">-</span>ut2<span class="dash">-</span>create</a></span>( <span class="tp tpp">dt</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp sp">:</span>&nbsp;<a class="pp" href="std_time_instant.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a></div><div class="doc koka comment">

<p class="p noindent">   Takes an optional <code class="koka">dt</code> parameter to calculate &#916;T (=TT - UT1)
   more precisely (since UT2 is derived from UT1).
   The <code class="koka">dt</code> functions should return <code class="koka"><a class="pp" href="std_core.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> for instants
   outside its range so the builtin methods can be used in that case (see <code class="koka"><a class="pp" href="#deltat">deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp">duration</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>).
</p></div></div>
<div class="decl" id="-private-imports"><div class="header code"><span class="def"><span class="kw">private import</span>&nbsp;<span class="code"><a class="pp" href="std_core.html"><span class="mo">std<span class="fslash">/</span>core</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core</span></span></a></span>, <span class="code"><a class="pp" href="std_num_double.html"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double</span></span></a></span>, <span class="code"><a class="pp" href="std_async.html"><span class="mo">std<span class="fslash">/</span>async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async</span></span></a></span>, <span class="code"><a class="pp" href="std_os_path.html"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path</span><span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path</span></span></a></span>, <span class="code"><a class="pp" href="std_num_ddouble.html"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble</span></span></a></span>, <span class="code"><a class="pp" href="std_text_regex.html"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex</span></span></a></span>, <span class="code"><a class="pp" href="std_time_timestamp.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp</span></span></a></span>, <span class="code"><a class="pp" href="std_time_duration.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration</span></span></a></span>, <span class="code"><a class="pp" href="std_time_instant.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant</span></span></a></span>, <span class="code"><a class="pp" href="std_time_utc.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc</span></span></a></span>, <span class="code"><a class="pp" href="std_time_download.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>download</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>download</span></span></a></span>, <span class="code"><a class="pp" href="std_time_astro.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>astro</span></span></a></span>, <span class="code"><a class="pp" href="std_time_calendar.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar</span></span></a></span>, <span class="code"><a class="pp" href="std_time_calendars.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendars</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendars</span></span></a></span>, <span class="code"><a class="pp" href="std_time_time.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>time</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>time</span></span></a></span></span></div></div>
</div></body>
</html>

<span data-line=""></span>