<!DOCTYPE html>
<html>
<!-- NO_CLICK_TRACKING -->

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>string.kk documentation</title>
</head>

<body class="koka doc body"><div class="madoko">
<pre class="koka source"><span class="comment">/&#42;---------------------------------------------------------------------------
  Copyright 2012-2016 Microsoft Corporation.
 
  This is free software; you can redistribute it and/or modify it under the
  terms of the Apache License, Version 2.0. A copy of the License can be
  found in the file "license.txt" at the root of this distribution.
---------------------------------------------------------------------------&#42;/</span>

<span class="comment">/&#42; Extended string operations and a string builder.
&#42;/</span>  
<span class="kw">module</span> string

<span class="kw">import</span> array

<span class="comment">// Indent all lines a string &#96;s&#96; by &#96;n&#96;. &#96;fill&#96; is used for indentation, by default &#96;" "&#96;.
</span><span class="decl-fun" id="indent"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_text_string.html#indent">indent<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>indent: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">fill</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">n<span class="pc">n: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">2</span>, <a class="pp">fill<span class="pc">fill: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">" "</span> ) {
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">n</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="std_core-source.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="number">0</span>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">string</span></span></a> <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>
  <span class="kw">val</span> <a class="pp">pre<span class="pc">pre: <span class="tp">string</span></span></a> <span class="kw">=</span> <a class="pp">fill<span class="pc">fill: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#repeat">repeat<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>repeat: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>)
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#lines">lines<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>lines: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>( <span class="kw">fun</span>(<a class="pp">line<span class="pc">line: <span class="tp">string</span></span></a>) { <a class="pp">pre<span class="pc">pre: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">line<span class="pc">line: <span class="tp">string</span></span></a> } )<span class="kw op">.</span><a class="pp" href="std_core-source.html#unlines">unlines<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>unlines: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
</span>}

<span class="comment">/&#42; --------------------------------------
  Jaro-Winkler string distance
---------------------------------------- &#42;/</span>

<span class="comment">// Return the [Jaro-Winkler distance](https://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler&#95;distance) 
// between two strings. This is a number between &#96;1.0&#96; and &#96;0.0&#96; where &#96;1.0&#96; is a perfect
// match. . Works best for small words and names.
// &#95;Jaro-Winkler&#95; is a variation of a plain &#96;jaro-distance&#96; developed by the U.S. census
// for name comparison and it gives a higher score to strings that have a common prefix.
//
// &#42; Scores are only boosted if the &#96;jaro-distance&#96; is above the &#96;boost-threshold&#96; (= 0.7) 
// &#42; The maximal common prefix length considered is given by &#96;prefix-len&#96; (= 4)
// &#42; The scale modifies the boosted amount (= 0.1). It is adjusted dynamically depending on the &#96;prefix-len&#96; to
//   ensure no result can be higher then 1.0.
//
// &#96;jaro-distance("martha","marhta") == 0.96&#96;\
// &#96;jaro-distance("abrams","abroms") == 0.92&#96;
</span><span class="decl-fun" id="jaro_winkler_distance"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_text_string.html#jaro_winkler_distance">jaro-winkler-distance<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>jaro<span class="dash">-</span>winkler<span class="dash">-</span>distance: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">boost<span class="dash">-</span>threshold</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">prefix<span class="dash">-</span>len</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">scale</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">t<span class="pc">t: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">boost-threshold<span class="pc">boost<span class="dash">-</span>threshold: <span class="tp op">?</span><span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0.7</span>, <a class="pp">prefix-len<span class="pc">prefix<span class="dash">-</span>len: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">4</span>, <a class="pp">scale<span class="pc">scale: <span class="tp op">?</span><span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0.1</span> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp" href="#jaro_distance">jaro-distance<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>jaro<span class="dash">-</span>distance: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>,<a class="pp">t<span class="pc">t: <span class="tp">string</span></span></a>)
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">d</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_lt__eq__3">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">boost-threshold<span class="pc">boost<span class="dash">-</span>threshold: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">prefix-len<span class="pc">prefix<span class="dash">-</span>len: <span class="tp">int</span></span></a> <a class="pp" href="std_core-source.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">double</span></span></a> <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a>
  <span class="kw">val</span> <a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#common_prefix">common-prefix<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>common<span class="dash">-</span>prefix: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">upto</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">sslice</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>,<a class="pp">t<span class="pc">t: <span class="tp">string</span></span></a>,<a class="pp">prefix-len<span class="pc">prefix<span class="dash">-</span>len: <span class="tp">int</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_core-source.html#count_2">count<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">slice</span> <span class="tp kw op">:</span> <span class="tp">sslice</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  <span class="kw">val</span> <a class="pp">sc<span class="pc">sc: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#min_1">min<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>min<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp" href="std_core-source.html#max_1">max<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>max<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">scale<span class="pc">scale: <span class="tp">double</span></span></a>,<span class="number">0.0</span>), <span class="number">1.0</span> <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">prefix-len<span class="pc">prefix<span class="dash">-</span>len: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
  <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp">l<span class="pc">l: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">sc<span class="pc">sc: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<span class="number">1.0</span> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a>))
</span>}

<span class="comment">// Return the [Jaro distance](https://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler&#95;distance) 
// between two strings. This is a number between &#96;1.0&#96; and &#96;0.0&#96; where &#96;1.0&#96; is a perfect
// match. Works best for small words and names.
//
// &#96;jaro-distance("martha","marhta") == 0.94&#96;\
// &#96;jaro-distance("abrams","abroms") == 0.89&#96;
</span><span class="decl-fun" id="jaro_distance"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_text_string.html#jaro_distance">jaro-distance<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>jaro<span class="dash">-</span>distance: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">t<span class="pc">t: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">s</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="std_core-source.html#_eq__eq__3">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><a class="pp">t<span class="pc">t: <span class="tp">string</span></span></a>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">double</span></span></a> <span class="number">1.0</span>
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">s</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#empty_ques__1">empty?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>empty?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#empty_ques__1">empty?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>empty?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">double</span></span></a> <span class="number">0.0</span>
  <span class="kw">val</span> <a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#vector_1">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a>
  <span class="kw">val</span> <a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">t<span class="pc">t: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#vector_1">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a>
  <span class="kw">val</span> <a class="pp">lim<span class="pc">lim: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#max">max<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>max: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">0</span>,<a class="pp" href="std_core-source.html#max">max<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>max: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)<a class="pp" href="std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">2</span> <a class="pp" href="std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>)
  <span class="kw">val</span> <a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">mcount<span class="pc">mcount: <span class="tp">int</span></span></a>,<a class="pp">tcount<span class="pc">tcount: <span class="tp">int</span></span></a><a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">v</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="std_core-source.html#_gt__1">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp" href="#jaro_match">jaro-match<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>jaro<span class="dash">-</span>match: <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">w</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">lim</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>(<a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a>,<a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a>,<a class="pp">lim<span class="pc">lim: <span class="tp">int</span></span></a>) <span class="kw">else</span> <a class="pp" href="#jaro_match">jaro-match<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>jaro<span class="dash">-</span>match: <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">w</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">lim</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>(<a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a>,<a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a>,<a class="pp">lim<span class="pc">lim: <span class="tp">int</span></span></a>)
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">mcount</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="std_core-source.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="number">0</span>) <span class="kw">then</span> <span class="number">0.0</span> <span class="kw">else</span> {
    <span class="kw">val</span> <a class="pp">mc<span class="pc">mc: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">mcount<span class="pc">mcount: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
    <span class="kw">val</span> <a class="pp">tc<span class="pc">tc: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">tcount<span class="pc">tcount: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
    ((<a class="pp">mc<span class="pc">mc: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp">mc<span class="pc">mc: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> ((<a class="pp">mc<span class="pc">mc: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">tc<span class="pc">tc: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">mc<span class="pc">mc: <span class="tp">double</span></span></a>)) <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">3.0</span>
  }
</span>}

<span class="decl-fun" id="jaro_match"><span class="kw">fun</span> <a class="pp" href="std_text_string.html#jaro_match">jaro-match<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>jaro<span class="dash">-</span>match: <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">w</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">lim</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>( <a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_vector"><span class="tp">vector</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_char"><span class="tp">char</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>char: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_vector"><span class="tp">vector</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_char"><span class="tp">char</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>char: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">lim<span class="pc">lim: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><a class="pp" href="std_core-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <a class="pp" href="std_core-source.html#try_default">try-default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>try<span class="dash">-</span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>(<a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><span class="number">0</span>,<span class="number">0</span><a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>) {
    <span class="kw">val</span> <a class="pp">matched<span class="pc">matched: <span class="tp">array</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;313</span><span class="tp sp">,</span><span class="tp">bool</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="std_data_array-source.html#array">array<span class="pc"><span class="mo">std<span class="fslash">/</span>data<span class="fslash">/</span>array<span class="fslash last">/</span></span>array: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">array</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp" href="std_core-source.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>)
    <a class="pp" href="std_core-source.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp">transposes<span class="pc">transposes: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;349</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">:=</span> <span class="number">0</span>
    <a class="pp" href="std_core-source.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp">matches<span class="pc">matches: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;349</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>    <span class="kw op">:=</span> <span class="number">0</span>
    <a class="pp" href="std_core-source.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp">lastmatch<span class="pc">lastmatch: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;349</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>  <span class="kw op">:=</span> <span class="number">0</span>
    <a class="pp">v<span class="pc">v: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#foreach_indexed_1">foreach-indexed<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>foreach<span class="dash">-</span>indexed<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="kw">fun</span>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>,<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>) {
      <span class="kw">val</span> <a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#max">max<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>max: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<span class="number">0</span>,<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">lim<span class="pc">lim: <span class="tp">int</span></span></a>)
      <span class="kw">val</span> <a class="pp">end<span class="pc">end: <span class="tp">int</span></span></a>   <span class="kw">=</span> <a class="pp" href="std_core-source.html#min">min<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>min: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>, <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">lim<span class="pc">lim: <span class="tp">int</span></span></a>)
      <a class="pp" href="std_core-source.html#for_while">for-while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>for<span class="dash">-</span>while: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a>,<a class="pp">end<span class="pc">end: <span class="tp">int</span></span></a>) <span class="kw">fun</span>(<a class="pp">j<span class="pc">j: <span class="tp">int</span></span></a>) {
        <span class="kw">if</span> (<a class="pp">w<span class="pc">w: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_core-source.html#con_space_True"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">j<span class="pc">j: <span class="tp">int</span></span></a>] <a class="pp" href="std_core-source.html#_excl__eq_">!=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(!=): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">matched<span class="pc">matched: <span class="tp">array</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;313</span><span class="tp sp">,</span><span class="tp">bool</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_data_array-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>data<span class="fslash">/</span>array<span class="fslash last">/</span></span>[]: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">self</span> <span class="tp kw op">:</span> <span class="tp">array</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">j<span class="pc">j: <span class="tp">int</span></span></a>]) <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
        <span class="kw">else</span> {
          <a class="pp">matched<span class="pc">matched: <span class="tp">array</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;313</span><span class="tp sp">,</span><span class="tp">bool</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_data_array-source.html#_lb__rb__1">[<span class="pc"><span class="mo">std<span class="fslash">/</span>data<span class="fslash">/</span>array<span class="fslash last">/</span></span>[]<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">a</span> <span class="tp kw op">:</span> <span class="tp">array</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp">j<span class="pc">j: <span class="tp">int</span></span></a>] <span class="kw op">:=</span> <a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
          <a class="pp">matches<span class="pc">matches: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;349</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="std_core-source.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="std_core-source.html#local_get">matches<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>
          <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">lastmatch</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_gt__1">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">j<span class="pc">j: <span class="tp">int</span></span></a>) <a class="pp">transposes<span class="pc">transposes: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;349</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="std_core-source.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="std_core-source.html#local_get">transposes<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="std_core-source.html#con_space__lp__rp_"><span class="co">1</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
          <a class="pp">lastmatch<span class="pc">lastmatch: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;349</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="std_core-source.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">j<span class="pc">j: <span class="tp">int</span></span></a>
          <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="std_core-source.html#con_space__lp__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="std_core-source.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>)
        }
      }
      <a class="pp" href="std_core-source.html#con_space__lp__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a><a class="pp" href="std_core-source.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
    }
    <a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp" href="std_core-source.html#local_get">matches<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a>,<a class="pp" href="std_core-source.html#local_get">transposes<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
  }
</span>}

<span class="comment">/&#42; --------------------------------------
 String builder 
---------------------------------------- &#42;/</span>

<span class="comment">// A &#96;:builder&#96; is used to append strings in linear time.
</span><span class="decl-type" id="type_space_builder"><span class="kw">public</span> <span class="tp kw">type</span> <a class="pp" href="std_text_string.html#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp">h</span><span class="pc">h: <span class="tp">H</span></span></a> <span class="tp sp">::</span><span class="tp">H</span></span><span class="tp sp">&gt;</span>

<span class="comment">// Create a string builder
</span><span class="decl-external" id="builder"><span class="kw">public</span> <span class="kw">extern</span> inline <a class="pp" href="std_text_string.html#builder">builder<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span></span></a>() <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_alloc"><span class="tp">alloc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>alloc: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> {
  cs inline <span class="st">"new System.Text.StringBuilder()"</span>
  js inline <span class="st">"{ value: '' }"</span>
</span>}

<span class="comment">// O(1). Append to a string builder
</span><span class="decl-fun" id="append"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_text_string.html#append">append<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>append: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;61</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>write: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> {
  <a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;61</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#unitAppend">unitAppend<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>unitAppend: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>)
  <a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;61</span><span class="tp sp">&gt;</span></span></a>
</span>}


<span class="comment">// O(1). Prepend a string in front of a string builder
</span><span class="decl-fun" id="prepend"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_text_string.html#prepend">prepend<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>prepend: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1321</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>write: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> {
  <a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1321</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#unitPrepend">unitPrepend<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>unitPrepend: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>)
  <a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1321</span><span class="tp sp">&gt;</span></span></a>
</span>}

<span class="decl-external" id="unitAppend"><span class="kw">extern</span> inline <a class="pp" href="std_text_string.html#unitAppend">unitAppend<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>unitAppend: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( b <span class="tp kw op">:</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span>, s <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>write: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> {
  cs inline <span class="st">"(#1).Append(#2)"</span>
  js inline <span class="st">"((#1).value += (#2))"</span>
</span>}

<span class="decl-external" id="unitPrepend"><span class="kw">extern</span> inline <a class="pp" href="std_text_string.html#unitPrepend">unitPrepend<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>unitPrepend: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( b <span class="tp kw op">:</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span>, s <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>write: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> {
  cs inline <span class="st">"(#1).Insert(0,#2)"</span>
  js inline <span class="st">"((#1).value = (#2) + (#1).value)"</span>
</span>}

<span class="comment">// O(n). Read the current string from a string builder.
</span><span class="decl-external" id="build"><span class="kw">public</span> <span class="kw">extern</span> inline <a class="pp" href="std_text_string.html#build">build<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>build: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">string</span></span></a>( b <span class="tp kw op">:</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>read: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">X</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  cs inline <span class="st">"(#1).ToString()"</span>
  js inline <span class="st">"(#1).value"</span>
</span>}

<span class="comment">// Do &#96;action&#96; with a given &#96;:builder&#96; and return the &#96;:string&#96; that was built.
</span><span class="decl-fun" id="with_builder"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_text_string.html#with_builder">with-builder<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>with<span class="dash">-</span>builder: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">st</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">string</span></span></a>( <a class="pp">action<span class="pc">action: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">st</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">&#95;1338</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&lt;</span><a class="pp"><span class="tp">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <a class="pp" href="#type_space_builder"><span class="tp">builder</span><span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-></span> <span class="tp">E</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">h</span><span class="pc">h: <span class="tp">H</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">|</span><a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a><a class="pp" href="std_core-source.html#type_space__lp__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">e</span></span><span class="pc">e: <span class="tp">E</span></span></a> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1340</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="#builder">builder<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>builder: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span></span></a>()
  <a class="pp">action<span class="pc">action: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">st</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">|</span><span class="tp tv">&#95;1338</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1340</span><span class="tp sp">&gt;</span></span></a>)
  <a class="pp">b<span class="pc">b: <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1340</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#build">build<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>string<span class="fslash last">/</span></span>build: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">b</span> <span class="tp kw op">:</span> <span class="tp">builder</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">string</span></span></a>
</span>}</pre>

</div></body>
</html>
