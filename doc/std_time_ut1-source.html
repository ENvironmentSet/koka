<!DOCTYPE html>
<html>
<!-- NO_CLICK_TRACKING -->

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>ut1.kk documentation</title>
</head>

<body class="koka doc body"><div class="madoko">
<pre class="koka source"><span class="comment">/&#42;----------------------------------------------------------------------------
   Copyright (C) 2012-2019 Microsoft Corporation

   Licensed under the Apache License, Version 2.0 ("The Licence"). You may not
   use this file except in compliance with the License. A copy of the License
   can be found in the file "license.txt" at the root of this distribution.
----------------------------------------------------------------------------&#42;/</span>

<span class="comment">/&#42; The UT1 (and UT2) time scale and calendar.

The UT1 time scale is based on the rotation of the earth where one rotation is 86400 seconds.
The exact UT1 time can only be determined by measuring the Earth's rotation angle very precisely.
The International Earth Rotation Service
(IERS) issues [bulletin A](https://www.iers.org/IERS/EN/Publications/Bulletins/bulletins.html)
containing accurate (UT1 - UTC) deltas.

The library provides the &#96;cal-ut1-load&#96; function to automatically cache and download the latest USNO
bulletin A information (&#96;&#96;finals2000A&#96;&#96; &#96;&#96;all&#96;&#96; and &#96;&#96;daily&#96;&#96;) to calculate UT1 very accurately from
1972 until about 3 months from now (using predicted values). By default it downloads daily data
every week and full data about every 8 weeks. For dates outside this range, the library uses its builtin
tables and approximations:

&#42; monthly determined tables for any observed date (usually &gt; 1973 up to the compiler release (2019))
&#42; quarterly prediction tables for dates after that (2019) up to about 10 years (2027)
&#42; yearly historic tables for dates &gt;= 1750 and before 1973
&#42; fitted parabolic approximations for dates between -500 and 2150; (Espenak &amp; Meeus 2006)
&#42; generic parabolic approximation for dates &lt; -500 and dates &gt; 2150 (Morrison and Stephenson, 2004.)

You can also use &#96;cal-ut1-approx&#96; to not download any recent data and always use approximated values.

Usage:
&#96;&#96;&#96;
val cal-ut1 = cal-ut1-load()
val i = now()
i.time().show.println              // in UTC
i.time(cal=cal-ut1).show.println   // in UT1
&#96;&#96;&#96;
&#42;/</span>
<span class="kw">module</span> ut1

<span class="kw">import</span> double
<span class="kw">import</span> async
<span class="kw">import</span> path
<span class="kw">import</span> ddouble
<span class="kw">import</span> regex

<span class="kw">import</span> timestamp
<span class="kw">import</span> duration
<span class="kw">import</span> instant
<span class="kw">import</span> utc
<span class="kw">import</span> download

<span class="kw">import</span> astro
<span class="kw">import</span> calendar
<span class="kw">import</span> calendars
<span class="kw">import</span> time

<span class="comment">// The default UT1 (Universal time 1) timescale
// Uses builtin approximation of UT1 time as described in &#96;deltat&#96;.
// To calculate UT1 more precisely, use &#96;cal-ut1-load&#96; (or &#96;cal-ut1-create&#96;).
</span><span class="decl-val" id="ts_ut1_approx"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_ut1.html#ts_ut1_approx">ts-ut1-approx<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ts<span class="dash">-</span>ut1<span class="dash">-</span>approx: <span class="tp">timescale</span></span></a> <span class="kw">=</span> <a class="pp" href="#ts_ut1_create">ts-ut1-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ts<span class="dash">-</span>ut1<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">dt</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(</span>)

<span class="comment">// The default UT2 (Universal time 2) timescale.
// Uses builtin approximation of UT2 time as described in &#96;deltat&#96;.
// To calculate UT2 more precisely, use &#96;cal-ut2-load&#96; (or &#96;cal-ut2-create&#96;).
</span><span class="decl-val" id="ts_ut2_approx"><span class="kw">public</span> <span class="kw">val</span> <a class="pp" href="std_time_ut1.html#ts_ut2_approx">ts-ut2-approx<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ts<span class="dash">-</span>ut2<span class="dash">-</span>approx: <span class="tp">timescale</span></span></a> <span class="kw">=</span> <a class="pp" href="#ts_ut2_create">ts-ut2-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ts<span class="dash">-</span>ut2<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">dt</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(</span>)


<span class="decl-val" id="usno_url"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#usno_url">usno-url<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>usno<span class="dash">-</span>url: <span class="tp">string</span></span></a> <span class="kw">=</span> <span class="st">"http://maia.usno.navy.mil/ser7/"</span></span>  <span class="comment">// "http://toshi.nofs.navy.mil/ser7/"
</span>
<span class="comment">// Create a new UT1 calendar using [IERS bulletin A](http://www.usno.navy.mil/USNO/earth-orientation/eo-products/weekly)
// data for precise UT1 calculation. Uses linear interpolation between daily UT1-UTC values.
// This is a convenience function that composes &#96;load-iers-ut1&#96; and &#96;cal-ut1-create&#96;.
//
// By default loads the daily and full data from the files &#96;basename&#96; (= &#96;"config/finals2000A"&#96; in the application directory).
// If the files are not present, they will be downloaded from &#96;url&#96;. The default &#96;url&#96; is:\
// &lt;http://maia.usno.navy.mil/ser7&gt;\
// Set the &#96;url&#96; to the empty string to suppress automatic downloading.
// If the &#96;&#96;.daily&#96;&#96; file is older than &#96;download-delay&#96; (=&#96;1.weeks&#96;) the file is automatically refreshed from &#96;url&#96;.
// The &#96;download-timeout&#96; (=&#96;5.seconds&#96;) gives the maximum time for downloading to finish (daily file is about 40kb).
// If the &#96;&#96;.all&#96;&#96; file is older than &#96;8&#42;download-delay&#96; the file is automatically refreshed from &#96;url&#96;.
// The &#96;4&#42;download-timeout&#96; (=&#96;20.seconds&#96;) gives the maximum time for downloading to finish (&#96;&#96;.all&#96;&#96; file is about 3mb).
// Set the optional parameter &#96;verbose&#96; to &#96;False&#96; to suppress trace messages on downloads or errors.
</span><span class="decl-fun" id="ts_ut1_load"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#ts_ut1_load">ts-ut1-load<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ts<span class="dash">-</span>ut1<span class="dash">-</span>load: <span class="tp sp">(</span><span class="tp tpp">basename</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">baseurl</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp">timescale</span></span></a>( <a class="pp">basename<span class="pc">basename: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">"finals2000A"</span>,
                         <a class="pp">baseurl<span class="pc">baseurl: <span class="tp op">?</span><span class="tp">string</span></span></a>  <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#usno_url">usno-url<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>usno<span class="dash">-</span>url: <span class="tp">string</span></span></a>,
                         <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp op">?</span><span class="tp">duration</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">1</span><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>,
                         <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp op">?</span><span class="tp">duration</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">5</span><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#seconds_1">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>seconds<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>,
                         <a class="pp">verbose<span class="pc">verbose: <span class="tp op">?</span><span class="tp">bool</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
                        ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="std_core-source.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async-source.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a>
{
  <a class="pp" href="#ts_ut1_create">ts-ut1-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ts<span class="dash">-</span>ut1<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">dt</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>( <a class="pp" href="#load_iersA">load-iersA<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>iersA: <span class="tp sp">(</span><span class="tp tpp">basename</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">baseurl</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">basename<span class="pc">basename: <span class="tp">string</span></span></a>, <a class="pp">baseurl<span class="pc">baseurl: <span class="tp">string</span></span></a>, <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp">duration</span></span></a>, <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp">duration</span></span></a>, <a class="pp">verbose<span class="pc">verbose: <span class="tp">bool</span></span></a> ) )
</span>}

<span class="comment">// Load [IERS bulletin A](http://www.usno.navy.mil/USNO/earth-orientation/eo-products/weekly)
// information for precise UT1 determination. Loads and caches both the &#95;daily&#95; and &#95;all&#95;
// data. Downloads a fresh daily file about every week (&#96;download-delay&#96;) with a given &#96;download-timeout&#96; (=&#96;5&#96;s).
// The full data is refreshed only every &#96;8&#42;download-delay&#96; (=&#96;8.weeks&#96;). The &#96;basename&#96; gives
// the basic file name &#96;finals2000A&#96; and the &#96;baseurl&#96; the download URL
// (= &lt;http://maia.usno.navy.mil/ser7/&gt;).
// Set the &#96;baseurl&#96; to the empty string to suppress automatic downloading. The files are cached
// in the &#96;config/&#96; directory of the application installation directory.
// Set the optional parameter &#96;verbose&#96; to &#96;False&#96; to suppress trace messages on downloads or errors.
</span><span class="decl-fun" id="load_iersA"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#load_iersA">load-iersA<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>iersA: <span class="tp sp">(</span><span class="tp tpp">basename</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">baseurl</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">basename<span class="pc">basename: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">"finals2000A"</span>,
                       <a class="pp">baseurl<span class="pc">baseurl: <span class="tp op">?</span><span class="tp">string</span></span></a>  <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#usno_url">usno-url<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>usno<span class="dash">-</span>url: <span class="tp">string</span></span></a>,
                       <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp op">?</span><span class="tp">duration</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">1</span><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>,
                       <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp op">?</span><span class="tp">duration</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">5</span><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#seconds_1">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>seconds<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>,
                       <a class="pp">verbose<span class="pc">verbose: <span class="tp op">?</span><span class="tp">bool</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
                     ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="std_core-source.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async-source.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span><span class="tp kw op">:</span><a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span>
{
  <span class="kw">val</span> <a class="pp">fname-all<span class="pc">fname<span class="dash">-</span>all: <span class="tp">string</span></span></a>    <span class="kw">=</span> <a class="pp">basename<span class="pc">basename: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">".all"</span>
  <span class="kw">val</span> <a class="pp">finals-all<span class="pc">finals<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;79</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>   <span class="kw">=</span> <a class="pp" href="#load_iersA_all">load-iersA-all<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>iersA<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">fname-all<span class="pc">fname<span class="dash">-</span>all: <span class="tp">string</span></span></a>, <a class="pp">baseurl<span class="pc">baseurl: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">fname-all<span class="pc">fname<span class="dash">-</span>all: <span class="tp">string</span></span></a>,
                                     <a class="pp" href="std_time_duration-source.html#duration">duration<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#seconds">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>seconds: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a> <a class="pp" href="std_num_ddouble-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <span class="number">8</span><span class="kw op">.</span><a class="pp" href="std_num_ddouble-source.html#ddouble_1">ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>ddouble<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>),
                                     <a class="pp" href="std_time_duration-source.html#duration">duration<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#seconds">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>seconds: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a> <a class="pp" href="std_num_ddouble-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a> <span class="number">8</span><span class="kw op">.</span><a class="pp" href="std_num_ddouble-source.html#ddouble_1">ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>ddouble<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>), <a class="pp">verbose<span class="pc">verbose: <span class="tp">bool</span></span></a> )
  <span class="kw">val</span> <a class="pp">fname-daily<span class="pc">fname<span class="dash">-</span>daily: <span class="tp">string</span></span></a>  <span class="kw">=</span> <a class="pp">basename<span class="pc">basename: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">".daily"</span>
  <span class="kw">val</span> <a class="pp">finals-daily<span class="pc">finals<span class="dash">-</span>daily: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;79</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="#load_iersA_daily">load-iersA-daily<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>iersA<span class="dash">-</span>daily: <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">fname-daily<span class="pc">fname<span class="dash">-</span>daily: <span class="tp">string</span></span></a>, <a class="pp">baseurl<span class="pc">baseurl: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">fname-daily<span class="pc">fname<span class="dash">-</span>daily: <span class="tp">string</span></span></a>,
                                       <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp">duration</span></span></a>, <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp">duration</span></span></a>, <a class="pp">verbose<span class="pc">verbose: <span class="tp">bool</span></span></a> )
  (<span class="kw">fun</span>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="tp kw op">:</span><a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>) {
    <span class="kw">match</span>(<a class="pp">finals-daily<span class="pc">finals<span class="dash">-</span>daily: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;79</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>)) {
      <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> <a class="pp">finals-all<span class="pc">finals<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;79</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>)
      <a class="pp">just<span class="pc">just: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>    <span class="kw op">-></span> <a class="pp">just<span class="pc">just: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>
    }
  })
</span>}

<span class="comment">// Load [IERS bulletin A](http://www.usno.navy.mil/USNO/earth-orientation/eo-products/weekly)
// information for precise UT1 determination. Loads the full bulletin A data since 1973
// with about 1 year of predictions. Uses linear interpolation between daily UT1-UTC values.
// By default loads the file &#96;fname&#96; (= &#96;"config/finals2000A.all"&#96; in the application directory).
// If the file is not present, it will be downloaded from &#96;url&#96;. The default &#96;url&#96; is:\
// &lt;http://maia.usno.navy.mil/ser7/finals2000A.all&gt;\
// Set the &#96;url&#96; to the empty string to suppress automatic downloading.
// If the file is older than &#96;download-delay&#96; (=&#96;4.weeks&#96;) the file is automatically refreshed from &#96;url&#96;.
// The &#96;download-timeout&#96; (=&#96;20.seconds&#96;) gives the maximum time for downloading to finish (the
// full data is about 3mb in size).
// Set the optional parameter &#96;verbose&#96; to &#96;False&#96; to suppress trace messages on downloads or errors.
</span><span class="decl-fun" id="load_iersA_all"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#load_iersA_all">load-iersA-all<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>iersA<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">fname<span class="pc">fname: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>,
                          <a class="pp">url<span class="pc">url: <span class="tp op">?</span><span class="tp">string</span></span></a>   <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">"auto"</span>,
                          <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp op">?</span><span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a>   <span class="kw">=</span> <span class="number">8</span><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>,
                          <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp op">?</span><span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">30</span><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#seconds_1">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>seconds<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>,  <span class="comment">// 3mb file!
</span>                          <a class="pp">verbose<span class="pc">verbose: <span class="tp op">?</span><span class="tp">bool</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
                         ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="std_core-source.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async-source.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span><span class="tp kw op">:</span><a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span>
{
  <a class="pp" href="#load_latest_iersA">load-latest-iersA<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>latest<span class="dash">-</span>iersA: <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( (<a class="pp">fname<span class="pc">fname: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_bar__bar__2">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">"finals2000A.all"</span>)<span class="kw op">.</span><a class="pp" href="std_os_path-source.html#path">path<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">path</span></span></a>, <a class="pp">url<span class="pc">url: <span class="tp">string</span></span></a>, <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp">duration</span></span></a>, <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp">duration</span></span></a>, <a class="pp">verbose<span class="pc">verbose: <span class="tp">bool</span></span></a> )
</span>}


<span class="comment">// Load the daily [IERS bulletin A](http://www.usno.navy.mil/USNO/earth-orientation/eo-products/weekly)
// information for precise UT1 determination. The daily file contains information for the past 90 days
// with 90 days of predictions. This file is about 40kb and much smaller than the full data.
// Uses linear interpolation between daily UT1-UTC values.
// By default loads the file &#96;fname&#96; (= &#96;"config/finals2000A.daily"&#96; in the application directory).
// If the file is not present, it will be downloaded from &#96;url&#96;. The default &#96;url&#96; is:\
// &lt;http://maia.usno.navy.mil/ser7/finals2000A.daily&gt;\
// Set the &#96;url&#96; to the empty string to suppress automatic downloading.
// If the file is older than &#96;download-delay&#96; (=&#96;1.weeks&#96;) the file is automatically refreshed from &#96;url&#96;.
// The &#96;download-timeout&#96; (=&#96;5.seconds&#96;) gives the maximum time for downloading to finish.
// Set the optional parameter &#96;verbose&#96; to &#96;False&#96; to suppress trace messages on downloads or errors.
</span><span class="decl-fun" id="load_iersA_daily"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#load_iersA_daily">load-iersA-daily<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>iersA<span class="dash">-</span>daily: <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">fname<span class="pc">fname: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>,
                              <a class="pp">url<span class="pc">url: <span class="tp op">?</span><span class="tp">string</span></span></a>   <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">"auto"</span>,
                              <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp op">?</span><span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a>   <span class="kw">=</span> <span class="number">1</span><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>,
                              <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp op">?</span><span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">5</span><span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#seconds_1">seconds<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>seconds<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>, <span class="comment">// ~37kb file
</span>                              <a class="pp">verbose<span class="pc">verbose: <span class="tp op">?</span><span class="tp">bool</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
                             ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="std_core-source.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async-source.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span><span class="tp kw op">:</span><a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span>
{
  <a class="pp" href="#load_latest_iersA">load-latest-iersA<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>latest<span class="dash">-</span>iersA: <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( (<a class="pp">fname<span class="pc">fname: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_bar__bar__2">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">"finals2000A.daily"</span>)<span class="kw op">.</span><a class="pp" href="std_os_path-source.html#path">path<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">path</span></span></a>, <a class="pp">url<span class="pc">url: <span class="tp">string</span></span></a>, <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp">duration</span></span></a>, <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp">duration</span></span></a>, <a class="pp">verbose<span class="pc">verbose: <span class="tp">bool</span></span></a> )
</span>}

<span class="decl-fun" id="load_latest_iersA"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#load_latest_iersA">load-latest-iersA<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>load<span class="dash">-</span>latest<span class="dash">-</span>iersA: <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">fname<span class="pc">fname: <span class="tp">path</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_os_path-source.html#type_space_path"><span class="tp">path</span><span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp">V</span></span></a>, <a class="pp">url<span class="pc">url: <span class="tp">string</span></span></a>   <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
                        <a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>,
                        <a class="pp">verbose<span class="pc">verbose: <span class="tp op">?</span><span class="tp">bool</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
                       ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">&lt;</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><a class="pp" href="std_core-source.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async-source.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">i</span><span class="tp kw op">:</span><a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span>
{
  <span class="kw">val</span> <a class="pp">xfname<span class="pc">xfname: <span class="tp">path</span></span></a> <span class="kw">=</span> <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">fname</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="std_os_path-source.html#dirname">dirname<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>dirname: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#empty_ques__1">empty?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>empty?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp" href="std_os_path-source.html#appdir">appdir<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>appdir: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">path</span></span></a>() <a class="pp" href="std_os_path-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">p1</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">,</span> <span class="tp tpp">p2</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">path</span></span></a> <a class="pp" href="std_os_path-source.html#path">path<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">path</span></span></a>(<span class="st">"config"</span>) <a class="pp" href="std_os_path-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">p1</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">,</span> <span class="tp tpp">p2</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">path</span></span></a> <a class="pp">fname<span class="pc">fname: <span class="tp">path</span></span></a> <span class="kw">else</span> <a class="pp">fname<span class="pc">fname: <span class="tp">path</span></span></a>
  <span class="kw">val</span> <a class="pp">xurl<span class="pc">xurl: <span class="tp">string</span></span></a>   <span class="kw">=</span> <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">url</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="std_core-source.html#_eq__eq__3">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a><span class="st">"auto"</span>) <span class="kw">then</span> <a class="pp" href="#usno_url">usno-url<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>usno<span class="dash">-</span>url: <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">fname<span class="pc">fname: <span class="tp">path</span></span></a><span class="kw op">.</span><a class="pp" href="std_os_path-source.html#basename">basename<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>basename: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="kw">else</span> <a class="pp">url<span class="pc">url: <span class="tp">string</span></span></a>
  <span class="kw">val</span> <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a>    <span class="kw">=</span> <a class="pp" href="std_time_download-source.html#load_latest">load-latest<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>download<span class="fslash last">/</span></span>load<span class="dash">-</span>latest: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">parse</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">expire</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">instant</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">current</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">error<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">ndet</span><span class="tp sp">,</span><span class="tp">file</span><span class="tp sp">,</span><span class="tp">net</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span></span></a>( <a class="pp">xfname<span class="pc">xfname: <span class="tp">path</span></span></a>, <a class="pp">xurl<span class="pc">xurl: <span class="tp">string</span></span></a>, <a class="pp" href="#parse_iersA">parse-iersA<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>iersA: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">&gt;</span></span></a>, <span class="kw">fun</span>(<a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a><span class="tp kw op">:</span><a class="pp" href="#type_space_dut_table"><span class="tp">dut-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>dut<span class="dash">-</span>table: <span class="tp">V</span></span></a>){ <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#expire">expire<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>expire: <span class="tp sp">(</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>) },
                            download<span class="dash">-</span>timeout<span class="kw">=</span><a class="pp">download-timeout<span class="pc">download<span class="dash">-</span>timeout: <span class="tp">duration</span></span></a>,download<span class="dash">-</span>delay<span class="kw">=</span><a class="pp">download-delay<span class="pc">download<span class="dash">-</span>delay: <span class="tp">duration</span></span></a>,
                            error<span class="dash">-</span>prefix<span class="kw">=</span><span class="st">"load IERS A data ("</span> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">fname<span class="pc">fname: <span class="tp">path</span></span></a><span class="kw op">.</span><a class="pp" href="std_os_path-source.html#basename">basename<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>basename: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">path</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp" href="std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">")"</span>,
                            verbose<span class="kw">=</span><a class="pp">verbose<span class="pc">verbose: <span class="tp">bool</span></span></a>
                          )
  <span class="kw">val</span> <a class="pp">ts-utc<span class="pc">ts<span class="dash">-</span>utc: <span class="tp">timescale</span></span></a> <span class="kw">=</span> <a class="pp" href="std_time_download-source.html#ts_utc_load">ts-utc-load<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>download<span class="fslash last">/</span></span>ts<span class="dash">-</span>utc<span class="dash">-</span>load: <span class="tp sp">(</span><span class="tp tpp">fname</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">path</span><span class="tp sp">,</span> <span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">io</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">&gt;</span> <span class="tp">timescale</span></span></a>(verbose<span class="kw">=</span><a class="pp">verbose<span class="pc">verbose: <span class="tp">bool</span></span></a>)
  (<span class="kw">fun</span>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="tp kw op">:</span><a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>){ <a class="pp" href="#dut_deltat">dut-deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>dut<span class="dash">-</span>deltat: <span class="tp sp">(</span><span class="tp tpp">ts<span class="dash">-</span>utc</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">dtt</span> <span class="tp kw op">:</span> <span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">ts-utc<span class="pc">ts<span class="dash">-</span>utc: <span class="tp">timescale</span></span></a>, <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a>,<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>) })
</span>}


<span class="comment">//-----------------------------------------------------------------
// Data from a finals2000A file.
//-----------------------------------------------------------------
</span>
<span class="comment">// A table of DUT (= UT1 - UTC) entries parsed from a IERS finals2000A file.
</span><span class="decl-type" id="type_space_dut_table"><span class="tp kw">struct</span> <span class="decl-con" id="con_space_Dut_table"><a class="pp" href="std_time_ut1.html#type_space_dut_table"><span class="tp">dut-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>dut<span class="dash">-</span>table: <span class="tp">V</span></span></a>(
  <span class="decl-fun" id="expire"><a class="pp">expire<span class="pc">expire: <span class="tp">instant</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>,
  <span class="decl-fun" id="start_1"><a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>,   <span class="comment">// start mjd
</span>  <span class="decl-fun" id="end"><a class="pp">end<span class="pc">end: <span class="tp">double</span></span></a></span>   <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>,   <span class="comment">// end mjd
</span>  <span class="decl-fun" id="duts"><a class="pp">duts<span class="pc">duts: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a></span>  <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_vector"><span class="tp">vector</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="comment">// one entry per day
</span></span></span>)

<span class="comment">// Calculate &amp;Delta;T from a DUT table.
// Interpolates linearly between daily entries.
</span><span class="decl-fun" id="dut_deltat"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#dut_deltat">dut-deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>dut<span class="dash">-</span>deltat: <span class="tp sp">(</span><span class="tp tpp">ts<span class="dash">-</span>utc</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">dtt</span> <span class="tp kw op">:</span> <span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">ts-utc<span class="pc">ts<span class="dash">-</span>utc: <span class="tp">timescale</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a>, <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_dut_table"><span class="tp">dut-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>dut<span class="dash">-</span>table: <span class="tp">V</span></span></a>, <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <a class="pp" href="std_core-source.html#try_default">try-default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>try<span class="dash">-</span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>(<a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>) {
    <span class="kw">val</span> <a class="pp">utci<span class="pc">utci: <span class="tp">instant</span></span></a> <span class="kw">=</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#use_timescale">use-timescale<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>use<span class="dash">-</span>timescale: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tscale</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">ts-utc<span class="pc">ts<span class="dash">-</span>utc: <span class="tp">timescale</span></span></a>)
    <span class="kw">val</span> <a class="pp">mjd<span class="pc">mjd: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">utci<span class="pc">utci: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#mjd">mjd<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>mjd: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tscale</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>(<a class="pp">ts-utc<span class="pc">ts<span class="dash">-</span>utc: <span class="tp">timescale</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_num_ddouble-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
    <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">mjd</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_lt__3">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#start_1">start<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>start<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">mjd<span class="pc">mjd: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_gt__eq__2">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#end">end<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>end: <span class="tp sp">(</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>) <span class="kw">then</span> <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw">else</span> {
      <span class="kw">val</span> <a class="pp">idx<span class="pc">idx: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">mjd<span class="pc">mjd: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#start_1">start<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>start<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_num_double-source.html#truncate">truncate<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>truncate: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#int_2">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
      <span class="comment">// interpolate
</span>      <span class="kw">val</span> <a class="pp">dut1<span class="pc">dut1: <span class="tp">double</span></span></a><span class="kw">=</span> <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#duts">duts<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>duts: <span class="tp sp">(</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_core-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>[]: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a><a class="pp">idx<span class="pc">idx: <span class="tp">int</span></span></a>]
      <span class="kw">val</span> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a><span class="kw">=</span> <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">idx</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span> <a class="pp" href="std_core-source.html#_gt__eq__1">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#duts">duts<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>duts: <span class="tp sp">(</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp">dut1<span class="pc">dut1: <span class="tp">double</span></span></a> <span class="kw">else</span> <a class="pp">dtt<span class="pc">dtt: <span class="tp">dut<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#duts">duts<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>duts: <span class="tp sp">(</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_core-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>[]: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a><a class="pp">idx<span class="pc">idx: <span class="tp">int</span></span></a><a class="pp" href="std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span>]
      <span class="kw">val</span> <a class="pp">dut3<span class="pc">dut3: <span class="tp">double</span></span></a><span class="kw">=</span> <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">dut1</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.5</span> <a class="pp" href="std_core-source.html#_lt__3">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut1<span class="pc">dut1: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.5</span> <a class="pp" href="std_core-source.html#_gt__2">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a>) <span class="kw">then</span> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a>
                <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">dut1</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.5</span> <a class="pp" href="std_core-source.html#_lt__3">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut1<span class="pc">dut1: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.5</span> <a class="pp" href="std_core-source.html#_gt__2">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a>) <span class="kw">then</span> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.0</span> <span class="comment">// a leap second was added
</span>                <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">dut1</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.5</span> <a class="pp" href="std_core-source.html#_gt__2">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut1<span class="pc">dut1: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.5</span> <a class="pp" href="std_core-source.html#_lt__3">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a>) <span class="kw">then</span> <a class="pp">dut2<span class="pc">dut2: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.0</span> <span class="comment">// a leap second was subtracted
</span>                <span class="kw">else</span> <a class="pp">dut1<span class="pc">dut1: <span class="tp">double</span></span></a> <span class="comment">// a jump outside a reasonable range; don't interpolate
</span>      <span class="kw">val</span> <a class="pp">dut<span class="pc">dut: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">dut1<span class="pc">dut1: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> ((<a class="pp">dut3<span class="pc">dut3: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">dut1<span class="pc">dut1: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">mjd<span class="pc">mjd: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_double-source.html#fraction">fraction<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>fraction: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
      <span class="comment">//val &#95; = trace("dut interpolate: " + dut1.show + ", and " + dut3.show + ", to " + dut.show)
</span>      <span class="comment">// calculate deltaT (TT - UT1) from DUT (=UT1 - UTC)
</span>      <span class="kw">val</span> <a class="pp">dt<span class="pc">dt: <span class="tp">timestamp</span></span></a>  <span class="kw">=</span> (<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#timestamp_in">timestamp-in<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timestamp<span class="dash">-</span>in: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tscale</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp" href="std_time_instant-source.html#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a>) <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">dut<span class="pc">dut: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_ddouble-source.html#ddouble">ddouble<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>ddouble: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>) <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">utci<span class="pc">utci: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#timestamp">timestamp<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timestamp: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_timestamp-source.html#unsafe_timespan_withleap">unsafe-timespan-withleap<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>unsafe<span class="dash">-</span>timespan<span class="dash">-</span>withleap: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a> <span class="comment">// include leap seconds!
</span>      <span class="comment">//val &#95; = trace("dut found: mjd: " + mjd.show + ", dut: " + dut.show + ", dt: " + dt.show)
</span>      <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( <a class="pp" href="std_time_duration-source.html#unsafe_duration">unsafe-duration<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>unsafe<span class="dash">-</span>duration: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">dt<span class="pc">dt: <span class="tp">timestamp</span></span></a>) )
    }
  }
</span>}


<span class="comment">// Parse a &#96;&#96;finals2000A.all&#96;&#96; file into a DUT table for precise &amp;Delta;T calculation (using &#96;dut-deltat&#96;)
// See &lt;http://maia.usno.navy.mil/ser7/finals2000A.all&gt;, or &lt;http://toshi.nofs.navy.mil/ser7/finals2000A.all&gt;
</span><span class="decl-fun" id="parse_iersA"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#parse_iersA">parse-iersA<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>iersA: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">dut<span class="dash">-</span>table</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="#type_space_dut_table"><span class="tp">dut-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>dut<span class="dash">-</span>table: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">val</span> <a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a>   <span class="kw">=</span> <span class="kw">match</span>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#find">find<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rx_finals_start">rx-finals-start<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>finals<span class="dash">-</span>start: <span class="tp">regex</span></span></a>) ) {
                  <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>   <span class="kw op">-></span> <span class="number">41684.0</span>
                  <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>) <span class="kw op">-></span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">1</span>]<span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">41684.0</span>)
                }
  <span class="kw">val</span> <a class="pp">mbexp<span class="pc">mbexp: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>   <span class="kw">=</span> <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#find">find<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rx_finals_expire">rx-finals-expire<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>finals<span class="dash">-</span>expire: <span class="tp">regex</span></span></a>) <span class="comment">// first prediction date
</span>  <span class="kw">val</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>    <span class="kw">=</span> <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#find_all">find-all<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rx_finals_dut">rx-finals-dut<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>finals<span class="dash">-</span>dut: <span class="tp">regex</span></span></a>)
  <span class="kw">val</span> <a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#map_acc">map-acc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>map<span class="dash">-</span>acc: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tpp">acc</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>(<span class="kw">fun</span>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>){ <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">1</span>]<span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">0.0</span>) })<span class="kw op">.</span><a class="pp" href="std_core-source.html#vector_3">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>

  <span class="kw">val</span> <a class="pp">end<span class="pc">end: <span class="tp">double</span></span></a>     <span class="kw">=</span> <a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
  <span class="kw">val</span> <a class="pp">expire<span class="pc">expire: <span class="tp">instant</span></span></a>  <span class="kw">=</span> (<span class="kw">match</span>(<a class="pp">mbexp<span class="pc">mbexp: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>) {
                  <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>) <span class="kw op">-></span> <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">1</span>]<span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<a class="pp">end<span class="pc">end: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">365.0</span>)
                  <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>   <span class="kw op">-></span> <a class="pp">end<span class="pc">end: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">365.0</span>  <span class="comment">// guess one year early
</span>                })<span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#instant_at_mjd">instant-at-mjd<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant<span class="dash">-</span>at<span class="dash">-</span>mjd: <span class="tp sp">(</span><span class="tp tpp">mjd</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp" href="std_time_utc-source.html#ts_ti">ts-ti<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>ts<span class="dash">-</span>ti: <span class="tp">timescale</span></span></a>)
  <span class="comment">//trace("finals2000A expire: " + expire.time.show)
</span>  <span class="comment">//trace("entries: " + entries.list.map(fun(d){ show(d) }).join("\n"))
</span>  <span class="comment">//trace("finals: " + entries.length.show + ", start: " + start.show + ", end: " + end.show )
</span>  <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#con_space_Dut_table"><span class="co">Dut-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>Dut<span class="dash">-</span>table: <span class="tp sp">(</span><span class="tp tpp">expire</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">duts</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">dut<span class="dash">-</span>table</span></span></a>(<a class="pp">expire<span class="pc">expire: <span class="tp">instant</span></span></a>,<a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a>,<a class="pp">end<span class="pc">end: <span class="tp">double</span></span></a>,<a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>))
</span>}
<span class="decl-val" id="rx_finals_dut"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#rx_finals_dut">rx-finals-dut<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>finals<span class="dash">-</span>dut: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"^.{57}[IP]([\\-\\+ ]\\d+(?:\\.\\d+))"</span>, multiline<span class="kw">=</span><a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></span>)
<span class="decl-val" id="rx_finals_start"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#rx_finals_start">rx-finals-start<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>finals<span class="dash">-</span>start: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"^(?:\\d\\d| \\d).{4} (\\d+(?:\\.\\d+)?)"</span>, multiline<span class="kw">=</span><a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></span>)
<span class="decl-val" id="rx_finals_expire"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#rx_finals_expire">rx-finals-expire<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>finals<span class="dash">-</span>expire: <span class="tp">regex</span></span></a><span class="kw">=</span> <a class="pp" href="std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"^(?:\\d\\d| \\d).{4} (\\d+(?:\\.\\d+)?) P"</span>, multiline<span class="kw">=</span><a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></span>)

<span class="comment">// recurse using an accumulator using constant heap space
</span><span class="decl-fun" id="map_acc"><span class="kw">private</span> <span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#map_acc">map-acc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>map<span class="dash">-</span>acc: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tpp">acc</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;9766</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp tv">&#95;9766</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;9767</span></span></a> <span class="tp kw op">:</span> <a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">b</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a>, <a class="pp">acc<span class="pc">acc: <span class="tp op">?</span><span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;9767</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="kw">=</span> <a class="pp" href="std_core-source.html#con_space_Nil"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_core-source.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">b</span><span class="pc">b: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">match</span>(<a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;9766</span><span class="tp sp">&gt;</span></span></a>) {
    <a class="pp" href="std_core-source.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp tv">&#95;9766</span></span></a>,<a class="pp">xx<span class="pc">xx: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;9766</span><span class="tp sp">&gt;</span></span></a>) <span class="kw op">-></span> <a class="pp" href="#map_acc">map-acc<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>map<span class="dash">-</span>acc: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tpp">acc</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">xx<span class="pc">xx: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;9766</span><span class="tp sp">&gt;</span></span></a>,<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp tv">&#95;9766</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;9767</span></span></a>,<a class="pp" href="std_core-source.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp sp">(</span><span class="tp tv">&#95;9766</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">&#95;9767</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp tv">&#95;9766</span></span></a>),<a class="pp">acc<span class="pc">acc: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;9767</span><span class="tp sp">&gt;</span></span></a>))
    <a class="pp" href="std_core-source.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> <a class="pp" href="std_core-source.html#reverse">reverse<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>reverse: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">acc<span class="pc">acc: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;9767</span><span class="tp sp">&gt;</span></span></a>)
  }
</span>}



<span class="comment">// -----------------------------------------------------------
// UT1 timescale; UT1 = TT - DeltaT
// -----------------------------------------------------------
</span>
<span class="decl-fun" id="tai_to_ut1"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#tai_to_ut1">tai-to-ut1<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>ut1: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>( <a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span><span class="tp kw op">:</span><a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>  <span class="kw">=</span> <a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#instant_1">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>
  <span class="kw">val</span> <a class="pp">dt<span class="pc">dt: <span class="tp">duration</span></span></a> <span class="kw">=</span> <a class="pp" href="#deltat">deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>,<a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>)
  <span class="comment">// trace("tai-to-ut: dt: " + dt.show )
</span>  (<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <a class="pp" href="std_time_instant-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a> <a class="pp">dt<span class="pc">dt: <span class="tp">duration</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#timestamp_in">timestamp-in<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timestamp<span class="dash">-</span>in: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tscale</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp" href="std_time_instant-source.html#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a>)
</span>}

<span class="decl-fun" id="ut1_to_tai"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#ut1_to_tai">ut1-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ut1<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>( <a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a>, <a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>   <span class="kw">=</span> <a class="pp" href="std_time_instant-source.html#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#instant">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a>)             <span class="comment">// approximately tt
</span>  <span class="kw">val</span> <a class="pp">i1<span class="pc">i1: <span class="tp">instant</span></span></a>  <span class="kw">=</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <a class="pp" href="std_time_instant-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a> <a class="pp" href="#deltat">deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>,<a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>)    <span class="comment">// approximate tai
</span>  <span class="kw">val</span> <a class="pp">i2<span class="pc">i2: <span class="tp">instant</span></span></a>  <span class="kw">=</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <a class="pp" href="std_time_instant-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a> <a class="pp" href="#deltat">deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">i1<span class="pc">i1: <span class="tp">instant</span></span></a>,<a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>)   <span class="comment">// improve over previous approximation
</span>  <span class="comment">// trace("ut-to-tai: dt1: " + deltat(i0).show + ", dt2: " + deltat(i1).show)
</span>  <a class="pp">i2<span class="pc">i2: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#duration">duration<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>duration: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>
</span>}

<span class="comment">// Takes an optional &#96;dt&#96; parameter to calculate &amp;Delta;T (=TT - UT1)
// more precisely. The &#96;dt&#96; functions should return &#96;Nothing&#96; for instants
// outside its range so the builtin methods can be used in that case (see &#96;deltat&#96;)
</span><span class="decl-fun" id="ts_ut1_create"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#ts_ut1_create">ts-ut1-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ts<span class="dash">-</span>ut1<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">dt</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>( <a class="pp">dt<span class="pc">dt: <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="kw">=</span> <a class="pp" href="#deltat_none">deltat-none<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>none: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> {
  <a class="pp" href="std_time_instant-source.html#timescale_1">timescale<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">from<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">to<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">unit</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">seconds<span class="dash">-</span>in<span class="dash">-</span>day</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">to<span class="dash">-</span>mjd2000</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">from<span class="dash">-</span>mjd2000</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(<span class="st">"UT1"</span>,
    <span class="kw">fun</span>(<a class="pp">i<span class="pc">i: <span class="tp">duration</span></span></a>) { <a class="pp" href="#tai_to_ut1">tai-to-ut1<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>ut1: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">duration</span></span></a>,<a class="pp">dt<span class="pc">dt: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>) },
    <span class="kw">fun</span>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a>) { <a class="pp" href="#ut1_to_tai">ut1-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ut1<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a>,<a class="pp">dt<span class="pc">dt: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>) }
  )
</span>}

<span class="comment">// -----------------------------------------------------------
// UT2 timescale.
// UT2 = UT1 + 0.022&#42;sin(2&#42;pi&#42;t) - 0.012&#42;cos(2&#42;pi&#42;t) - 0.006&#42;sin(4&#42;pi&#42;t) + 0.007&#42;cos(4&#42;pi&#42;t)
// -----------------------------------------------------------
</span>
<span class="decl-fun" id="ut2_offset"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#ut2_offset">ut2-offset<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ut2<span class="dash">-</span>offset: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>( <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timespan"><span class="tp">timespan</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan: <span class="tp">V</span></span></a> {

  <span class="comment">// UT2 = UT1 + 0.022&#42;sin(2&#42;pi&#42;t) - 0.012&#42;cos(2&#42;pi&#42;t) - 0.006&#42;sin(4&#42;pi&#42;t) + 0.007&#42;cos(4&#42;pi&#42;t)
</span>  <span class="comment">// where &#96;t&#96; is the fraction of the Besselian year:
</span>  <span class="comment">// t = 1900.0 + ((i.jd(ts-tt).double - 2415020.31352) / 365.242198781)
</span>  <span class="comment">//
</span>  <span class="comment">// The periodic definition comes from:
</span>  <span class="comment">//   McCarthy, Dennis D. (July 1991). "Astronomical Time".
</span>  <span class="comment">//   Proceedings of the IEEE. 79 (7): 915-920. doi:10.1109/5.84967.
</span>  <span class="comment">//   &lt;http://www.cl.cam.ac.uk/~mgk25/volatile/astronomical-time.pdf&gt;
</span>  <span class="comment">// and:
</span>  <span class="comment">//   P.K.\ Seidelmann.
</span>  <span class="comment">//   &#95;Explanatory Supplement to the Astronomical Almanac&#95;. page 85.
</span>  <span class="comment">//   &lt;https://books.google.co.jp/books?id=uJ4JhGJANb4C&amp;pg=PA85&amp;lpg=PA85&amp;dq=ut2+time+sin+cos+ut2&amp;source=bl&amp;ots=zOZLBf8Qu5&amp;sig=ACfU3U31AIFUM5rTUK-oGQUqv9BaqQJigw&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwjDs53Z563hAhWewosBHTlVBacQ6AEwEHoECAkQAQ#v=onepage&amp;q=ut2%20time%20sin%20cos%20ut2&amp;f=false&gt;
</span>  <span class="comment">// The Besselian year definition is by:
</span>  <span class="comment">//   Jay\ Lieske.
</span>  <span class="comment">//   &#95;Precession Matrix Based on IAU&#95; (1976)
</span>  <span class="comment">//   System of Astronomical Constants, Astronomy \&amp; Astrophysics, 73, pages 282--284 (1979)
</span>  <span class="comment">//   &lt;https://en.wikipedia.org/wiki/Year#Besselian&#95;year&gt;
</span>  <span class="kw">val</span> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a>     <span class="kw">=</span> <span class="number">1900.0</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> ((<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#jd">jd<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>jd: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a>(<a class="pp" href="std_time_instant-source.html#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_num_ddouble-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">2415020.31352</span>) <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">365.242198781</span>) <span class="comment">// Besselian years
</span>  <span class="kw">val</span> <a class="pp">tp2<span class="pc">tp2: <span class="tp">double</span></span></a>   <span class="kw">=</span> <a class="pp" href="std_num_double-source.html#dbl_twopi">dbl-twopi<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>dbl<span class="dash">-</span>twopi: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_double-source.html#ffraction">ffraction<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>ffraction: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
  <span class="kw">val</span> <a class="pp">tp4<span class="pc">tp4: <span class="tp">double</span></span></a>   <span class="kw">=</span> <span class="number">2.0</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">tp2<span class="pc">tp2: <span class="tp">double</span></span></a>
  <span class="kw">val</span> <a class="pp">ofs<span class="pc">ofs: <span class="tp">double</span></span></a>   <span class="kw">=</span> <span class="number">0.022</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_num_double-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tp2<span class="pc">tp2: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.012</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_num_double-source.html#cos">cos<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>cos: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tp2<span class="pc">tp2: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.006</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_num_double-source.html#sin">sin<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>sin: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tp4<span class="pc">tp4: <span class="tp">double</span></span></a>) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.007</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp" href="std_num_double-source.html#cos">cos<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>cos: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">tp4<span class="pc">tp4: <span class="tp">double</span></span></a>)
  <a class="pp">ofs<span class="pc">ofs: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_timestamp-source.html#timespan_1">timespan<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timespan<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">secs</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>
</span>}

<span class="decl-fun" id="tai_to_ut2"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#tai_to_ut2">tai-to-ut2<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>ut2: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>( <a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span><span class="tp kw op">:</span><a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>   <span class="kw">=</span> <a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#instant_1">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>
  <span class="kw">val</span> <a class="pp">ut1<span class="pc">ut1: <span class="tp">timestamp</span></span></a> <span class="kw">=</span> <a class="pp">tai<span class="pc">tai: <span class="tp">duration</span></span></a><span class="kw op">.</span><a class="pp" href="#tai_to_ut1">tai-to-ut1<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>ut1: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>)
  (<a class="pp">ut1<span class="pc">ut1: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="#ut2_offset">ut2-offset<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ut2<span class="dash">-</span>offset: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>)
</span>}

<span class="decl-fun" id="ut2_to_tai"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#ut2_to_tai">ut2-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ut2<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>( <a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_timestamp-source.html#type_space_timestamp"><span class="tp">timestamp</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>timestamp: <span class="tp">V</span></span></a>, <a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <span class="kw">=</span> <a class="pp" href="std_time_instant-source.html#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_instant-source.html#instant">instant<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timescale</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">instant</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a>)
  <span class="kw">val</span> <a class="pp">ut1<span class="pc">ut1: <span class="tp">timestamp</span></span></a> <span class="kw">=</span> <a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a> <a class="pp" href="std_time_timestamp-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>timestamp<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="#ut2_offset">ut2-offset<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ut2<span class="dash">-</span>offset: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span></span></a>          <span class="comment">// approximate ut1
</span>  <a class="pp">ut1<span class="pc">ut1: <span class="tp">timestamp</span></span></a><span class="kw op">.</span><a class="pp" href="#ut1_to_tai">ut1-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ut1<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>)
</span>}

<span class="comment">// Takes an optional &#96;dt&#96; parameter to calculate &amp;Delta;T (=TT - UT1)
// more precisely (since UT2 is derived from UT1).
// The &#96;dt&#96; functions should return &#96;Nothing&#96; for instants
// outside its range so the builtin methods can be used in that case (see &#96;deltat&#96;)
</span><span class="decl-fun" id="ts_ut2_create"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#ts_ut2_create">ts-ut2-create<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ts<span class="dash">-</span>ut2<span class="dash">-</span>create: <span class="tp sp">(</span><span class="tp tpp">dt</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>( <a class="pp">dt<span class="pc">dt: <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="kw">=</span> <a class="pp" href="#deltat_none">deltat-none<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>none: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a> {
  <a class="pp" href="std_time_instant-source.html#timescale_1">timescale<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">from<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">duration</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">to<span class="dash">-</span>tai</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">unit</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">seconds<span class="dash">-</span>in<span class="dash">-</span>day</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp">timestamp</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timespan</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">to<span class="dash">-</span>mjd2000</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">tzdelta</span> <span class="tp kw op">:</span> <span class="tp">timespan</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">from<span class="dash">-</span>mjd2000</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp sp">(</span><span class="tp tpp">days</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timescale</span></span></a>(<span class="st">"UT2"</span>,
    <span class="kw">fun</span>(<a class="pp">i<span class="pc">i: <span class="tp">duration</span></span></a>) { <a class="pp" href="#tai_to_ut2">tai-to-ut2<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>tai<span class="dash">-</span>to<span class="dash">-</span>ut2: <span class="tp sp">(</span><span class="tp tpp">tai</span> <span class="tp kw op">:</span> <span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">timestamp</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">duration</span></span></a>,<a class="pp">dt<span class="pc">dt: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>) },
    <span class="kw">fun</span>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a>) { <a class="pp" href="#ut2_to_tai">ut2-to-tai<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>ut2<span class="dash">-</span>to<span class="dash">-</span>tai: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">timestamp</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>(<a class="pp">t<span class="pc">t: <span class="tp">timestamp</span></span></a>,<a class="pp">dt<span class="pc">dt: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>) }
  )
</span>}

<span class="comment">// -----------------------------------------------------------
// Calculate delta-t
// -----------------------------------------------------------
</span>
<span class="decl-fun" id="deltat_none"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#deltat_none">deltat-none<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>none: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
</span>}

<span class="comment">/&#42; Calculate &amp;Delta;T (= TT - UT1);
If the &#96;dt-override&#96; function returns &#96;Nothing&#96;, it tries in order:

&#42; monthly determined tables for any observed date (usually &gt; 1973 up to now (2016))
&#42; quarterly prediction tables for dates &gt; now (2016) up to about 10 years (2025)
&#42; yearly historic tables for dates &gt;= 1750
&#42; fitted parabolic approximations for dates between -500 and 2150; (Espenak &amp; Meeus 2006)
&#42; generic parabolic approximation for dates &lt; -500 and dates &gt; 2150 (Morrison and Stephenson, 2004.)

&#42;/</span>
<span class="decl-fun" id="deltat"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#deltat">deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">dt<span class="dash">-</span>override</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>( <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a>, <a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp tpp">i</span> <span class="tp kw op">:</span> <a class="pp" href="std_time_instant-source.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> <span class="kw">=</span> <a class="pp" href="#deltat_none">deltat-none<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>none: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_time_duration-source.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">dt<span class="pc">dt: <span class="tp">duration</span></span></a> <span class="kw">=</span> <span class="kw">match</span>(<a class="pp">dt-override<span class="pc">dt<span class="dash">-</span>override: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">duration</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a>)) {
            <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">dt<span class="pc">dt: <span class="tp">duration</span></span></a>) <span class="kw op">-></span> <a class="pp">dt<span class="pc">dt: <span class="tp">duration</span></span></a>
            <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>  <span class="kw op">-></span> {
              <span class="kw">val</span> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">i<span class="pc">i: <span class="tp">instant</span></span></a><span class="kw op">.</span><a class="pp" href="std_time_time-source.html#time">time<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>time<span class="fslash last">/</span></span>time: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">instant</span><span class="tp sp">,</span> <span class="tp tpp">tz</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timezone</span><span class="tp sp">,</span> <span class="tp tpp">cal</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">calendar</span><span class="tp sp">,</span> <span class="tp tpp">ts</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">timescale</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">time</span></span></a>(ts<span class="kw">=</span><a class="pp" href="std_time_instant-source.html#ts_tt">ts-tt<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>ts<span class="dash">-</span>tt: <span class="tp">timescale</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_time_time-source.html#year_frac">year-frac<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>time<span class="fslash last">/</span></span>year<span class="dash">-</span>frac: <span class="tp sp">(</span><span class="tp tpp">t</span> <span class="tp kw op">:</span> <span class="tp">time</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">ddouble</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_ddouble-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>ddouble<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">ddouble</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_double-source.html#round_to_prec">round-to-prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>round<span class="dash">-</span>to<span class="dash">-</span>prec: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">4</span>)
              <a class="pp" href="#deltat_builtin">deltat-builtin<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>builtin: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">determined</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">predicted</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)<span class="kw op">.</span><a class="pp" href="std_time_duration-source.html#duration_2">duration<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">secs</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">duration</span></span></a>
            }
          }
  <span class="comment">// trace("deltat: year: " + y.show-ddouble + ", dt: " + dt.show)
</span>  <a class="pp">dt<span class="pc">dt: <span class="tp">duration</span></span></a>
</span>}

<span class="decl-fun" id="deltat_builtin"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#deltat_builtin">deltat-builtin<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>builtin: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">determined</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">predicted</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>,
                   <a class="pp">determined<span class="pc">determined: <span class="tp op">?</span><span class="tp">deltat<span class="dash">-</span>table</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#deltat_table_determined">deltat-table-determined<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>determined: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(),
                   <a class="pp">predicted<span class="pc">predicted: <span class="tp op">?</span><span class="tp">deltat<span class="dash">-</span>table</span></span></a>  <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#deltat_table_predicted">deltat-table-predicted<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>predicted: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>() ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>
{
  <span class="comment">// A date after (about) 1986 ?  (determined starts usually at 1973.0833333)
</span>  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_gt__eq__2">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">determined<span class="pc">determined: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#start">start<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>start: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_gt__eq__2">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">1986.0</span>) {
    <span class="comment">// observed Delta-T is best
</span>    <span class="kw">match</span>(<a class="pp">determined<span class="pc">determined: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#interpolate">interpolate<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>interpolate: <span class="tp sp">(</span><span class="tp tpp">dtable</span> <span class="tp kw op">:</span> <span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)) {
      <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">dt<span class="pc">dt: <span class="tp">double</span></span></a>) <span class="kw op">-></span> <a class="pp">dt<span class="pc">dt: <span class="tp">double</span></span></a>
      <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> {
        <span class="comment">// otherwise use predicted values
</span>        <span class="kw">match</span>(<a class="pp">predicted<span class="pc">predicted: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#interpolate">interpolate<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>interpolate: <span class="tp sp">(</span><span class="tp tpp">dtable</span> <span class="tp kw op">:</span> <span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)) {
          <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">dt<span class="pc">dt: <span class="tp">double</span></span></a>) <span class="kw op">-></span> <a class="pp">dt<span class="pc">dt: <span class="tp">double</span></span></a>
          <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>  <span class="kw op">-></span> <a class="pp" href="#deltat_future_approx">deltat-future-approx<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>future<span class="dash">-</span>approx: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)
        }
      }
    }
  }
  <span class="comment">// Use historic data; goes up to 1987 (excluded)
</span>  <span class="kw">else</span> {
    <span class="kw">match</span>(<a class="pp" href="#deltat_table_historic">deltat-table-historic<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>historic: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>()<span class="kw op">.</span><a class="pp" href="#interpolate">interpolate<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>interpolate: <span class="tp sp">(</span><span class="tp tpp">dtable</span> <span class="tp kw op">:</span> <span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)) {
      <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">dt<span class="pc">dt: <span class="tp">double</span></span></a>) <span class="kw op">-></span> <a class="pp">dt<span class="pc">dt: <span class="tp">double</span></span></a>
      <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>  <span class="kw op">-></span> <a class="pp" href="#deltat_historic_approx">deltat-historic-approx<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>historic<span class="dash">-</span>approx: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)
    }
  }
</span>}

<span class="comment">// Approximate delta-t before 1800 using parabolic fitted curves (Espenak &amp; Meeus 2006).
// See &lt;https://eclipse.gsfc.nasa.gov/SEcat5/deltatpoly.html&gt;
</span><span class="decl-fun" id="deltat_historic_approx"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#deltat_historic_approx">deltat-historic-approx<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>historic<span class="dash">-</span>approx: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_gt__2">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">1800.0</span>) <span class="kw">then</span> {
    <a class="pp" href="#deltat_future_approx">deltat-future-approx<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>future<span class="dash">-</span>approx: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)
  }
  <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_gt__eq__2">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">1700.0</span>) {
    <span class="kw">val</span> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1700.0</span>
    <span class="number">8.83</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">0.1603</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.0059285</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">0.00013336</span> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">1174000.0</span>))))
  }
  <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_gt__eq__2">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">1600.0</span>) {
    <span class="kw">val</span> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1600.0</span>
    <span class="number">120.0</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.9808</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.01532</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">7129.0</span>)))
  }
  <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_gt__eq__2">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">500.0</span>) {
    <span class="kw">val</span> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <span class="kw">=</span> (<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1000.0</span>)<a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">100.0</span>
    <span class="number">1574.2</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">556.01</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">71.23472</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">0.319781</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.8503463</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.005050998</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.0083572073</span>)))))
  }
  <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_gt__eq__2">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">500.0</span>) {
    <span class="kw">val</span> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">100.0</span>
    <span class="number">10583.6</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">1014.41</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">33.78311</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">5.952053</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.1798452</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">0.022174192</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.0090316521</span>)))))
  }
  <span class="kw">else</span> <a class="pp" href="#deltat_generic">deltat-generic<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>generic: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)
</span>}

<span class="comment">// Approximate delta-t after 1986 using parabolic estimates (from Espenak &amp; Meeus 2006).
// See &lt;https://eclipse.gsfc.nasa.gov/SEcat5/deltatpoly.html&gt;
</span><span class="decl-fun" id="deltat_future_approx"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#deltat_future_approx">deltat-future-approx<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>future<span class="dash">-</span>approx: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_lt__3">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">1986.0</span>) <span class="kw">then</span> {
    <a class="pp" href="#deltat_generic">deltat-generic<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>generic: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)
  }
  <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_lt__eq__3">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">2005.0</span>) {
    <span class="kw">val</span> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">2000.0</span>
    <span class="number">63.86</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">0.3345</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.060374</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">0.0017275</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">0.000651814</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.00002373599</span>))))
  }
  <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_lt__eq__3">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">2050.0</span>) {
    <span class="kw">val</span> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">2000.0</span>
    <span class="number">62.92</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">0.32217</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">t<span class="pc">t: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">0.005589</span>)
  }
  <span class="kw">elif</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_lt__eq__3">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">2150.0</span>) {
    <span class="kw">val</span> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <span class="kw">=</span> (<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1820.0</span>)<a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">100.0</span>
    <a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">20.0</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">32.0</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">0.5628</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<span class="number">2150.0</span> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)
  }
  <span class="kw">else</span> <a class="pp" href="#deltat_generic">deltat-generic<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>generic: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)
</span>}


<span class="comment">// Generic delta-t from Morrison and Stephenson, 2004.
</span><span class="decl-fun" id="deltat_generic"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#deltat_generic">deltat-generic<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>generic: <span class="tp sp">(</span><span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a> <span class="kw">=</span> (<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1820.0</span>)<a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">100.0</span>
   <a class="pp" href="std_core-source.html#_tilde__1">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">20.0</span> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">32.0</span><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a><a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">u<span class="pc">u: <span class="tp">double</span></span></a>
</span>}



<span class="comment">// -----------------------------------------------------------
// Parsing for less recent UT1 tables:
// historic data, recent determined data, and 10 year predictions.
// -----------------------------------------------------------
</span>
<span class="comment">// A deltat-table has a &#96;start&#96; date (fractional year) and a number of evenly
// spaced entries per year. Usually 2 for historic data (every half year),
// 12 for determined data (monthly), and 4 for predicted data (quarterly).
// The entries contain the delta-t at the start of that period.
</span><span class="decl-type" id="type_space_deltat_table"><span class="tp kw">struct</span> <span class="decl-con" id="con_space_Deltat_table"><a class="pp" href="std_time_ut1.html#type_space_deltat_table"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table: <span class="tp">V</span></span></a>(
  <span class="decl-fun" id="start"><a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>,            <span class="comment">// fractional year
</span>  <span class="decl-fun" id="entries_per_year"><a class="pp">entries-per-year<span class="pc">entries<span class="dash">-</span>per<span class="dash">-</span>year: <span class="tp">double</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>,
  <span class="decl-fun" id="entries"><a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_vector"><span class="tp">vector</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>
</span></span>)

<span class="decl-val" id="deltat_table_empty"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#deltat_table_empty">deltat-table-empty<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>empty: <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <span class="kw">=</span> <a class="pp" href="#con_space_Deltat_table"><span class="co">Deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>Deltat<span class="dash">-</span>table: <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">entries<span class="dash">-</span>per<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">entries</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(<span class="number">0.0</span>,<span class="number">0.0</span>,<a class="pp" href="std_core-source.html#vector_2">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">default</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<span class="number">0</span>,<span class="number">0.0</span>)</span>)

<span class="comment">// Given a &#96;deltat-table&#96; and a fractional year, return the delta-t by
// linear interpolation between two known delta-t instants. If the
// year &#96;y&#96; is outside the bounds of the table, return &#96;Nothing&#96;.
</span><span class="decl-fun" id="interpolate"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#interpolate">interpolate<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>interpolate: <span class="tp sp">(</span><span class="tp tpp">dtable</span> <span class="tp kw op">:</span> <span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">dtable<span class="pc">dtable: <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_deltat_table"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> )  <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> {
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">y</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="std_core-source.html#_lt__3">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dtable<span class="pc">dtable: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#start">start<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>start: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">dtable<span class="pc">dtable: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#end_1">end<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>end<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">tb</span> <span class="tp kw op">:</span> <span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_lt__eq__3">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>) <span class="kw">then</span> <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw">else</span> {
    <a class="pp" href="std_core-source.html#try_default">try-default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>try<span class="dash">-</span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">exn</span><span class="tp sp">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a>(<a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>) {
      <span class="kw">val</span> <a class="pp">i<span class="pc">i: <span class="tp">double</span></span></a>   <span class="kw">=</span> (<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">dtable<span class="pc">dtable: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#start">start<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>start: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)<a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">dtable<span class="pc">dtable: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#entries_per_year">entries-per-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>entries<span class="dash">-</span>per<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
      <span class="kw">val</span> <a class="pp">idx<span class="pc">idx: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">i<span class="pc">i: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_double-source.html#truncate">truncate<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>truncate: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#int_2">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
      <span class="kw">val</span> <a class="pp">d0<span class="pc">d0: <span class="tp">double</span></span></a>  <span class="kw">=</span> <a class="pp">dtable<span class="pc">dtable: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#entries">entries<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>entries: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_core-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>[]: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a><a class="pp">idx<span class="pc">idx: <span class="tp">int</span></span></a>]
      <span class="kw">val</span> <a class="pp">d1<span class="pc">d1: <span class="tp">double</span></span></a>  <span class="kw">=</span> <a class="pp">dtable<span class="pc">dtable: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#entries">entries<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>entries: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="std_core-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>[]: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a><a class="pp">idx<span class="pc">idx: <span class="tp">int</span></span></a><a class="pp" href="std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span>]
      <a class="pp" href="std_core-source.html#con_space_Just"><span class="co">Just</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Just: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">d0<span class="pc">d0: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> ((<a class="pp">d1<span class="pc">d1: <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">d0<span class="pc">d0: <span class="tp">double</span></span></a>)<a class="pp" href="std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">i<span class="pc">i: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_double-source.html#fraction">fraction<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>fraction: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>) )
    }
  }
</span>}

<span class="comment">// The end fractional year until which this table contains valid data.
</span><span class="decl-fun" id="end_1"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#end_1">end<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>end<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">tb</span> <span class="tp kw op">:</span> <span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">tb<span class="pc">tb: <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_deltat_table"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a> {
  <a class="pp">tb<span class="pc">tb: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#start">start<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>start: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp">tb<span class="pc">tb: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#entries">entries<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>entries: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#length_2">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.2</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">tb<span class="pc">tb: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#entries_per_year">entries-per-year<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>entries<span class="dash">-</span>per<span class="dash">-</span>year: <span class="tp sp">(</span><span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
</span>}


<span class="decl-fun" id="parse_deltat"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#parse_deltat">parse-deltat<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>deltat: <span class="tp sp">(</span><span class="tp tpp">determined</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">predicted</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp tpp">year</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span></span></a>( <a class="pp">determined<span class="pc">determined: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>, <a class="pp">predicted<span class="pc">predicted: <span class="tp op">?</span><span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_optional"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="st">""</span>) <span class="tp kw op">:</span> <span class="tp sp">(</span><a class="pp" href="std_core-source.html#type_space__lt__gt_"><span class="tp"><span class="effect">(</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;&gt;): <span class="tp">E</span></span></a><span class="tp tpp">year</span><span class="tp kw op">:</span><a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core-source.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span><span class="tp sp">)</span> {
  <span class="kw">val</span> <a class="pp">det<span class="pc">det: <span class="tp">deltat<span class="dash">-</span>table</span></span></a>  <span class="kw">=</span> <a class="pp" href="#parse_determined">parse-determined<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>determined: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(<a class="pp">determined<span class="pc">determined: <span class="tp">string</span></span></a>)
  <span class="kw">val</span> <a class="pp">pred<span class="pc">pred: <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <span class="kw">=</span> <a class="pp" href="#parse_predicted">parse-predicted<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>predicted: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(<a class="pp">predicted<span class="pc">predicted: <span class="tp">string</span></span></a>)
  (<span class="kw">fun</span>(<a class="pp">year<span class="pc">year: <span class="tp">double</span></span></a><span class="tp kw op">:</span><a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>) {
    <span class="kw">match</span>(<a class="pp">det<span class="pc">det: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#interpolate">interpolate<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>interpolate: <span class="tp sp">(</span><span class="tp tpp">dtable</span> <span class="tp kw op">:</span> <span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">year<span class="pc">year: <span class="tp">double</span></span></a>)) {
      <a class="pp" href="std_core-source.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> <a class="pp">pred<span class="pc">pred: <span class="tp">deltat<span class="dash">-</span>table</span></span></a><span class="kw op">.</span><a class="pp" href="#interpolate">interpolate<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>interpolate: <span class="tp sp">(</span><span class="tp tpp">dtable</span> <span class="tp kw op">:</span> <span class="tp">deltat<span class="dash">-</span>table</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">year<span class="pc">year: <span class="tp">double</span></span></a>)
      <a class="pp">jdt<span class="pc">jdt: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>     <span class="kw op">-></span> <a class="pp">jdt<span class="pc">jdt: <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>
    }
  })
</span>}


<span class="decl-fun" id="parse_predicted"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#parse_predicted">parse-predicted<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>predicted: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_deltat_table"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#find_all">find-all<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rx_predict">rx-predict<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>predict: <span class="tp">regex</span></span></a>)
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">caps</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#nil_ques_">nil?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>nil?: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">list</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <a class="pp" href="#deltat_table_empty">deltat-table-empty<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>empty: <span class="tp">deltat<span class="dash">-</span>table</span></span></a>
  <span class="kw">val</span> <a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#head_1">head<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>head<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#map">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>(<span class="kw">fun</span>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>){ <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">1</span>] })<span class="kw op">.</span><a class="pp" href="std_core-source.html#default">default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="st">""</span>)<span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">2000.0</span>)
  <span class="kw">val</span> <a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>(<span class="kw">fun</span>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>){ <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">2</span>]<span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">0.0</span>) })<span class="kw op">.</span><a class="pp" href="std_core-source.html#vector_3">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  <a class="pp" href="#con_space_Deltat_table"><span class="co">Deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>Deltat<span class="dash">-</span>table: <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">entries<span class="dash">-</span>per<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">entries</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(<a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a>,<span class="number">4.0</span>,<a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>)
</span>}
<span class="decl-val" id="rx_predict"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#rx_predict">rx-predict<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>predict: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"^\\s&#42;\\d+\\.\\d+\\s&#42;(\\d+\\.\\d+)\\s&#42;(\\d+(?:\\.\\d&#42;)?)"</span>, multiline<span class="kw">=</span><a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></span>)

<span class="decl-fun" id="parse_determined"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#parse_determined">parse-determined<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>determined: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_deltat_table"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>  <span class="kw">=</span> <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#find_all">find-all<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rx_determined">rx-determined<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>determined: <span class="tp">regex</span></span></a>)
  <span class="kw">if</span> (<a class="pp" href="std_core-source.html#con_space_True"><span class="co">caps</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#nil_ques_">nil?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>nil?: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">list</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <a class="pp" href="#deltat_table_empty">deltat-table-empty<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>empty: <span class="tp">deltat<span class="dash">-</span>table</span></span></a>
  <span class="kw">val</span> <a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">string</span></span></a>,<a class="pp">m<span class="pc">m: <span class="tp">string</span></span></a><a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#head_1">head<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>head<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#map">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>(<span class="kw">fun</span>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>){ <a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">1</span>],<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">2</span>]<a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> })<span class="kw op">.</span><a class="pp" href="std_core-source.html#default">default<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>default: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><span class="st">""</span>,<span class="st">""</span><a class="pp" href="std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>)
  <span class="kw">val</span> <a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">2000.0</span>) <a class="pp" href="std_core-source.html#_plus__2">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> ((<a class="pp">m<span class="pc">m: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">1.0</span>) <a class="pp" href="std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <span class="number">1.0</span>)<a class="pp" href="std_core-source.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">12.0</span>)
  <span class="kw">val</span> <a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>(<span class="kw">fun</span>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>){ <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#groups">groups<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>groups: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">groups</span></span></a><a class="pp" href="std_text_regex-source.html#_index_">[<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>[]: <span class="tp sp">(</span><span class="tp tpp">groups</span> <span class="tp kw op">:</span> <span class="tp">groups</span><span class="tp sp">,</span> <span class="tp tpp">index</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="number">4</span>]<span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">0.0</span>) })<span class="kw op">.</span><a class="pp" href="std_core-source.html#vector_3">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  <a class="pp" href="#con_space_Deltat_table"><span class="co">Deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>Deltat<span class="dash">-</span>table: <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">entries<span class="dash">-</span>per<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">entries</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(<a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a>,<span class="number">12.0</span>,<a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>)
</span>}
<span class="decl-val" id="rx_determined"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#rx_determined">rx-determined<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rx<span class="dash">-</span>determined: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"^\\s&#42;(\\d+)\\s+(\\d+)\\s+(\\d+)\\s+(\\d+(?:\\.\\d&#42;)?)"</span>, multiline<span class="kw">=</span><a class="pp" href="std_core-source.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></span>)


<span class="decl-fun" id="parse_historic"><span class="kw">fun</span> <a class="pp" href="std_time_ut1.html#parse_historic">parse-historic<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>historic: <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>( <a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a><span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>, <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_deltat_table"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#replace_all_1">replace-all<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>replace<span class="dash">-</span>all<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">,</span> <span class="tp tpp">repl</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp" href="#rxcomment">rxcomment<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rxcomment: <span class="tp">regex</span></span></a>,<span class="st">""</span>)<span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#find_all">find-all<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>find<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">regex</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a>(<a class="pp" href="#rxdouble">rxdouble<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rxdouble: <span class="tp">regex</span></span></a>)
  <span class="kw">val</span> <a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">caps<span class="pc">caps: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">matched</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>(<span class="kw">fun</span>(<a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a>){ <a class="pp">cap<span class="pc">cap: <span class="tp">matched</span></span></a><span class="kw op">.</span><a class="pp" href="std_text_regex-source.html#matched">matched<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>matched: <span class="tp sp">(</span><span class="tp tpp">matched</span> <span class="tp kw op">:</span> <span class="tp">matched</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="std_num_double-source.html#parse_double">parse-double<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>double<span class="fslash last">/</span></span>parse<span class="dash">-</span>double: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="std_core-source.html#maybe_3">maybe<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">maybe</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">nothing</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span></span></a>(<span class="number">0.0</span>) })<span class="kw op">.</span><a class="pp" href="std_core-source.html#vector_3">vector<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>vector<span class="postfix">.3</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  <a class="pp" href="#con_space_Deltat_table"><span class="co">Deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>Deltat<span class="dash">-</span>table: <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">entries<span class="dash">-</span>per<span class="dash">-</span>year</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">entries</span> <span class="tp kw op">:</span> <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(<a class="pp">start<span class="pc">start: <span class="tp">double</span></span></a>,<span class="number">2.0</span>,<a class="pp">entries<span class="pc">entries: <span class="tp">vector</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>)
</span>}
<span class="decl-val" id="rxdouble"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#rxdouble">rxdouble<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rxdouble: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"-?\\d+(?:\\.\\d+)?"</span></span>)
<span class="decl-val" id="rxcomment"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#rxcomment">rxcomment<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>rxcomment: <span class="tp">regex</span></span></a> <span class="kw">=</span> <a class="pp" href="std_text_regex-source.html#regex">regex<span class="pc"><span class="mo">std<span class="fslash">/</span>text<span class="fslash">/</span>regex<span class="fslash last">/</span></span>regex: <span class="tp sp">(</span><span class="tp tpp">regex</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">ignorecase</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">multiline</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">regex</span></span></a>(<span class="st">"//.&#42;"</span></span>)




<span class="comment">//-----------------------------------------------------------------
// Historic data (half-yearly from 1750 up to 1987)
//-----------------------------------------------------------------
</span>
<span class="comment">// Half-yearly history delta-t values from 1750 up to 1987
</span>  <span class="comment">// From: http://maia.usno.navy.mil/ser7/historic&#95;deltat.data
// Note: values before 1750 are excluded as the Espenak &amp; Meeus (2006) estimates are more
// precise. The values in the original table are from McCarthy and Babcock (1986).
// Table runs from 1750 to 1987 (excluded) for each half year.
</span><span class="decl-val" id="deltat_table_historic"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#deltat_table_historic">deltat-table-historic<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>historic: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="#type_space_deltat_table"><span class="tp">deltat-table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#once">once<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>once: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">calc</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>{ <a class="pp" href="#parse_historic">parse-historic<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>historic: <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(<span class="number">1750.0</span>,<span class="st">"\n[13.7,13.8,13.9,14.0,14.0,14.1,14.1,14.1,14.1,14.2,14.3,14.4,14.4,14.5,14.6,14.6,14.7,14.7,14.7,\n14.8,14.8,14.9,14.9,15.0,15.0,15.1,15.2,15.3,15.4,15.5,15.6,15.6,15.6,15.8,15.9,15.9,15.9,15.8,\n15.7,15.8,15.7,15.7,15.7,15.8,15.9,16.1,16.1,16.0,15.9,15.9,15.7,15.4,15.3,15.4,15.5,15.6,15.6,\n15.6,15.6,15.6,15.6,15.6,15.5,15.5,15.4,15.3,15.2,15.1,14.9,14.8,14.6,14.4,14.3,14.2,14.1,14.2,\n14.2,13.9,13.7,13.5,13.3,13.1,13.0,13.2,13.2,13.1,13.1,13.2,13.3,13.5,13.5,13.4,13.2,13.2,13.1,\n13.1,13.0,12.8,12.6,12.7,12.6,12.3,12.0,11.9,11.8,11.6,11.4,11.2,11.1,11.1,11.1,11.1,11.1,11.2,\n11.1,11.1,11.2,11.4,11.5,11.3,11.2,11.4,11.7,11.9,11.9,11.9,11.8,11.7,11.8,11.8,11.8,11.7,11.6,\n11.6,11.5,11.5,11.4,11.4,11.3,11.3,11.13,11.16,10.94,10.72,10.29,10.04,9.94,9.91,9.88,9.86,9.72,\n9.67,9.66,9.64,9.51,9.40,9.21,9.00,8.60,8.29,7.95,7.73,7.59,7.49,7.36,7.26,7.10,7.00,6.89,6.82,\n6.73,6.64,6.39,6.28,6.25,6.27,6.25,6.27,6.22,6.24,6.22,6.27,6.30,6.36,6.35,6.37,6.32,6.33,6.33,\n6.37,6.37,6.41,6.40,6.44,6.46,6.51,6.48,6.51,6.53,6.58,6.55,6.61,6.69,6.80,6.84,6.94,7.03,7.13,\n7.15,7.22,7.26,7.30,7.23,7.22,7.21,7.20,6.99,6.98,7.19,7.36,7.35,7.39,7.41,7.45,7.36,7.18,6.95,\n6.72,6.45,6.24,5.92,5.59,5.15,4.67,4.11,3.52,2.94,2.47,1.97,1.52,1.04,0.60,0.11,~0.34,~0.82,~1.25,\n~1.70,~2.08,~2.48,~2.82,~3.19,~3.50,~3.84,~4.14,~4.43,~4.59,~4.79,~4.92,~5.09,~5.24,~5.36,~5.34,\n~5.37,~5.32,~5.34,~5.33,~5.40,~5.47,~5.58,~5.66,~5.74,~5.68,~5.69,~5.65,~5.67,~5.68,~5.73,~5.72,\n~5.78,~5.79,~5.86,~5.89,~6.01,~6.13,~6.28,~6.41,~6.53,~6.49,~6.50,~6.45,~6.41,~6.26,~6.11,~5.90,\n~5.63,~5.13,~4.68,~4.19,~3.72,~3.21,~2.70,~2.09,~1.48,~0.75,~0.08,0.62,1.26,1.95,2.59,3.28,3.92,\n4.61,5.20,5.73,6.29,7.00,7.68,8.45,9.13,9.78,10.38,10.99,11.64,12.47,13.23,14.00,14.69,15.38,16.00,\n16.64,17.19,17.72,18.19,18.67,19.13,19.69,20.14,20.54,20.86,21.14,21.41,21.78,22.06,22.30,22.51,\n22.79,23.01,23.29,23.46,23.55,23.63,23.80,23.95,24.25,24.39,24.42,24.34,24.22,24.10,24.08,24.02,\n24.04,23.98,23.91,23.89,23.95,23.93,23.92,23.88,23.94,23.91,23.82,23.76,23.87,23.91,23.95,23.96,\n24.00,24.04,24.20,24.35,24.61,24.82,25.09,25.30,25.56,25.77,26.05,26.27,26.54,26.76,27.04,27.27,\n27.55,27.77,28.03,28.25,28.50,28.70,28.95,29.15,29.38,29.57,29.80,29.97,30.19,30.36,30.57,30.72,\n30.93,31.07,31.24,31.349,31.516,31.677,31.923,\n//1958\n32.166,32.449,\n32.671,32.919,\n//1960\n33.150,33.397,\n33.584,33.804,\n33.992,34.240,\n34.466,34.731,\n35.030,35.400,\n35.738,36.147,\n36.546,36.995,\n37.429,37.879,\n38.291,38.753,\n39.204,39.707,\n//1970\n40.182,40.706,\n41.170,41.686,\n42.227,42.825,\n43.373,43.959,\n44.486,44.997,\n45.477,45.983,\n46.458,46.997,\n47.521,48.034,\n48.535,49.099,\n49.589,50.102,\n// 1980\n50.540,50.975,\n51.382,51.810,\n52.168,52.572,\n52.957,53.434,\n53.789,54.087  //1984: end of historic data file\n54.343,54.636  //1985: from determined\n54.872,55.113  //1986: from determined\n]"</span>
)</span>}


<span class="comment">//-----------------------------------------------------------------
// The following two tables should be updated yearly to contain
// the latest builtin information Delta-T.
//
// determined data: &lt;http://maia.usno.navy.mil/ser7/deltat.data&gt;
// predicted  data: &lt;http://maia.usno.navy.mil/ser7/deltat.preds&gt;
//-----------------------------------------------------------------
</span>
<span class="comment">// Monthly observed delta-t data from 1973 up to 2019
// See: &lt;http://maia.usno.navy.mil/ser7/deltat.data&gt;
</span><span class="decl-val" id="deltat_table_determined"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#deltat_table_determined">deltat-table-determined<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>determined: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#once">once<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>once: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">calc</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>{ <a class="pp" href="#parse_determined">parse-determined<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>determined: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>( <span class="st">"\n  1973  2  1  43.4724\n  1973  3  1  43.5648\n  1973  4  1  43.6737\n  1973  5  1  43.7782\n  1973  6  1  43.8763\n  1973  7  1  43.9562\n  1973  8  1  44.0315\n  1973  9  1  44.1132\n  1973 10  1  44.1982\n  1973 11  1  44.2952\n  1973 12  1  44.3936\n  1974  1  1  44.4841\n  1974  2  1  44.5646\n  1974  3  1  44.6425\n  1974  4  1  44.7386\n  1974  5  1  44.8370\n  1974  6  1  44.9302\n  1974  7  1  44.9986\n  1974  8  1  45.0584\n  1974  9  1  45.1284\n  1974 10  1  45.2064\n  1974 11  1  45.2980\n  1974 12  1  45.3897\n  1975  1  1  45.4761\n  1975  2  1  45.5632\n  1975  3  1  45.6450\n  1975  4  1  45.7375\n  1975  5  1  45.8284\n  1975  6  1  45.9133\n  1975  7  1  45.9820\n  1975  8  1  46.0407\n  1975  9  1  46.1067\n  1975 10  1  46.1825\n  1975 11  1  46.2789\n  1975 12  1  46.3713\n  1976  1  1  46.4567\n  1976  2  1  46.5445\n  1976  3  1  46.6311\n  1976  4  1  46.7302\n  1976  5  1  46.8284\n  1976  6  1  46.9247\n  1976  7  1  46.9970\n  1976  8  1  47.0709\n  1976  9  1  47.1450\n  1976 10  1  47.2362\n  1976 11  1  47.3413\n  1976 12  1  47.4319\n  1977  1  1  47.5214\n  1977  2  1  47.6049\n  1977  3  1  47.6837\n  1977  4  1  47.7781\n  1977  5  1  47.8771\n  1977  6  1  47.9687\n  1977  7  1  48.0348\n  1977  8  1  48.0942\n  1977  9  1  48.1608\n  1977 10  1  48.2460\n  1977 11  1  48.3439\n  1977 12  1  48.4355\n  1978  1  1  48.5344\n  1978  2  1  48.6324\n  1978  3  1  48.7294\n  1978  4  1  48.8365\n  1978  5  1  48.9353\n  1978  6  1  49.0319\n  1978  7  1  49.1013\n  1978  8  1  49.1591\n  1978  9  1  49.2286\n  1978 10  1  49.3070\n  1978 11  1  49.4018\n  1978 12  1  49.4945\n  1979  1  1  49.5861\n  1979  2  1  49.6805\n  1979  3  1  49.7602\n  1979  4  1  49.8556\n  1979  5  1  49.9489\n  1979  6  1  50.0347\n  1979  7  1  50.1019\n  1979  8  1  50.1622\n  1979  9  1  50.2260\n  1979 10  1  50.2968\n  1979 11  1  50.3831\n  1979 12  1  50.4599\n  1980  1  1  50.5387\n  1980  2  1  50.6160\n  1980  3  1  50.6866\n  1980  4  1  50.7658\n  1980  5  1  50.8454\n  1980  6  1  50.9187\n  1980  7  1  50.9761\n  1980  8  1  51.0278\n  1980  9  1  51.0843\n  1980 10  1  51.1538\n  1980 11  1  51.2319\n  1980 12  1  51.3063\n  1981  1  1  51.3808\n  1981  2  1  51.4526\n  1981  3  1  51.5160\n  1981  4  1  51.5985\n  1981  5  1  51.6809\n  1981  6  1  51.7573\n  1981  7  1  51.8133\n  1981  8  1  51.8532\n  1981  9  1  51.9014\n  1981 10  1  51.9603\n  1981 11  1  52.0328\n  1981 12  1  52.0985\n  1982  1  1  52.1668\n  1982  2  1  52.2316\n  1982  3  1  52.2938\n  1982  4  1  52.3680\n  1982  5  1  52.4465\n  1982  6  1  52.5180\n  1982  7  1  52.5751\n  1982  8  1  52.6178\n  1982  9  1  52.6668\n  1982 10  1  52.7340\n  1982 11  1  52.8056\n  1982 12  1  52.8792\n  1983  1  1  52.9565\n  1983  2  1  53.0445\n  1983  3  1  53.1268\n  1983  4  1  53.2197\n  1983  5  1  53.3024\n  1983  6  1  53.3747\n  1983  7  1  53.4335\n  1983  8  1  53.4778\n  1983  9  1  53.5300\n  1983 10  1  53.5845\n  1983 11  1  53.6523\n  1983 12  1  53.7256\n  1984  1  1  53.7882\n  1984  2  1  53.8367\n  1984  3  1  53.8830\n  1984  4  1  53.9443\n  1984  5  1  54.0042\n  1984  6  1  54.0536\n  1984  7  1  54.0856\n  1984  8  1  54.1084\n  1984  9  1  54.1463\n  1984 10  1  54.1914\n  1984 11  1  54.2452\n  1984 12  1  54.2958\n  1985  1  1  54.3427\n  1985  2  1  54.3911\n  1985  3  1  54.4320\n  1985  4  1  54.4898\n  1985  5  1  54.5456\n  1985  6  1  54.5977\n  1985  7  1  54.6355\n  1985  8  1  54.6532\n  1985  9  1  54.6776\n  1985 10  1  54.7174\n  1985 11  1  54.7741\n  1985 12  1  54.8253\n  1986  1  1  54.8712\n  1986  2  1  54.9161\n  1986  3  1  54.9581\n  1986  4  1  54.9997\n  1986  5  1  55.0476\n  1986  6  1  55.0912\n  1986  7  1  55.1132\n  1986  8  1  55.1328\n  1986  9  1  55.1532\n  1986 10  1  55.1898\n  1986 11  1  55.2416\n  1986 12  1  55.2838\n  1987  1  1  55.3222\n  1987  2  1  55.3613\n  1987  3  1  55.4063\n  1987  4  1  55.4629\n  1987  5  1  55.5111\n  1987  6  1  55.5524\n  1987  7  1  55.5812\n  1987  8  1  55.6004\n  1987  9  1  55.6262\n  1987 10  1  55.6656\n  1987 11  1  55.7168\n  1987 12  1  55.7698\n  1988  1  1  55.8197\n  1988  2  1  55.8615\n  1988  3  1  55.9130\n  1988  4  1  55.9663\n  1988  5  1  56.0220\n  1988  6  1  56.0700\n  1988  7  1  56.0939\n  1988  8  1  56.1105\n  1988  9  1  56.1314\n  1988 10  1  56.1611\n  1988 11  1  56.2068\n  1988 12  1  56.2582\n  1989  1  1  56.3000\n  1989  2  1  56.3399\n  1989  3  1  56.3790\n  1989  4  1  56.4283\n  1989  5  1  56.4804\n  1989  6  1  56.5352\n  1989  7  1  56.5697\n  1989  8  1  56.5983\n  1989  9  1  56.6328\n  1989 10  1  56.6739\n  1989 11  1  56.7332\n  1989 12  1  56.7972\n  1990  1  1  56.8553\n  1990  2  1  56.9111\n  1990  3  1  56.9755\n  1990  4  1  57.0471\n  1990  5  1  57.1136\n  1990  6  1  57.1738\n  1990  7  1  57.2226\n  1990  8  1  57.2597\n  1990  9  1  57.3073\n  1990 10  1  57.3643\n  1990 11  1  57.4334\n  1990 12  1  57.5016\n  1991  1  1  57.5653\n  1991  2  1  57.6333\n  1991  3  1  57.6973\n  1991  4  1  57.7711\n  1991  5  1  57.8407\n  1991  6  1  57.9058\n  1991  7  1  57.9576\n  1991  8  1  57.9975\n  1991  9  1  58.0425\n  1991 10  1  58.1043\n  1991 11  1  58.1679\n  1991 12  1  58.2389\n  1992  1  1  58.3092\n  1992  2  1  58.3833\n  1992  3  1  58.4537\n  1992  4  1  58.5401\n  1992  5  1  58.6228\n  1992  6  1  58.6917\n  1992  7  1  58.7410\n  1992  8  1  58.7836\n  1992  9  1  58.8406\n  1992 10  1  58.8986\n  1992 11  1  58.9714\n  1992 12  1  59.0438\n  1993  1  1  59.1218\n  1993  2  1  59.2003\n  1993  3  1  59.2747\n  1993  4  1  59.3574\n  1993  5  1  59.4434\n  1993  6  1  59.5242\n  1993  7  1  59.5850\n  1993  8  1  59.6343\n  1993  9  1  59.6928\n  1993 10  1  59.7588\n  1993 11  1  59.8386\n  1993 12  1  59.9111\n  1994  1  1  59.9845\n  1994  2  1  60.0564\n  1994  3  1  60.1231\n  1994  4  1  60.2042\n  1994  5  1  60.2804\n  1994  6  1  60.3530\n  1994  7  1  60.4012\n  1994  8  1  60.4440\n  1994  9  1  60.4900\n  1994 10  1  60.5578\n  1994 11  1  60.6324\n  1994 12  1  60.7059\n  1995  1  1  60.7853\n  1995  2  1  60.8663\n  1995  3  1  60.9387\n  1995  4  1  61.0277\n  1995  5  1  61.1103\n  1995  6  1  61.1870\n  1995  7  1  61.2454\n  1995  8  1  61.2881\n  1995  9  1  61.3378\n  1995 10  1  61.4036\n  1995 11  1  61.4760\n  1995 12  1  61.5525\n  1996  1  1  61.6287\n  1996  2  1  61.6846\n  1996  3  1  61.7433\n  1996  4  1  61.8132\n  1996  5  1  61.8823\n  1996  6  1  61.9497\n  1996  7  1  61.9969\n  1996  8  1  62.0343\n  1996  9  1  62.0714\n  1996 10  1  62.1202\n  1996 11  1  62.1809\n  1996 12  1  62.2382\n  1997  1  1  62.2950\n  1997  2  1  62.3506\n  1997  3  1  62.3995\n  1997  4  1  62.4754\n  1997  5  1  62.5463\n  1997  6  1  62.6136\n  1997  7  1  62.6571\n  1997  8  1  62.6942\n  1997  9  1  62.7383\n  1997 10  1  62.7926\n  1997 11  1  62.8567\n  1997 12  1  62.9146\n  1998  1  1  62.9659\n  1998  2  1  63.0217\n  1998  3  1  63.0807\n  1998  4  1  63.1462\n  1998  5  1  63.2053\n  1998  6  1  63.2599\n  1998  7  1  63.2844\n  1998  8  1  63.2961\n  1998  9  1  63.3126\n  1998 10  1  63.3422\n  1998 11  1  63.3871\n  1998 12  1  63.4339\n  1999  1  1  63.4673\n  1999  2  1  63.4979\n  1999  3  1  63.5319\n  1999  4  1  63.5679\n  1999  5  1  63.6104\n  1999  6  1  63.6444\n  1999  7  1  63.6642\n  1999  8  1  63.6739\n  1999  9  1  63.6926\n  1999 10  1  63.7147\n  1999 11  1  63.7518\n  1999 12  1  63.7927\n  2000  1  1  63.8285\n  2000  2  1  63.8557\n  2000  3  1  63.8804\n  2000  4  1  63.9075\n  2000  5  1  63.9393\n  2000  6  1  63.9691\n  2000  7  1  63.9799\n  2000  8  1  63.9833\n  2000  9  1  63.9938\n  2000 10  1  64.0093\n  2000 11  1  64.0400\n  2000 12  1  64.0670\n  2001  1  1  64.0908\n  2001  2  1  64.1068\n  2001  3  1  64.1282\n  2001  4  1  64.1584\n  2001  5  1  64.1833\n  2001  6  1  64.2094\n  2001  7  1  64.2117\n  2001  8  1  64.2073\n  2001  9  1  64.2116\n  2001 10  1  64.2223\n  2001 11  1  64.2500\n  2001 12  1  64.2761\n  2002  1  1  64.2998\n  2002  2  1  64.3192\n  2002  3  1  64.3450\n  2002  4  1  64.3735\n  2002  5  1  64.3943\n  2002  6  1  64.4151\n  2002  7  1  64.4132\n  2002  8  1  64.4118\n  2002  9  1  64.4097\n  2002 10  1  64.4168\n  2002 11  1  64.4329\n  2002 12  1  64.4511\n  2003  1  1  64.4734\n  2003  2  1  64.4893\n  2003  3  1  64.5053\n  2003  4  1  64.5269\n  2003  5  1  64.5471\n  2003  6  1  64.5597\n  2003  7  1  64.5512\n  2003  8  1  64.5371\n  2003  9  1  64.5359\n  2003 10  1  64.5415\n  2003 11  1  64.5544\n  2003 12  1  64.5654\n  2004  1  1  64.5736\n  2004  2  1  64.5891\n  2004  3  1  64.6015\n  2004  4  1  64.6176\n  2004  5  1  64.6374\n  2004  6  1  64.6549\n  2004  7  1  64.6530\n  2004  8  1  64.6379\n  2004  9  1  64.6372\n  2004 10  1  64.6400\n  2004 11  1  64.6543\n  2004 12  1  64.6723\n  2005  1  1  64.6876\n  2005  2  1  64.7052\n  2005  3  1  64.7313\n  2005  4  1  64.7575\n  2005  5  1  64.7811\n  2005  6  1  64.8001\n  2005  7  1  64.7995\n  2005  8  1  64.7876\n  2005  9  1  64.7831\n  2005 10  1  64.7921\n  2005 11  1  64.8096\n  2005 12  1  64.8311\n  2006  1  1  64.8452\n  2006  2  1  64.8597\n  2006  3  1  64.8850\n  2006  4  1  64.9175\n  2006  5  1  64.9480\n  2006  6  1  64.9794\n  2006  7  1  64.9895\n  2006  8  1  65.0028\n  2006  9  1  65.0138\n  2006 10  1  65.0371\n  2006 11  1  65.0773\n  2006 12  1  65.1122\n  2007  1  1  65.1464\n  2007  2  1  65.1833\n  2007  3  1  65.2145\n  2007  4  1  65.2494\n  2007  5  1  65.2921\n  2007  6  1  65.3279\n  2007  7  1  65.3413\n  2007  8  1  65.3452\n  2007  9  1  65.3496\n  2007 10  1  65.3711\n  2007 11  1  65.3972\n  2007 12  1  65.4296\n  2008  1  1  65.4573\n  2008  2  1  65.4868\n  2008  3  1  65.5152\n  2008  4  1  65.5450\n  2008  5  1  65.5781\n  2008  6  1  65.6127\n  2008  7  1  65.6287\n  2008  8  1  65.6370\n  2008  9  1  65.6493\n  2008 10  1  65.6760\n  2008 11  1  65.7097\n  2008 12  1  65.7461\n  2009  1  1  65.7768\n  2009  2  1  65.8025\n  2009  3  1  65.8237\n  2009  4  1  65.8595\n  2009  5  1  65.8973\n  2009  6  1  65.9323\n  2009  7  1  65.9509\n  2009  8  1  65.9534\n  2009  9  1  65.9628\n  2009 10  1  65.9839\n  2009 11  1  66.0147\n  2009 12  1  66.0420\n  2010  1  1  66.0699\n  2010  2  1  66.0961\n  2010  3  1  66.1310\n  2010  4  1  66.1683\n  2010  5  1  66.2072\n  2010  6  1  66.2356\n  2010  7  1  66.2409\n  2010  8  1  66.2335\n  2010  9  1  66.2349\n  2010 10  1  66.2441\n  2010 11  1  66.2751\n  2010 12  1  66.3054\n  2011  1  1  66.3246\n  2011  2  1  66.3406\n  2011  3  1  66.3624\n  2011  4  1  66.3957\n  2011  5  1  66.4289\n  2011  6  1  66.4619\n  2011  7  1  66.4749\n  2011  8  1  66.4751\n  2011  9  1  66.4829\n  2011 10  1  66.5056\n  2011 11  1  66.5383\n  2011 12  1  66.5706\n  2012  1  1  66.6030\n  2012  2  1  66.6340\n  2012  3  1  66.6569\n  2012  4  1  66.6925\n  2012  5  1  66.7289\n  2012  6  1  66.7579\n  2012  7  1  66.7708\n  2012  8  1  66.7740\n  2012  9  1  66.7846\n  2012 10  1  66.8103\n  2012 11  1  66.8400\n  2012 12  1  66.8779\n  2013  1  1  66.9069\n  2013  2  1  66.9443\n  2013  3  1  66.9762\n  2013  4  1  67.0258\n  2013  5  1  67.0716\n  2013  6  1  67.1100\n  2013  7  1  67.1266\n  2013  8  1  67.1331\n  2013  9  1  67.1458\n  2013 10  1  67.1717\n  2013 11  1  67.2091\n  2013 12  1  67.2460\n  2014  1  1  67.2810\n  2014  2  1  67.3136\n  2014  3  1  67.3457\n  2014  4  1  67.3890\n  2014  5  1  67.4318\n  2014  6  1  67.4666\n  2014  7  1  67.4858\n  2014  8  1  67.4989\n  2014  9  1  67.5111\n  2014 10  1  67.5353\n  2014 11  1  67.5711\n  2014 12  1  67.6070\n  2015  1  1  67.6439\n  2015  2  1  67.6765\n  2015  3  1  67.7117\n  2015  4  1  67.7591\n  2015  5  1  67.8012\n  2015  6  1  67.8402\n  2015  7  1  67.8606\n  2015  8  1  67.8822\n  2015  9  1  67.9120\n  2015 10  1  67.9546\n  2015 11  1  68.0055\n  2015 12  1  68.0514\n  2016  1  1  68.1024\n  2016  2  1  68.1577\n  2016  3  1  68.2044\n  2016  4  1  68.2664\n  2016  5  1  68.3188\n  2016  6  1  68.3704\n  2016  7  1  68.3964\n  2016  8  1  68.4094\n  2016  9  1  68.4305\n  2016 10  1  68.4630\n  2016 11  1  68.5078\n  2016 12  1  68.5537\n  2017  1  1  68.5927\n  2017  2  1  68.6298\n  2017  3  1  68.6671\n  2017  4  1  68.7135\n  2017  5  1  68.7623\n  2017  6  1  68.8033\n  2017  7  1  68.8245\n  2017  8  1  68.8373\n  2017  9  1  68.8477\n  2017 10  1  68.8689\n  2017 11  1  68.9006\n  2017 12  1  68.9355\n  2018  1  1  68.9676\n  2018  2  1  68.9875\n  2018  3  1  69.0175\n  2018  4  1  69.0499\n  2018  5  1  69.0823\n  2018  6  1  69.1070\n  2018  7  1  69.1134\n  2018  8  1  69.1142\n  2018  9  1  69.1207\n  2018 10  1  69.1356\n  2018 11  1  69.1646\n  2018 12  1  69.1964\n  2019  1  1  69.2201\n"</span>)</span>}


<span class="comment">// Quarterly Predicted delta-t values, from 2019 upto 2027
// from &lt;http://maia.usno.navy.mil/ser7/deltat.preds&gt;.
</span><span class="decl-val" id="deltat_table_predicted"><span class="kw">val</span> <a class="pp" href="std_time_ut1.html#deltat_table_predicted">deltat-table-predicted<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>deltat<span class="dash">-</span>table<span class="dash">-</span>predicted: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a> <span class="kw">=</span> <a class="pp" href="std_core-source.html#once">once<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>once: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">calc</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">a</span><span class="tp sp">)</span></span></a>{ <a class="pp" href="#parse_predicted">parse-predicted<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>ut1<span class="fslash last">/</span></span>parse<span class="dash">-</span>predicted: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">deltat<span class="dash">-</span>table</span></span></a>(<span class="st">"\n  MJD        YEAR    TT-UT Pred  UT1-UTC Pred  ERROR\n  58484.000  2019.00   69.34      -0.152       0.117\n  58575.000  2019.25   69.48      -0.295       0.162\n  58666.000  2019.50   69.62      -0.440       0.215\n  58758.000  2019.75   69.71      -0.527       0.273\n  58849.000  2020.00   69.87                   0.335\n  58940.000  2020.25   70.03                   0.399\n  59032.000  2020.50   70.16                   0.465\n  59123.000  2020.75   70.24                   0.532\n  59214.000  2021.00   70.39                   0.600\n  59306.000  2021.25   70.55                   0.668\n  59397.000  2021.50   70.68                   0.736\n  59488.000  2021.75   70.76                   0.803\n  59580.000  2022.00   70.91                   0.870\n  59671.000  2022.25   71.06                   0.936\n  59762.000  2022.50   71.18                   1.000\n  59853.000  2022.75   71.25                   1.064\n  59945.000  2023.00   71.40                   1.126\n  60036.000  2023.25   71.54                   1.186\n  60127.000  2023.50   71.67                   1.245\n  60219.000  2023.75   71.74                   1.302\n  60310.000  2024.00   71.88                   1.358\n  60401.000  2024.25   72.03                   1.411\n  60493.000  2024.50   72.15                   1.463\n  60584.000  2024.75   72.22                   1.514\n  60675.000  2025.00   72.36                   1.562\n  60767.000  2025.25   72.50                   1.609\n  60858.000  2025.50   72.62                   1.654\n  60949.000  2025.75   72.69                   1.697\n  61041.000  2026.00   72.83                   1.738\n  61132.000  2026.25   72.98                   1.778\n  61223.000  2026.50   73.10                   1.816\n  61314.000  2026.75   73.17                   1.853\n  61406.000  2027.00   73.32                   1.887\n  61497.000  2027.25   73.46                   1.921\n  61588.000  2027.50   73.58                   1.953\n  61680.000  2027.75   73.66                   1.983\n"</span>)</span>}
</pre>

</div></body>
</html>
