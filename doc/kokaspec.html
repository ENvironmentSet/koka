<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="generator" content="Madoko, version 1.2.3" />
  <meta name="viewport" content="initial-scale=1.0" />
  <meta name="description" content="Provides an automatically expanding table-of-contents
      in a side-panel next to the main content.
      The TOC must be in a `SidePanel` block, while all
      the other content must be in a `MainPanel`." />
  <title>The Koka Manual</title>
  <style type="text/css"  class="link">
  /*# sourceURL=madoko.css */
  
  .madoko .toc>.tocblock .tocblock .tocblock {
    margin-left: 2.25em;
  }
  .madoko .toc>.tocblock .tocblock {
    margin-left: 1.5em;
  }
  .madoko .toc-contents>.tocblock>.tocitem {
    font-weight: bold;
  }
  .madoko .toc {
    margin-top: 1em;
  }
  .madoko p.para-continue {
    margin-bottom: 0pt;
  }
  .madoko .para-block+p {
    margin-top: 0pt;
  }
  .madoko ul.para-block, .madoko ol.para-block {
    margin-top: 0pt;
    margin-bottom: 0pt;
  }
  .madoko ul.para-end, .madoko ol.para-end {
    margin-bottom: 1em;
  }
  .madoko dl {
    margin-left: 0em;
  }
  .madoko blockquote {
    font-style: italic;
  }
  .madoko a.localref {
    text-decoration: none;
  }
  .madoko a.localref:hover {
    text-decoration: underline;
  }
  .madoko .footnotes {
    font-size: smaller;
    margin-top: 2em;
  }
  .madoko .footnotes hr {
    width: 50%;
    text-align: left;
  }
  .madoko .footnote {
    margin-left: 1em;
  }
  .madoko .footnote-before {
    margin-left: -1em;
    width: 1em;
    display: inline-block;
  }
  .madoko .align-center, .madoko .align-center>p {
    text-align: center !important;
  }
  .madoko .align-center pre {
    text-align: left;
  }
  .madoko .align-center>* {
    margin-left: auto !important;
    margin-right: auto !important;
  }
  .madoko .align-left, .madoko .align-left>p {
    text-align: left !important;
  }
  .madoko .align-left>* {
    margin-left: 0pt !important;
    margin-right: auto !important;
  }
  .madoko .align-right, .madoko .align-right>p {
    text-align: right !important;
  }
  .madoko .align-right>* {
    margin-left: auto !important;
    margin-right: 0pt !important;
  }
  .madoko .align-center>table,
  .madoko .align-left>table,
  .madoko .align-right>table {
    text-align: left !important;
  }
  .madoko .equation-before {
    float: right;
  }
  .madoko .bibitem {
    font-size: smaller;
  }
  .madoko .bibsearch {
    font-size: x-small;
    text-decoration:none;
    color: black;
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  .madoko .block, .madoko .figure, .madoko .bibitem, .madoko .equation, .madoko div.math {
    margin-top: 1ex;
    margin-bottom: 1ex;
  }
  .madoko .figure {
    padding: 0.5em;
    margin-left: 0pt;
    margin-right: 0pt;
  }
  .madoko .hidden {
    display: none;
  }
  .madoko .invisible {
    visibility: hidden;
  }
  .madoko.preview .invisible {
    visibility: visible;
    opacity: 0.5;
  }
  .madoko code.code, .madoko span.code {
    white-space: pre-wrap;
  }
  .madoko hr, hr.madoko {
    border: none;
    border-bottom: black solid 1px;
    margin-bottom: 0.5ex;
  }
  .madoko .framed>*:first-child {
    margin-top: 0pt;
  }
  .madoko .framed>*:last-child {
    margin-bottom: 0pt;
  }
  .madoko ul.list-style-type-dash {
      list-style-type: none !important;
  }
  .madoko ul.list-style-type-dash > li:before {
      content: "\2013";
      position: absolute;
      margin-left: -1em;
  }
  .madoko table.madoko {
    border-collapse: collapse;
  }
  .madoko td, .madoko th {
    padding: 0ex 0.5ex;
    margin: 0pt;
    vertical-align: top;
  }
  .madoko .cell-border-left {
    border-left: 1px solid black;
  }
  .madoko .cell-border-right {
    border-right: 1px solid black;
  }
  .madoko thead>tr:first-child>.cell-line,
  .madoko tbody:first-child>tr:first-child>.cell-line {
    border-top: 1px solid black;
    border-bottom: none;
  }
  .madoko .cell-line, .madoko .cell-double-line {
    border-bottom: 1px solid black;
    border-top: none;
  }
  .madoko .cell-double-line {
    border-top: 1px solid black;
    padding-top: 1.5px !important;
  }
  .madoko .input-mathpre .MathJax_Display {
    text-align: left !important;
  }
  .madoko div.input-mathpre {
    text-align: left;
    margin-top: 1.5ex;
    margin-bottom: 1ex;
  }
  .madoko .math-rendering {
    text-align: left;
    white-space: pre;
    color: gray;
  }
  .madoko .mathdisplay {
    text-align: center;
  }
  .madoko span.math-rendering {
    display:inline-block;
    width:8em;
    overflow-x:auto;
    font-size:70%;
  }
  .madoko span.math-rendering::-webkit-scrollbar {
    width:4px;
  }
  .madoko .pretty table {
    border-collapse: collapse;
  }
  .madoko .pretty td {
    padding: 0em;
  }
  .madoko .pretty td.empty {
    min-width: 1.5ex;
  }
  .madoko .pretty td.expander {
    width: 100em;
  }
  body.madoko, .madoko .serif {
    font-family: Cambria,"Times New Roman","Liberation Serif","Times",serif;
  }
  .madoko .sans-serif {
    font-family: "Calibri", "Optima", sans-serif;
  }
  .madoko .symbol {
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  body.madoko {
    -webkit-text-size-adjust: 100%;       
    text-rendering: optimizeLegibility;
  }
  body.madoko {
    max-width: 88ex; 
    margin: 1em auto;
    padding: 0em 2em;
  }
  body.preview.madoko {
    padding: 0em 1em;
  }
  .madoko p {
    text-align: justify;
  }
  .madoko h1, .madoko h2, .madoko h3, .madoko h4 {
    margin-top: 1.22em;
    margin-bottom: 1ex;
  }
  .madoko h1+p, .madoko h2+p, .madoko h3+p, .madoko h4+p, .madoko h5+p  {
    margin-top: 1ex;
  }
  .madoko h5, .madoko h6 {
    margin-top: 1ex;
    font-size: 1em;
  }
  .madoko h5 {
    margin-bottom: 0.5ex;
  }
  .madoko h5 + p {
    margin-top: 0.5ex;
  }
  .madoko h6 {
    margin-bottom: 0pt;
  }
  .madoko h6 + p {
    margin-top: 0pt;
  }
  .madoko pre, .madoko code, .madoko kbd, .madoko samp, .madoko tt,
  .madoko .monospace, .madoko .token-indent, .madoko .reveal pre, .madoko .reveal code, .madoko .email {
    font-family: Consolas,"Andale Mono WT","Andale Mono",Lucida Console,Monaco,monospace,monospace;
    font-size: 0.85em;
  }
  .madoko pre code, .madoko .token-indent {
    font-size: 0.95em;
  }
  .madoko pre code {
    font-family: inherit !important;
  }
  .madoko ol.linenums li {
    background-color: white;
    list-style-type: decimal;
  }
  .madoko .remote {
    background-color: #F0FFF0;
  }
  .madoko .remote + * {
    margin-top: 0pt;
  }
  @media print {
    body.madoko {
      font-size: 10pt;
    }
    @page {
      margin: 1in 1.5in;
    }
  }
  @media only screen and (max-device-width:1024px) {
    body.madoko {
      padding: 0em 0.5em;
    }
    .madoko li {
      text-align: left;
    }
  }
  
    </style>
  <style type="text/css"  class="link">
  /*# sourceURL=styles/koka.css */
  
  @import url('https://fonts.googleapis.com/css?family=Nunito:400,400italic,700,700italic');
  @import url('https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic');
  @import url('https://fonts.googleapis.com/css?family=Roboto+Slab:300,400,700');
  body.madoko,body.koka,.serif,.sans-serif,.comment {
    font-family: 'Nunito', 'Calibri', serif;
  }
  .sans-serif { 
    font-family: 'Nunito', 'Segoe UI', 'Calibri', sans-serif;
  }
  .sans-section { 
    font-family: 'Nunito', 'Century Gothic', 'Apple Gothic',  sans-serif; 
  }
  pre.koka, code.koka, .koka.doc .header {
    background-color: #f0f2f4;
  }
  @media screen {
    body.madoko,body.koka {
      max-width  : 62em;
      margin     : 1em auto;
      padding    : 0em 1em 45em 1em; 
      line-height: 1.4;
    }
    .koka.doc p {
      text-align: left;
    }
  }
  @media screen and (max-device-width: 1022px) {
    body.madoko,body.koka {
      max-width: 100%;
      padding: 0em 0.5em 40em 0.5em;
      margin: 1em;
    }
  }
  @media screen and (min-device-width: 2048px) {
    html {
      font-size:120%;
    }
  }
  @media print {
    body {
      font-size: 9pt;
      margin: 0pt;
    }
    h2,h3,h4 { 
      page-break-after: avoid; 
    }  
    p { 
      text-align: justify;
    }
    @page:left  { margin: 8% 5% 8% 5%; }
    @page:right { margin: 8% 5% 8% 5%; }
  }
  body {
    -webkit-text-size-adjust: 100%;   
    text-size-adjust:100%;
    color: black;
  }
  h1 { 
    font-size: 150%; 
  }
  h1.mo, h1 .mo, h1 .toc-link {
    color: inherit !important;
  }
  .koka.source,
  .koka.codeblock,
  .koka.preblock, 
  code, code.koka, .koka .code, .madoko code,
  pre, pre.koka, .madoko pre,
  .monospace { 
    font-family: "Roboto Mono", Consolas, "Menlo", "Andale Mono", Lucida Console, Monaco, monospace,monospace;
  }
  .koka .code {   
    font-size: 90%;        
  }
  code, code.koka, .koka .code, .madoko code { 
    border-radius: 4px;
    padding: 0pt 0.2ex;
  }
  pre code code, .madoko pre code code {
    xfont-size: 1em;
  }
  .koka.codeblock,
  .koka.preblock { 
    padding: 0.5ex 1ex 0.5ex 1ex;
  }
  .koka.source  { 
    padding: 0.5ex 1em 0.5ex 1em;
  }
  .koka.source.unchecked {
  }
  .koka.source-body .source {
    margin-right: 1ex;
  }
  .koka .dash { 
    margin-left: -0.25ex; margin-right: -0.25ex
  }
  .koka .minus {
    font-weight: bold;
  }
  .koka .fslash {
    font-size: 90%;  
  }
  .koka .fslash .last {
    margin-right: 0.5ex;
  }
  .koka .postfix { 
    color: gray 
  }
  .koka.source,
  .koka.codeblock,
  .koka.preblock,
  .koka.code, code,
  .koka.pre, pre { 
    xwhite-space: pre-wrap;
    overflow-x: auto;
  }
  pre.koka.source {
    border: 1px solid #ccc;
  }
  .madoko pre.koka.source {
    xfont-size: 0.9em;
  }
  .koka.doc .comment p {
    margin: 0pt;
    margin-bottom: 0.25ex;
  }
  .plaincode  { 
    display: none;
    white-space: pre-wrap;
  }
  .koka.source a:hover,
  .koka.code a:hover, code.koka a:hover
  .koka.pre a:hover, pre.koka a:hover { 
    text-decoration: none 
  }
  .koka .type, .koka .tp          { color: teal }
  .koka .keyword, .koka .kw       { color: blue }     
  .koka .string, .koka .st        { color: maroon }
  .koka .module, .koka .mo        { color: navy }
  .koka .number, .koka .nu        { color: black }
  .koka .constructor, .koka .co   {  color: purple }
  .koka .namespace, .koka .mo     { color: navy }
  .koka .comment                  { color: green }
  .koka .type.typeparam, .koka .tp.tpp { color: #555 }
  .koka .type.typevar, .koka .tp.tv    { font-style: italic }
  .koka .type.keyword.operator, .koka .tp.kw.op { color: teal }
  .koka.emph {
    font-style: italic;
    color: black;
  }
  .koka.preblock,     
  .koka.codeblock
        { display: block 
        ; margin-top: 1ex
        ; margin-bottom: 1ex
        }
  .koka.line
        { display: block
        ; border-bottom: 1px dotted
        ; margin-top: 3px
        ; width: 75%
        }
  .koka .error, 
  .koka .warning { 
    border-bottom: dotted;
    border-width: 2px;
  }
  .koka .error    { border-color: red }
  .koka .warning  { border-color: teal }
  .koka .decl.type,
  .koka .decl.cotype,
  .koka .decl.rectype,
  .koka .decl.fun,
  .koka .decl.val,
  .koka .decl.external { 
  }
  .koka .decl.alias,
  .koka .decl.alias .koka .keywordop { 
    color: teal 
  }
  a.pp    { 
    position: relative;
    text-decoration: none;
    color: black;
  }
  .pc { 
    display: none;
  }
  a.pp:hover  { 
    z-index: 100;
    text-decoration: none;
  }
  a.pp:hover .pc, .tooltip { 
    display:block;
    position:absolute;
    top:1.5em;
    left:2ex;
    padding: 0.2ex 0.75ex 0.2ex 0.5ex;
    border:1px solid black;
    background: #FFFFE8;   
    white-space: pre;
  }
  a.pp a.pp:hover .pc
    { top: 3em }
  .koka.doc>pre.source {
    xbackground-color: #F0F0F0;
    border: 1px solid #AAA;
  }
  h1.koka.module
        { font-weight: normal
        }
  .koka .toc-link 
        { font-size: 75%
        ; float: right
        ; color: navy
        }
  .koka.doc .header
        { xbackground: #F0F0F0
        ; padding: 0.25ex
        ; padding-left: 0.5ex
        ; margin-top: 0px
        ; margin-bottom: 0.5em
        }
  .koka.doc .link 
        { text-decoration: none
        ; color: black
        }
  .koka.doc .doc.comment
        { color: black;
        }
  .koka.doc .decl .decl
        { margin-left: 1em 
        }
  .koka.doc .decl .comment
        { margin: 0em 0em 0em 1em }
  .koka.doc.body>.comment
        { margin-bottom: 1em }
  .koka.doc .decl, 
  .koka.doc .con-decl
        { margin-top: 1.2em
        ; border: 1px solid #AAA
        ; border-width: 1px 0px 0px 1px
        }
  .koka.doc .synopsis {
    font-size: 150%;
    margin-top: -0.5em;
    margin-bottom: 0.25em;
  }  
  div.nested { 
    margin: 1.25em 0em 1.25em 1em 
  }
  .koka.doc .nested .decl
        { margin-left: 0em }  
  .koka.doc .con-decl
        { 
        ; margin-left: 1em
        ; margin-top: 0.5em
        ; margin-bottom: 0.5em
        }
  .koka.doc ul.toc 
        { list-style-type: none
        ; margin: 0em
        ; float: left;
        ; clear: none;
        ; padding: 0.5ex 2em 1ex 0.5ex
        ; white-space: nowrap
        ; border-bottom: 1px solid #AAA
        }
  .koka.doc ul.toc li.nested
        { padding-left: 1em
        }
  .koka.doc div.toc 
        { overflow: auto
        ; width: 100%
        }
  .koka.doc div.toc+.doc {
    margin: 1em 0em;
    padding: 1em 0em;
  }
  .koka table.index {
    border: 1px solid #AAA;
  }
  .koka.doc table.index td {
    vertical-align: top;
    padding-right: 2.5em;
    padding-bottom: 0.5ex;
  }
  .koka.doc table.index .nested1 {
    margin-left: 2em;
  }
  .koka.doc table.index .nested2 {
    margin-left: 3em;
  }
  .koka.doc table.index .nested3 {
    margin-left: 4em;
  }
  
    </style>
  <style type="text/css"  class="link">
  /*# sourceURL=styles/kokaspec.css */
  .tocitem {
    font-weight: normal;
  }
  .koka.source, .madoko .koka.source {
    border-left: 0.5ex solid green;
  } 
  code, .madoko code,
  pre, .madoko pre,
  .koka.source.unchecked {
    background-color: #f0f2f4;
  }
  pre, .madoko pre,
  .koka.source,
  .koka.source.unchecked {
    border: 1px solid #CCC;
    border-left: 0.5ex solid #CCC; 
    padding: 0.5ex 1ex 0.5ex 2ex;
  }
  code, .madoko code {
    padding-right: 0.2ex;
  }
  .grammar table,
  table.grammar  {   
    margin: 0.5ex 0.5ex 0.5ex 2ex;
    padding: 0.5ex 1ex 0.5ex 1ex;
  }
  .grammar .code,
  .grammar code {
    padding: 0pt;
  }
  .grammar .bar {
    padding: 0ex 0.5ex;
  }
  .grammar td:nth-child(2) {
    font-style: normal; 
    padding: 0em 1ex;
    text-align: center;
  }
  .grammar td:nth-child(4) {
    font-style: normal; 
    padding-left: 2ex;
  }
  .grammar td {
    white-space: nowrap;
  }
  .grammar .code, .grammar code,
  .grammar .pre, .grammar pre {
    font-weight: bold;
  }
  table .kw, table .tp, table .co,
  .grammar .keyword, .grammar .kw,
  .grammar .type, .grammar .tp,
  .grammar .constructor, .grammar .co {
    color: black;
  }
  .nt {
    font-style: italic;
  }          
  .opt, .many {   
    padding: 0ex 0.5ex;
  }
  #toc {
    display: none;
  }
  #toc-toggle {
    cursor: pointer;
    vertical-align: center;
    margin-right: 10px;
    font-size: 16pt;
  }
  
    </style>
  <script  class="script">function genFullGrammar() {
    var fullLex = "";
    var fullParse = "";
    var divLex = document.getElementById("full-lexical");
    var divGrammar = document.getElementById("full-grammar");
    if (!divLex || !divGrammar) return; 
  
    var gs = document.getElementsByClassName("grammar");
    for(var i = 0; i < gs.length; i++) {
      var elem = gs[i];
      if (elem.tagName.toLowerCase() != "table") continue;
      if (elem.className.indexOf("lex") >= 0) fullLex += elem.innerHTML;
      else if (elem.className.indexOf("parse") >= 0) fullParse += elem.innerHTML;
    }
    divLex.innerHTML="<table class='grammar'>\n"+ fullLex + "</table>"; 
    divGrammar.innerHTML="<table class='grammar'>\n" + fullParse + "</table>";
  }
  
  window.onload = function() { genFullGrammar() };
  
  //# sourceURL=scripts/kokaspec.js
  </script>
  
  <style>
    h0:hover .entity-anchor,
        h1:hover .entity-anchor,
        h2:hover .entity-anchor,
        h3:hover .entity-anchor {
          display: inline-block;
        }
        
        a.entity-anchor {
          color: black;
        }
        
        a.localref.entity-anchor:hover {
          text-decoration: none;
        }
        
        .entity-anchor {
          display: none;
          width: 1em;
          margin: 0pt;
          margin-left: -1em;
          font-family: "Segoe UI Symbol", Symbola, serif;
          font-size: 70%;
        }
    /* ---------------------------------------------
          Center document in the viewport
        ----------------------------------------------*/
        body.madoko {
          margin: 0pt;
          padding: 0pt;
          max-width: 100%;
        }
        .body {
          margin: 1em;
        }
        
        .maincontent {
          margin: 0pt auto;
        }
        
        .preview .maincontent {
          width: 98%;
          max-width: 100%;
          margin: 0.25em auto;
        }
        
        
        /* -----------------------------------------
           Settings for a wide viewport:
           The contents are shown in the side panel
           on the left side.
        -------------------------------------------- */    
        @media screen and (min-width: 1024px) {
          .body {
            margin: 1em;
          }
          .maincontent {
            width: 60em;
            max-width: 100%;
          }
          .sidepanel {
            float     : right;
            width     : 24rem ; 
            position  : fixed;
            top       : 0rem ;
            height    : 100%;
            max-height: 100%;
            overflow-y: auto;
            border-right: 1px solid #AAA;          
          }
          .mainpanel, .footnotes, .titleblock {
            margin-left: calc(24rem + 6rem + 2px + 1rem);
            margin-right: 10%;
          }
          .tocblock2, .tocblock3 {
            display:none;
          }
          .tocblock.auto-expands, .tocblock.click-expands {
            display:block;
          }
          .expand-all .tocblock1, .expand-all .tocblock2 {
            display:block;
          }     
                
          .tocitem.current {
            font-weight: bold;
          }      
          span.unexpanded, span.expanded {
            display: inline-block;
            width: 1.25em;
            margin-left: -1.25em;
            font-family: "Segoe UI Symbol", Symbola, serif;
            font-size: 70%;
            cursor: pointer;
            vertical-align: 0.1em;
          }
          span.unexpanded::before {
            content: "\25B6";
          }
          .expand-all span.expanded, span.expanded::before {
            content: "\25BC";
          }
        }
        
        /* ---------------------------------------------------
           Set margins and padding for side panel and sections
        ------------------------------------------------------ */
        .sidepanel, .mainpanel section, .footnotes {
          padding: 0rem 1rem 0rem 2rem;
        }
        .sidepanel .tocblock {
          font-size  : 95%;
          white-space: nowrap;
        }
        .sidepanel .toc, .sidepanel h2, .sidepanel h1 {
          margin-top: 0pt;
        }
        .footnotes {
          padding-top: 0.5em; 
        }
        .footnotes>hr {
          display:none;
        }
        section,.sidepanel {
          margin-bottom: 1em;
        }
        
        /* -----------------------------------
           Nice scrollbar for toc
        ----------------------------------- */
        .sidepanel::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }     
        /* Track */
        .sidepanel::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,0.3); 
            -webkit-border-radius: 6px;
            border-radius: 6px;
        }    
        /* Handle */
        .sidepanel::-webkit-scrollbar-thumb {
            -webkit-border-radius: 6px;
            border-radius: 6px;
            background: lightgray; 
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,0.5); 
        }
        .sidepanel::-webkit-scrollbar-thumb:window-inactive {
          background: gainsboro; 
        }
        .madoko .toc > .tocblock .tocblock .tocblock {
          margin-left: 1.5em;
        }
        .madoko .toc a {
          color: #444; 
        }
  </style>
  </head>
<body class="madoko">

<div class="body madoko" style="line-adjust:0">
<div class="titleblock align-center para-block" style="text-align:center;line-adjust:0">
<div class="titleheader align-center" style="text-align:center;line-adjust:0">
<div class="title para-block" style="font-size:xx-large;font-weight:bold;margin-bottom:0.5ex;line-adjust:0">The Koka Manual</div></div></div>
<div class="flexbody">

<div class="sidepanel">

<p class="p noindent"><a href="https://github.com/koka-lang/koka"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAMgCAMAAADsrvZaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACQUExURQAAAJ+fn4uLi39/f3R0dGBgYFhYWEBAQDw8PCAgII+Pj2RkZCgoKBwcHKOjo4ODg0RERCQkJAQEBKenp4eHh2hoaLOzs0hISAgICK+vr5eXl2xsbBAQEFBQUJOTkzQ0NAwMDFxcXDAwMFRUVBgYGHx8fBQUFDg4OJubmywsLExMTHBwcHh4eKurqwcHBwAAAJuavHYAAAAwdFJOU///////////////////////////////////////////////////////////////AGKl0HgAAAAJcEhZcwAADsIAAA7CARUoSoAAAERfSURBVHhe7Z1pQ9u8EoVfoC0tUKC0tJTu+37z///dheQEstiOrXNGGtnzfOgSwngi5dhaRjP/zYIgaCUEEgQdhECCoIMQSBB0EAIJgg5CIKXY2z84ePDwhkeHNzx+cst/t8z/9fj2xUe3P35wcLC/h98JshMCycje0cHxo8OTp3MdDOfpyeGj44OjUEtOQiDmnJ4dnz/Dd1zGxbPz47NTXCGwIwRixvMXl+fPLvCFtiKEYkwIRM7LF5evTq7wBc7F1cmryxev4UGgIwSi5PrN4Vt8Y8vw9vGba/gSSAiBaHh98O4EX9LyPHt3EA8TESEQmveXHz7im+mJjx8u38PDIJ0QCMP1p8XWhV+efYohF0UIJJWDV2WnG/35+OoAPgeDCYEk8PzNZ+vlWzmf38RicAohkIEcfUndCC/P13dH+BRBX0IgA/h26HE2Poyrx9/waYI+hEB6cvrpO75i9fP2UcRz9SUE0oeDH/hqjYcP8SDpRQhkF2N6dKwTD5IehEA6GeGjY514kOwgBNLKeB8d68SDpIsQSDOn73LH45bk4vwnPnewQQikgWmpY0FopJkQyCZTVMeCq3ex2b5FCGSN6apjQWhkkxDIPa8/1b9RzhMaWSMEAkId94RG7gmBzHlTS+h6Lj5eomWmTghkNrv+gG9FsMqvOJB4Qwjk4bSn5V1cfUIbTZiJC2T/F74LQTMn+2ipqTJpgTyKh8duLr6gtabJdAXywnu+BT88OUObTZCJCuTl7+oOlRfl4vdLtNzUmKRA9r+i34P+PJ3mbGSCAvkTex5pvP2DFpwSkxPIpxhbpXPxCK04HSYmkHP0dJDK4cQmI1MSyN5ndHLAcDKpgyPTEciLmJmr+DqhZd+pCORPxOoquXqDdh090xDIo5iZq7l4h7YdOVMQyDv0aaDlEO07asYvkJCHHb/RxiNm7AL5gq4MbBj9QGvcAnkYcw9zRn5mZMwCCXlk4eIh2nuUjFcgf+KwRy4ujtHmI2SsAgl5ZOVqtHGM4xTI35BHbq4eoO1HxhgFchDx7CV4O8pauuMTyM+IuSrF1xGGMY5OIBGxW5LP6IXxMDKBPEJHBaUY25GqUQnkW8zNy3M1rqJuIxLIXkw+fPB1TCXdxiOQSLDrhw/okxEwFoHE5MMXo5mKjEMgBzH58MbVSHZFxiCQ06folMATT0dRhWcEAhl7rf96+YEeqpnqBXIQMe1+uah/nFW7QE7QFYFPTtBP1VK3QN6gG+rj6smHw4dvDq73bsCH2eb2h9cHbx4efnhS7ypE5QmCahbIy8om51cnc02kz11P52o5qUwsT6tOVlqxQKrZ+rg4eXX54jm81vD8xeWreoRS86ZItQLZ+47Wd8yT8+Mz27XO07Pj82e4mmO+1xt8UqtAnKdpf3v45xqe5uDnn3Pn94tzeFoddQpk32+m3avPn/YLDbr3P332O+r6WGmBqioF4nRr8Ovvv9qZRgr//v52GtVc57ZhhQJxuTX4+dJTYMXppceDlVVuG9YnEHdh7VeHf10uZH47dDcQrTAMvjaBXPvq9K/vjuCYT46++Bpvfcy5dCGhMoF4StX+9LiOxcvTyyfw2AO1ZbuuSyButs4vDl/ApTrYP3ezvvUULlVCTQL5gyYuzZPLGoMnXrp5kFSVprQigbhYmPnfK9+Tjm7ev3LxIKkpe1Y1AjnyMUaANxXzxkFoytV7OOOfWnr8FZq2NHCnbs7KP4xfwRX31NHjL91EGsGh6vlW+jnyvZJ5XBU9folGLU9lSzCdlNZIHSepahCIo2O1T+DSSPhTdN28iuO4/gVy6mnvvPoj1luU1MjHChIDuReIr2Pno6yd/7DcAqH/YZZ3gTxGSzphlAKZza6LRYA+hgducS4Qb0cbvsCv8XFZqG7dV1zfK64F8t7dyY8xlwTfK3MO7cL3pqFngTxEEzpi1DXzZ7MHRfabXDeqY4F4PBQ3ykKuqzwvkQ3Dc2yWX4G4rOU8eoHc8CB/y7/FpR3iVSBOc1LDu5FzlH1vxO9xdadd/hsN5w24N3qeZx/f/saVveGzy90mC4R/UyD3PeoZrusMj13+z29aOHg4DY7z7rB/fI3rusJhlx85LokDF6fCt6zLvhceky/663LXNT/g43R4n3W06zA0y12Xe0rssw2cnBJ7OSXib6rurcudV+SEl9Mip0Tc5V501uWeUpw1ATenxs98QaPezmz66nKXu+erwM/pcZRNIh9xRSd46vJT/xWd4ekUySaRi5+4ogscdfkZGsgzcHWaHOR6wH/DBT3gp8sdBrdvA1+nSi6JOKr66abLnRcdXHAFZ6fL3zy7635O4noRyC+0jG9GlvUniS9oC1vcpI9xIhBvZ89bCIHckiXS18tZdR8C8RuduE4IZM51jhAtJ8u9LgRSiz5GmDcukQcZVuSv/uFiRXEgkNfV6GOsabFSyHBc5MKDQsoL5J//7cE7QiAr2K+rXDhITVpcIDXpIwSyRoapSPlyXqUFcoSWqINqyr5k4o/53a24QgoLpC59jD1vXALmpSlKh52UFUgN4VerhEC2MM/PVLgmblGBeKnr3JsQSAPWZ9zKKqSkQIz18T/8LeQSngerHBmv0xdNqV9QIJ/w+Y04NNh/nELm0RSMaxCXVEg5gdgGvb3dszi/GwJpYc82Dv4dLlOAYgKx1cf8nqOvThUCacW2P8uFv5cSiGl7Pl3k6NNHQ8zNBo28NM14XUwhhfrcVB/HuIj+jCIMB42YngktNcoq0+eW8/O3dyFu3/CKDhgOmvlnORMpNFMv0ueW67ur4VJ4SQfsBm0coqEs+IRr5KVEnxvq4+IFrjEHL+qA3aCVF4Yb60V2DAv0uWF8yUaNCbyqA3aDDgyjs0ooJH+fG8YnLmfnS/CyDtgNurhEYxlQoD5C9j6308f97HwJfqADdoNOXtudE8kf/Z67z//hk+ppOMyEn+iA3WAHdknOsqclzdznZucH12fnQB6MBbvBLo6s8stlP6eet89fW+mjuQKkPBgLdoPdWJ1Yz62QvH1uFRfdchRWflIBdoMeWAVLZE7/mrXPrfTRFkMoHwrDbtCHfaPhQt6Mcjn73Egfb2F+G3lwEOwG/TBKKJtVIRn73Ki5PsN8A/Ite9gNemJ0Gjdn3t58fW40a+s6Jn6A98iA3aAvRjW9f8F8BrL1uc3S+MU1zDeDd8mA2aA3ezbj6nOYtydXn9ucFdhVEhVvkwGzwQBsChdnyy+Tqc9tAhR3ZgLF+1RE9YMUbDI6nMG6NXkEcopPpeUBrLeDN6oIgSQhnwrOyZTYOo9ALFbEP/bYUsVbVYRAErGYiFzAtjFZBGJxErPXUh/eqyIEkopFQof2/S8lOQRiMU3rV+tJfOcKgSRjUdcwS3dkEIjFblHPQh1iaX6A2WA4FlP1H7Btib1A3uHTKOm7yCfWZtTPIbA4aJghF5C5QCz2UnsnOBTvToZAGF6gFZW8gW07rAVicMJ2QOU68fZkCITiucFipvkZXGOBGJwgHLJ4IY5WDIGQ6A+rXyyyzNphLBD9AvigpQvxFlWUKGR5hpbUYR37bisQfXsMXLjAb4mIAlM0+iXN5tPWMkwFok+vPnTZAr8mIgTCo1/U/A3LNlgKRB+DMzi1Hn5PRAhEgH5Z07Rqi6VA5BP04akn8YsiQiAK5Oc8TaOyDAUij8BKSM2K3xQRApEgL0thGZVlJxB59E3Kkjd+VUTpovZjQb451pGXgMVMIPIjhElbQvhdEVGiUIRcIXbPdiuBvIfnKi7ew/AwtPswIRAV8k31tK9HD6wEIm6A1IST2nDeEIgMdYiF2UTdSCDiHFjJCVm1E6EQiI7X4iALq1xZNgIRVyj/+BJ2B6OtmQejgQSxQowKRZt0ungviAi3eQQTGmA00CBWiE3ou0Wni3OYMOFo2rU0GA1EiAfiJnlOLDpde2egwjW1e1IwGqjQKsQksNeg07VlTrlPrQ0Hg9FAhjbaol8mj2HoO1179pi9K8CMBtgMdGhHGwbTEHmnv4SvGi6S168A7GiAzUCIViHs12UbeadLT1XyBelgSANsBkqkO4bfYVSHutOl6Y8EBRthSQNsBkq0e+ryU9HiTtdGoQkCbGBJA2wGUrQKUQdliTtdWh5bkdIFpjTAZqBFum+mLoKr7XRp6JMk5RFsaYDNQIx03CE+GyLtdOlhyoTzgw3AmAbYDNRIFaL54iyRdjo8lCD6mNK9WtgM5Eg3dGFTg9KasgiE6jYgPRACm4Ee5eBjV+XKQQg7XZnxSJa2W5qoDDYDAz6hjRUok77rOv0a3inQFX6QHgiBzcAC5Rmi7uLgg9B1ujBmQFg66AtMSoDNwARhkKswrlfW6R/gmwBlmiPpgRDYDGwQLqjoaoGpOl24DCE9fy9deYbNwAjhNrMsfYCq04XhAtKDYX7XD4MtnqOdBcjusqJOFy4WiVOHwKoEmAysEFZpU63zaDp9H14JUOfIg1kJMBmYcYyWFrAPkySaTtetYMmrnMGuBJgM7NCVXRWtZEk6Xfep9KeKYVgCTAaG6BZ7z2GRQ9Hpe/CIxyA9Hiwr0B9XC7bRLfbuwSKFQiCyU7YWeVtgWoFw/zJoRzZel9zQBALRZS/kT9huA9MKQiBZ+Ifm5nkEiwy8QHRpTB7AohTYVhACycMDtDePIMkJLxBZkLtNmX4YVxACyYRs0UcQ+E4LRJaoWhrFf48wd18IJBeymy6fSY4WCDyhsaqAIjwxFQLJhiwqC/bSYS3Ilq2FIfxrPIN9Ab9gMjDnJ5qcht5YIwUiiwU0q8IoPDFlM0kKmpDFnLChfaRAVEG8dnV8QyB1ojpfxA7dOYGogngNK8ELzzqHQHKi2lEnw3opgchS4sGeBcIjhSGQrKhGJ9z5Iuq7qVqNs6weq9t1CoHkRXWGgts/YASimqHLM3KvIjxSGALJiyqGibr/MgIRLVY/gzkjcBUBmvjpoDe/0PAkVD5rQiAigVvtEC7BZQSYLUUHLYhuwUzQIiEQXJ3lBcxZgcsICIHk5j1angXmUkj/XdFCtfnAHtcREALJjqhgGZEmK1kgomOEhjsgABcSEALJj+gwXvrhwmSBiPZxLM5IrYMLCQiB5Ed02ij9LHeqQL7hyiTHMGcIriQgBFIA0XGKbzA3mFSBaNYXjFd45+BSAkIgJdDEiycv9SYKRLPEa73COwfXEhACKYIm5CR1qTdRILgqifUK7xxcS0AIpAiikBNYG0ra72mq2eYJ3dCl1U4exwYUmhMLiScqkgSiOe9lv8I7R3fm1jKmMuhAk1fgJ6wNI0kgmiVe+xXeOSGQ6tFkykpb6k0RiCZANsMK7xxRxNsNIZBSaA71JPVfikAkTzyjLD/b6M7chkCKITl5lDSmTxDIX1yP4zWsmRMCGQGv0QUcf2FtCAkCkewRfoExe3Spg0Mg5ZBUK07ZLRwuEElZzEwrWLfoDqWHQAoiGdf/gbEBDBeI5AEiKd3QD11VrxBIQSTR4wmPkMECkTxAcp7u1h1Kh8GgCJK55PBHyOBeVzxAqEPCQwmBjIQy37yhvS4Z0YsKkPYEF+WBvaAMkpiswfF0Q3tdEdlEHIBMAVflgb2gEIpD3oMDyAf2uuIBkiXIfQVclgf2glIo7s5DHyEDe13hYsp2DQMuywN7QSkUW9RDb8/Del2xXaMvhb4DXJcH9oJiKE4XDtyiHtbruAYFTOUD1+WBvaAc6AkKmOrJoLe/wyUYLmErH7gwD+wF5VDs+r6DrX4M6nVcgSFjjMkSXJkH9oKCKCJOYKofQ96teIDk3QKZgyvzwF5QEMVmyKBHyJBeh32GHHl+NsGleWAvKImiKCtM9WLAmxVx4y9hKye4NA/sBSVRpFockgJoQK8L9kCKVNjAtXlgLyjKOXqDYMheSP9eF4Tx5t5DX4CL88BeUBbBjXpAUG//Xv8I4wT5l3hvUZVLDYH44BLdQfARpnrQu9dfwDZBgSXeW2R5f2AvKIxgqbd/Ts/evS64Dx/BVGZCICNDsNTbP0dW314XnHjMHoQFNHlSb4C9oDSCkKzeZ7779rrgWwZL2ZHl/YG9oDjoEILemXr79jrsEphWQ+8iBDI6BKULYWknPd/ILz6XWeK95Tc8oIG9oDz8Um/fLbmevQ6rBG9gKT+yxFiwF5RHUJgNlnbR732fYDSdrIlM1gmBjBA+xcknWNpBv17nn2i5z9muEAIZIQ/QJ+n0HPP36nU+yqTQHuEcUUHeEIgr+N3CfvEmvXqdd6Zk1k5Z5jjYCzzA92q/m3afXud3Lks+QEIg44S/a/c6vNen1/kokzNYKgOcoIG5wAX8fa9XDacevc4fUUmrDicDXtDAXOAD/r7d5/hej17nN9oKRSkugRc0MBf44Ajdks5vWOqiR6/Ta7yFHyAhkJFCP0L6rPTu7nX+IMh7WCoF3KCBucAJ/COkx7GQ3b1OH6cokclkDfhBA3OBF+gMJ09gqIPdvQ5b6WQst9YM/KCBucAL/CElGOpg51voZD/FHyAhkNFCP0J2JwDa2et0VFjxB0gIZLTQj5DdMbS7ep3eRS//AAmBjBf6EbJzN31Xr/+CoWRKL2HdAE9oYC7ww3t0TTK/YKiVXb0OO8kUjcICcIUG5gJH0BFZsNPKjjfQZym+wVBJ4AoNzAWOoM8y7KpZuKPX2Sl6wYOE98AXGpgLPGH9De3u9WtYSWZwWWoL4AuLC7EHG9BjnGsYaqFbIHRlatgpiyg5b49t1yA/6J1kdlTt7/4Kw0YyxXJhrSHKPRoCcQmdIwt2Wuj8MZ1cBXYKEwIZNeieZLoTUnV+h9k1tN75HW0JgYwaNitu905El0Bew0Iy5aNM5tCbnQtCID6h401ew1AjXQJh08WVPii1RJScNwTiFHYRpjOFXJdA2JpS/auU2BICGTfskb7OelMdAmFHWAPqXNkSAhk57J38FHaa6BAIO8IaUCnRlhDIyGEzf76DnSY6BMLqEmbKw6fenhMCcQt6KJWuGIn2r/EpfjuVQ9gpjyh7dQjELewYoWOM1S6Qd/jlVJys8d4QAhk77EpvxxirXSBkmKSHgyBAJJBSRUiD3ZBb2h1jrFaBsCOschWltuCrN8zxM2YMNmGDon7CzjatAmFHWDDjAVF69xCIY9BHqbRXLGz9IpMjrB1BxFkJgYwf8mBGexLSNoGwI6wdx1CyEgIZP+zRvtYxVptAyBGWm130OXCKJATiGXLXrnWM1SYQcoR1DDM+gFMkIRDPHKOXEmkdY7UIhB1hwYwT4BRJCMQ16KVU2mrYtHyVyRHWznRceYFXJCEQ15Cnfh7DzCYtAiFHWA7SKa4Cr0hCIK5hkyzCzCbNr5MjLG8JcuAWSQjEN+RNvWXdtVkgZPzr7qTyeYFbJCEQ35CFOloKFjYL5Dt+KRFYcQPcIgmBOAf9lEjLzkTzlxm/k8h3WHED/CIJgTjH5Lbe+DK59XwJM26AXyQhEOdcoqMS+Qsz6zQK5Ad+JRFY8QP8IgmBeAcdlUjz3kTjtxm/kchTWPEDHCMJgXjnKXoqEVhZp+lVcpHXTbKGO+AYSQjEO+TBn8aAxSaBkIu8sOIIOEZSnUDYIz29wLV8AJ8S+QIrazR9QG41wN8ISySQzgR8HhGlXO3E0cnqG7gxVuNCb5NA8P5EPBRd2wCekbgoBjQEcmu5Fz4KXCwhC7LByhoNL5KLvLDiCXhGUp1A4LcpuJQX4FUiTff2hk/ILfI6qIu+BVwjqU0gOaYgXvKTL+HqpjedE28QCN6diMMR1kQFcgG/LcGl3KAfY22/Ri7ywoor4BpJZQIRZQPrxNsDhO3qhmSH219obpHXSVGpdeAbSWUCmeIDhC031RCGvv0ZuUXeM1hxBbnDCuoSSI4HSNspvIKcwbU0GhattwWC9yYCI77QFCmsSyBw2hKXhePhWyIwssLWS9w0x+Ma1iQF8hhOW4JL+YJbxzqAlXu2PiWXSd5RRt4VJigQ+GyJrz3CJVyW3u1woi2BcAm4YMQZ0xMIeXaoD+6OxQG4l8Z2tMnWVxrvTMPlqHSCAvkCly3BpdzBBdjAyD2brxzhjWn4fOpOTyDw2BKPG8JzXsHBNLbyx20KhLv3tKWnK4ymimc9AiHLyfTB6a3whn14mMZWyPumQLgtAxjxxsQEcg6HDfG5WrkALqaxdVhj8zuN96XhtYrftAQiqvbQha/k/RtwA2oYuWPjhed4Wxru0pmAaQnEPsakvdyMB7jkJs9hZcmGQLhV5Jew4g2NQHyVdGhFE1fTCa7klJfwMo3NnbyND0vFerm9sWgEsr3L6hFuEacXbhewAPUI3Yy23RAIZdttVgPNrLUKgWSYgHjLvLwFdT/cvMtvCATvSuMFjLhDE9lahUDgqyHtBWG98AKepgEjS9b/z91/YMQf0xGI/Q6IwxD3LeBqGhvdvP6tpgawDvP9gMkIxD7Rzwmu5BpqnWJjC3RdINQNyO8qz1QEYh+C5e+MbRNUf28cmloXCN6TRsOBXidMRCD2E/Q69DHbg7tpwAhY+y9XjR1GHDIRgcBPOyrRB9kS67XY1r7WVL4Gx61HFo4A3gVinkjRV5rRLr7C4yTWU8yuCYSKYnkHIw7RjD2cC4T6UvTBdQDWOlTOvPVAzDWB4B1pOA11v2UKAjFfwKpIH+SpJhhZoBMIbHhkAgL5DSfNqEkfym/y6v+oUuxOT9vOGb9AuCDTHtSlD24+9h5G5qwKhJrLei4vM36BwEUzKtMHF461dmpjVSAf8IYkmmuE+mD0ArE+AlKbPmZ/4XgSP2BkzqpAqIw/Xs+C3DJ2gXCpmnZTnT64MyFrH3dVIPh5GrDhkpELxHqBt5r9wRXgehqwMWflP6/x4yRcZnVfMm6BnMA/K2rUB3fy7zWM3LIiEOpr5PU4+pxRC8Q6C2+V+uAWnFZ7ekUg1PbjKYz4BE5ywJYzrHP81KkPrgzUanKslW6nHtWw4RQ4yQFbvrCOcK/i/EcT8D+J1Q+90u34aRLO7zPwkgO2XPEHvllRrT64lQvYuEUkkN+w4RR4yQFbroBrVtSrDy72BjZuuf83dRjE8zbhDfCSA7Y8Ac+sqOH8eRvUVuHKkZD7bqfCeTbz0TkDXnLAliOMN9D95y/pgMoR+gdGbrjvdip8BTa8Ai85YMsPxvrYSnReF/gUSawEFt53O5OwwXMo7y1wkwO23GAcYOJ6Z6sHTEDvytnJ+27Hz5JwvY9+A9zkgC0vGOtjZZRRJ9ReOmzccPdPKrxr/RivP+AmB2w5wTgAC1epGCrBwn3o7V1LUPka92HEK3CTA7Z8YKsP3/UN+kFVmrr/Qt91OxW84jnW/Ra4yQFbLrANUKwvvL0Bakh0PwG763Yq6yhsuAVucsCWB2z1UWn41Sb4NEnc5x+963amzd0nTIKfHLDlANsAXq+F9IbCLMvehxDcdTuzKub5PPoc+MkBW+Wx1ccvXKV6mI29+32Lu27HT5JwvyQIPzlgqzi2Ae41h5esQwVywoZIIOvZTB0CPzlgqzS2Ae6Vb5+vQgUXwsa9QKjQFdjwC/zkgK3C2Oqj+u3BVfCZkrgLLlx2O7UNAht+gZ8csFUW2wMguMhIwIdK4q6c4LJNmG0Q/8secJQDtopiqo8xbA+uwuRiv9sIWXY7M/PzHxYNRzlgqySm+hjF9uAqzHf6biNk2e3P8IMU/FfYh6McsFUQU32MZHtwhWN8shTuaiAsu505W3AGG36BoxywVQ5TfVR8uraNM3y0FO6Gm8tux+tJ+E75cwsc5YCtcsAPE8az/XEPlfoHNiQCgQnHwFEO2CoG3DBhRNsfK+DDJQETS4FIxOYXOMoBW6WAFyaMavvjHny6JJbDInS7ZLjmF3jKAVuFgBMWjG159w7FxBrdzkz4K5jewVMO2CoDfLDAe0KBdBRLs+h2yZKxX+ApB2wVAS5YUE9x58EwZ5yWm3vodkZrFaS/gKccsFUCeGDBetHjccGEhyzbBd2OV5O4C1vxCzzlgK0CwAELxri8ewcTYLicmAkE4jyr4i3wlAO28oPrW/AIlxgnihB1gUAWFlwDTzlgKzu4vAXfcImxgo+ZxNIE/iJYWHANPOWArdzg6gaMdnn3DnzQJJYm8Fc6NawSwlUO2MoMLm7AiJevljCJFmBi8fceXkyhhig3uMoBW3nBtQ0Y8/LVEiZVz97CxKLbj/BiCu5TmtwAVzlgKyu4tAGjXr5awiQ2OVqYWHQ7Uwb24dyCb+AqB2zlBFc2wHs2ZQ0P8WlTQKnbRbczkSZv5hZ8A1c5YCsjuLABuMDYYYpCIdZk0VSP8GIKXuvrrwJXOWArH7iuntEdrm2DGRlhi2jR7cxYzX1SrBvgKgds5cLu/OD4Dte2waTGwtx60e3MbN//ecIqBWKnD+/VjoQwx5ywOrvo9qd4MYW5AefAVQ7YyoOdPt7hCpMAnzmFp7Cw+JNgbsA5cJUDtrJgpw/nBbvF4EMnAQuLPwnmBpwDVzlgKwdm+hh/dMk6+NhJwMLiT4K5AefAVQ7YyoCZPr7jApMBnzsJWFj8mU4VBzbhKwds2cOs3ncywtxXO+CDsWiBVFGPCL5ywJY5Zvnb/aeIlcOk511YmP/FxCp+mJtxDnzlgC1rzPRRwdFoOR/w2VNYRCvOu52pmFtDrGJNArHSx9Sm5wuYHfBFKeh5t489VrEigVjpYzLRJevw0Yq0QGqIVaxHIL9xLTXTm54vYNY7VgTyAC+lUEOsYjUCsapfW0HqMhuYW/+DuYV5tzMPohpiFWsRiJU+prV7vgoTrbiYPNACwclE38BXDtiyw0gf400tuhtmfTYEMhDYMoNZkuwAQXfTJATSD/jKAVtWMEcOOvgB89NEJBDmQGEIRIORPqpYhbeDEcjiSOG825ntlLkV78BXDtiywUYf09wdXAUNkcJiCzwE0hvYMuErrqFlcsG726AlUgiBDAS2LLDRxy9YnzJoihRCIAOBLQNs9PEb1icN2iKFFYEwC/BzK96BrxywpecjLqClihAHc9AYKSxyT867nY+adw585YAtOSb6mGhw4hZojhQWJ51CIL2BLTUm+qjiGFsO0B4phEAGAltimFLFrUzw7GALaJAUQiADgS0tJvpYxKEGN6BFUgiBDAS2pMC0lJh+rIA2SWFFIHglibkV78BXDtgSwpxWaCWmH6ugUZJYGJBY8Q585YAtHSbpr2L6sQZaJYmFAYkV78BXDtiSYZL+KqYf66BZklgYkFjxDnzlgC0VFukZYvqxCRomiYUBiRXvwFcO2BJhoY9Jn41qBi2TxMLA7R+xitUH2NJgcby2ihRlmUHTpBDLvAOBLQk/YFNJFQmYcoO2SSEEMhDYUmBwPGrKqRk6QOukEAIZCGwJeAaLQmL60QyaJ4UQyEBgi8fg+EfsfrSA9klhRSBxHqQPsEXzFvaEfIPpYBM0UAor50HiRGEfYItFH97+FpaDbdBEKcSR24HAFok+fHdCZZ2HgzZKIQQyENji0Otj4pmvdoBGSiEEMhDYooApHZH5qhs0UworAonMin2ALQJ9+G6s7nYjyqwYuXn7AFvp6MOvYnV3B5G8uh/wlQO2knkFOzpidXcXIZB+wFcO2EpFHp4Yq7u7cSCQqDDVD3n4Vazu9kBUYSpqFPYBttKQh5fE6m4fRDUKo8ptH2ArCXV4ScTu9kNU5ZYRSBV3MvjKAVspqMNLnsFusANm8rAikH28lEIVx9jgKwdsJaDePl+s0Ae7YbbA9+cW5t3OzPU/zM04B75ywNZw8PsqYvO8P0xh1MX67KLb8VIKi6h558BXDtgaijq7TxUN7gX+pBMtkCqmi/CVA7YGot4+fwe7QR+u0GopLCzQAkn83uQFrnLA1jDE24MxvBoGmi0JWFj8STA34By4ygFbgxBvD0Zs4kDQbknAwuJPgrkB58BVDtgagnh78BXMBn1BwyUBC/M/n+K1FOYGnANXOWBrANrtjxheDQdNlwKe1otuZ0YCp3MLvoGrHLDVH+32RwyvhnOKtkvhZGFi0e3MfkoN0YpwlQO2+sIEuDUQw6sEmFhF7IAvup05UlhDtCJc5YCtnmiXd2N4lQQTQ4VwhUW3H+PFFGqIVoSrHLDVD2YLdxs87oOBMJu0xwsTi24fe7QiXOWArV4wqx7boK+CofCxihDIEV5MoYZoRbjKAVt9kC5fxcnBZJi59dHCxKLbmWjFGh7/cJUDtnogXb76AaPBcJjVWZwlR7fjxRRqCMaCqxywtZNLvF/CxV9YDRLgQ7EEAhlwZy0GPOWArV2c4+0SYvODAq2YxNIE/iJYWHANPOWArR1Io68idJcDzZjE0gT+Ini+MOEZeMoBW918x5sVxMFzkudoyCRgQyCQFwsTnoGnHLDViXJ6/gs2g1ReoCVTWG7NotuZomCXCxOegaccsNWB9PBg1OSkYZZLlnkx0O3MzLKCKCF4ygFb7TCr7pt8hc2AgEn2ukx7jG5nYk0q2AiBpxyw1Ypy9/w3bAYMzILJMnoB3X6Gl1OoYC4JTzlgqw3h9OMjTAYczDbIGWyg25nA+Z231vLAUQ7YaoZ5BG9SRSalGkB7JrE85rTsdrycBEw4Bo5ywFYjn/EeAbF3LgMtmgRMSATi/0whHOWArSaEwYmR9kqGZFi0/Aczgl4O1/wCRzlgaxtl8NUn2Ax4mIn13Qm1ZbczGyH+jyvAUQ7Y2kI4vIrIdiXMvPAuPfiy25mNEP+V8uAoB2xtIhxeVZEIvB4k3+llt0vU5hY4ygFb6wiPnkfolRjJqGjZ7cx4re3e6gf4yQFbawg3B+NglBo0bBJ38+plt497IwR+csDWCg90m4ORtkQPmjaJu5XZu27HD5L4CRtugZ8csHUPk1t/g6jIqecn2jYJ2BAJ5A9suAV+csDWEmHobuwNWvAHrZsEbKwIhIlb8b6MxWQ1ugfGgDAvdWS9MoFZxLpfMLnrdiby8TtseEUvEOHeh//nb6Uwhzvv71l33c7Ezm/cXN2hFojy4EeElliBBk7i/ozTXbdT8RKw4RWtQKRFoyo4jlkraOEk7rvlrtuZ87uomOsWnUAenEuTwnm/s9QMU9t8Jc/CXRe9xo+ScB5ipxGIBXAw0PMJTZzEaxhZEQj1RHK+jB8CmSDUOgps3HD/z7f4WQrOw4hCIBOE2bdYiaq+7yJq7gkbTgmBTBC0cBKPYeOG+y6idob/wYhP/Aoksl9Z8Q8NnMRKr9wLhKnn9p/vWAnHAokgXiP+on2TWKm7ufKQxw+T8J3HybNAIkWcDb/RvEnAxi0igfjuZdcCiUh3E6hYOdi4ZeXfzAGsVZP+8C2Qu4KqgRA0bRKrR2RXvtnv8OMkXKf+8S6QSOQuhzoAuFqWZUUg1NfIdUyRe4G4j4euDiq0cLX0/4pAqGAT13vp/gUSExEx1D76faDJmkCoYZvrSUgFAoli6FrQqGnAxpzV/1AZnmDDJVUIJHZElKBNk1hLrr/6xf6ANyTxDUY88hA+OidK2sr4hiZNYi27/qpAqImN56yAlQgk6oLIoM58ri04rQrkPd6QhOfOrUUgzreTKoKaLbyHkTlrXYI3pAEbHqlHIP89hMsBBVozDdhYoBPIEYw4pCKBrEZaB6kcoTHTgJEFa/+jUgV+gRGH1CSQClKB+4dKKb7eAWsCoY7xOo5XrEogUSSEh4pUXE+wsCYQ6kjI+pPJFXUJJHbVadCQaawcBrlhY8DF4DdesTKBrAcDBYOhIhU3bvTr/6VWx/zGK1JxykWIuBMGakNvY79iXSBU/lG/STSVqUIz4fuIpnOoxab7rKNz1gXCBS3BiD8qFEhEZhGgCdPYGN5ujrgY3CYgrVEgURQhGSrp6OZtXikQt2VCqhRIZHNIhSkMsksg1DkTt/kV6xRIxC4mwuRU3Dr5tyEQrq7YS1jxRqUCiQ2RJF6i9dLYzOS3IRBuBdnrQm+tAvG8+eoXapF3azdva8jF4DWMqF6BOE9Z6RKu+DCM3LH5AlebEka8oRHIraXLc6byXQqu08W4BA2XxtbKyOZ3mtt0Xjtq4gdNQXMYm/15ihfy4DhK2iXUsb+1lFhzNgXCRdJv7EJ6QSuQG5RFbncSJ0QGQUWDbJ9q2hQI94ByutArF0heiawlEQh2QC3ybslhWyBi+y4wEMhslnGgFZvqA0CbpbF9h9/6SnNFjn3WgzERCLmcOIjYVO8Nt5O3PZzd6nYqo5DThV4bgcxmJ/iJPaGQvlA1ChpW1be7HW9NBEZ8YSWQ2V9t1fQOIuykJ2ivRGBkhe2XmGq3//13BiuuMBNIxplIKKQXZ2iuNBoaebvbH+HNabjM8m4oEC6BxhAiMKsP3Opiw57Tdrfv4c2JwIoruIfiEhjbgjqnPIBQSA/QVon8hJUVGrodb07EYxJruEYCY9tw88IB4HpBK9wSU1MDN7xGJXl3uY4F10hgrAFu83YAuF7QBnevaqqE19DmehWWBp6RwFgTZJP1B9cLWkAzJdIUOt3U5Hh7Ig7HWPCMBMaayTUReYDrBU0Y3NubXuTmtA7HWPCMBMZa0KyU7eYPrhc0wI2wGlfSm7qdW+jd8UUqARwjgbE2uKlbf0Ih7aCJEmnMRdbU7eRCr78ehGMkMNZKrql6KKSNP2ihRNaT8oLGbscvJOKv1B4cI4Gxdo7xRmuiyE4LZFgDrKzT+Co5WoAVP8AvEhjrIFc13Thk2AyaJ5HmQwWN3U4uBrgbA8AvEhjrJFPwYiikCXKE1bxA2Nzt+JVE3I2x4BcJjHWTabk3FNKAxQirRSBk8BKsuAFukcDYDjRxXzsJhWyDpkmk5bh4c7eTC73eZpFwiwTGdsElTupNKGQTskxSS8KR5m4nF3q95W6AWyQwtpNM5wxDIRtw2RTaUla1dDs52WxcUS4HvCKBsd2EQkrAFdhs7d6W17kM8t4S1cArEhjrAZf4ojehkFXIvYm27GMt3f4Tv5YKzDgBTpHAWB/I+0tfQiEroE1S2coYB9q6nRxj+cooC6dIYKwXmQ7ihkLuYJMwwcwWbT8g74G+iuHDKRIY60coJDPk8nprfte2bmfHWHuw4wL4RAJjPQmFZIVcd20dYbUKhF00c1WkFT6RwFhfQiE5+YHmSKQ9IUZrt7PF92HGBXCJBMZ6kym4NxRyCxojlfb6s63dzhVj83U2FC6RwFh/yOC5voRCZrMHaItUGvL9gPZuJ8dY32HGA3CJBMYGkEkhcYJqRtb96kg51t7t7BjrOew4AB6RwNgQQiF5eI6GSKWjwn97t7NjrI6L5gYekcDYILhk/L2ZukLYjdn2EVaHQNgxVtIXygY4RAJjw8i0ljVxhaAVUukKru3odnaM5WeaDodIYGwgoRB72Cn6VuXOFTq6nR1j+dlNh0MkMDaUUIg57CG1U9hpoqvb2TFW6+5kbuAPCYwNJpNCcLUJwlVm3nF8qatd2TGWm7Pp8IcExoaTKfodV5sebBGjrhFWp0DYMZablV64QwJjCYRCLGHXeDtHWJ0CoVN0eCk3BXdIYCyFPAqZaIUdtmR9d3G7zm6nCx3DTmngDQmMJZHnFO40FYIPn0z32aXuboeJZBrTAecH3pDAWBp5FDLFSp+/8dmTgZ0Wun/8CzaSgZ3CwBkSGEskTzagCSoEnzyZprJSK3R3+3sYSeYYhsoCZ0hgLJVQiAn0oYKWdD9LdnQ7uxXiI0MWnCGBsWTyZCX9iqtNBetv6I5u/wQzyXgoyCZKug5r6YRC9NDVIT/BUBu7uh1mkvFwLMSLQOi7XT+a0/iPFPIgyO5e3fUGevVlxxAvB24Ekqk6woQUQk+Sd7bVrm7fh6FkHNT0FAnkAOYYYMoYVxkzTOGqdt6wD0Ot7Lwv0je98gmAHAkkk0JaszyNDDbZT4+t1Z0CoWNRyz9CPAmEnlT2oyWX/9igHyC7E17sHlnDVDrFHyGeBBKpToTQD5Ae88rdb6Er5Bd/hLgSSK7jIY9wuTFDP0CewFAHuwVyBmPpdByJz4JoWCMSSK566uM/Ysimx/3vvzNY6qDHQ4aeppfeuiJrcy1RCSTX8ZDRK4QO3ukT/dxDIHS4ZOmzt94EkqsEFa42VtiTtv2CzXu04kuYS6fwI0QkEOEdmR489wNXGyl89OdLWOqiTyPynpR9hIgEoqzdmye0d9QHqPgHSK+cCX0EQu+mF36EOBRIpsDFMQe/8/eYnbvot/R6DPPF8XXj9wQ8CiRTWNZ4FcKv3ffL29ZLIPzmVtEkci4FkinoZLTB7/xNu9+cst9Ejr/dlXyEsPm9gFggmRQy0tBe/gHSc4LWTyCPYDSdko+QQ/hAohYInTOmH85q1ovgHyA9Qw36CURwt/sLSwVwKhDVk20XYwzt/YvPRgBLu+j5Pv47VvB0uleB5NpSH2HgIn828xCWdtFTIPxmYcFuEgmkM4VrGpm21N/gcqNBEPDZZ5Pwlr5PGkFXwlJ+RALpe88ZQp4Nw7Kr7AbgYxH0Xrvo+7XlIyfLZeoVBXZYCCTThmG5m5MJbDbeG3pHmPduOsG97hqmckOfaFlgIpBMG4ajCjq5xoci6L891Fsg/LGQYimAXAsk03bImBRCp/rpdRAE9H/4CpI6Fapa6FsgmU6pjyfohK1IeMOAJdX+AhFUNC50G/MtED57ZT9GE3QiGJQOWNYbMH0TOFamHIJoqchKIKpVtl2MJOiEP7836EY9QCCKjV+YyguuzWImkFzbIeMIOsGHYRiyozXkKwvzDDuKMdiAa7MYfr8ybYec43I1Q5esuQGmejHkzYqhQImlXlyapUeOmGQybYfUH3QiWOIdNhQYpiaeEku9uDSLpUAybYfUn+lEsMQ7bJw/6N2C+VGJLsKVWUwFonJyF7harSjyUg5bKRooJ54CS724MoutQDJth1SuEMWDFqZ6MuztioWs/PN0XJjFViC5tkOq3lJXLPcNDMoeqicB2UNLcV2WXlliCDKdDql4S12SZBm2+jLw/YrbXPZ7GK5LA3NmZNoOqXdLXTHA2lWTcJOhva7wMXcBJFyWBubs4A9a96LWLfUf8J9h8N15aK9LUuhkrluIq9LAnCGZFnvrPKXOp1K8YfC56cG9rujDzMNgXJUG5izBlaypcsNQsZk6fHg/uNePcSmKvBXCcFEamLMk12JvhRuGkrIqxzDWn+G9Lin2nbUsG65JA3Om8BnI+oHL1QNfbu2GhNQ6w1tKUmQva8QJrkkDc7YoZqJ9wOWqQbKAkfDgTGgoySMk5ygYl6SBOWNEx7t2UdmGoaSyY0putoReFxx5vKFvXiIBuCINzFmTKbK3qg1DQV62G1KOfKf0uuRpZ70vvQKuSANz5mRa7K1pw/ApfKZIyg+d0uuassrDFxRSwQVpYM4eXM+aIqfXktAUsEiKcUrqdc0BuH+wZg6uRwNz9mgGsbvJu9qezj/4y5H2xEzqdUGaxRuyVUTA9WhgLgOKgzd9yPcUp9CE4KSV60/rdUHuxxvssiCsg8vRwFwOFCev+4DL+eYcznIkZr5NbCJclOQFrBmDq9HAXBYypXGoQSF8Ddk5sDaUxN/TbPjmWYvXrCncAHt5kOw27aaC7RBNS/QsKLVFaq9rvM4SeF2nQGTPvR243w7RjDaT6zel9rooqu4S5iypVCC54haNTxKzSCKb/vvvG8wNJrnXRYPk1zBnSKUC0URX9MB3wkU4SZK+KZrc65LoyixRi7JbMexl4wOua02ZjMn9kGyhM9Hj6b0u6j77dJiabdgbYC8fuZaycgx00xAVAiYekkSv4+IsRzBnRr0CyRW3WOCT9UOzI019PuJ3RWd7zOtDVyyQXEtZXhUiukGkLvHewjSNaKneOmauZoFMe7FXNIqnbsFMr6uWh4wPT1UtkEz5Fl3GvkvSH9xAZSqkel20xPDfPuzZIJroFao2nusIrr9kWaoJCHfyiBLIKVxgsY13kFU4K1OOX3UX2kWu0NHeqM6NncJeGty4QXV7M33AVy6QbEtZg3Oq2aK6MZB5PMmBtUrlltlIaxdItqWsUp+vEU2MOz86IQUiC+MYUJh3KDKBJMfzkMgaeRe4ngdkhypZ1bONIstIbpdKTiaQYmOQXNnk/MS+P4dHNPTaA33XgCM0divxz3AFmnKD9FxRWSUqSDYim3fBXjq0hTfwhMYs7FqWia3gLDZXVNYzXK8wsnsaP3LnJSZbhrTKsTEGgWRbynJRGUGWs0KQfI0XiCbp3S1GqyijEEi2payhFZgM0C1KCNJ38gIRTiFhUIxMIPaR+R3kOmBo1AlDkGWWZIIUlyjaQ1HcfY7NRF02Biy71yyLmNkFrlcM2WhSsuSgaA7R4cIbTBL2wjZP4WAMTTKy3RSO7NWF1kh2DiT3C9WuZ3J2r05gmqd0tFKupayikb26FW3NiFjzQNWtsRgsZcEyT/Fwvky5skxuUz3RJV0VPQg1AhElv7tFfz4ahnkKfm8AHDHnHa6XHdmumuwMhWhKJjy1IM9HCrs85TNI/YUn5vzFBTMjvNGqwl9FAlEWfXkOkypglsdBirVcad9VX4thvNZ9i2RhZaqWEEacqkPmYJbHQw7CXGnfi8QtCsMFZJvOsluFMJ5OHDIHqzwuknTmWsoqELco/Gi6bJG6Z6lQ/tqQORjlyVhWsQPhYLaT7IfUZScnpFs5OoFcwzkF0gOGsCkABgsDZ8zJHFkjO7ZzwzVsChB2ujIWQrnOCJMCYLAwonznu8laoE2Z30j67cHfCpT5N/7ApgBYFACDpXkFd8zB9XKgVL10KCxtBDgoQacQGBQAg8URjtY7ybeUdYYrSoBNDVJr0oe/LEUC7AmAwfJoyr7uJlfc4hGuJ0E4+LhB2+nSgFNV2neYEwCDDsi1lJVn4U6qD3FAkLjTpeF0IoXAmgAY9AA8MscyYdmSf0q5q4sFiDtdei8QBZ3AmAAY9ECupNaSU3ndSPXx33tYVaHudOkKy8U/WKWAMQEw6IJcx6fs0+VJ9SE/LiHvdNn521suFDU+YUsADPogV8yJ9aeW5mvRB8jIP74uycktimUUmBIAg07INVG3LQEm1YcijckG+k6/hK8aBAqBJQEw6AV4ZY7lEVzpgMMiw7NBp2u3sXiFwJAAGPSCqgLTTuwqqWvHiRbxlRadrn1q0vcv2BEAg27IVX3KbClLqw+TbU2LTlcVngKkQoRHuWDRD5VP1MXuc6WkWjD56MKj97e8hdk0xiyQbHlOTD66WB82JWZsOv0xfBZBPTtHLZBsE3WD4Yt2fm6Vdtuo08U3B6Z7xi0Q8cO6Hfl5Y+1M1WypzarTxYv0xJ66cNkZFl2hPIjXiThtnlgfZpH5Vp3+Ho6rSFfIQ1gQ4KrK5RLlMbVOlAcMtfFXN6hDsO4wuysKv5dzLlLXKMYukBon6nJ92JVusRs2yKPpEqPfRy+QbBN12TDmSK0Pw6SwhuNq+bG3NIUIkxE+gElnZJuoi0IBtWcibuD2AboxFIg+mi7pDi6cxRatwdZBton6L1yQQnr+/BbTo/OWAhEusIKU48YTEEi+ifoXXJBAn7XIdORrKRCDVMsJJSanIJB8E3X6y6g/Cvkblm0wFYiu3vUdw/dLheme/Qok20Sd/b7oR4PGpd1tBaLeDrphcEizrMitgxJT7WSbqHMxJ/qMXiYhvCsYC0S+4D08pmAaAsk3UWfu2ProY8mh7C6MBaKsGbTkaliyk4kIJN9EPTmp9Wv9eEJVaK0da4GYPPsHVWkTbse4Fki2M+qp20H7Bg7ahLivYi4Qk6phQ8KC8CsKJNsAdsBLe3C9YVjcKW0XsObYC0RZe+qOAY95/IYCFyWm2sl2Rj0lz4nFfdLurPw9GQRiMjruv5iFX1DgXCAmt6JGhqfstXAtS+LgHAIxWOwdsJiF9yvwLpB8Z9SHzsYs7pHWC7wLsgjEZP74secJEbxdgdWpNR3ZJuqXuGA/LO6QmYqX5BHIT3woLf1WU/BmCTDpGDhqD67XhwMT2f6EdWMy9fk3fCotvabqeK8EmHTMF3hqTv8buMX0PENObZCrzx/hc2npM03DWyXApGf04W8t9B1v2jhkX5UBZOtzcSYgcLX7QYt3SoBJ11iM9xvpVVvnuY07Rjl+GsjX50aVJ3fuGeJ9EmDSN/DVnh7btQ/wVjEWSXhbyNjnRmuQu3aL8DYJMOmbbIG9u5vjHG8Uk3M1MWefGz38dzQX3iUBJp2Tbb9w10TdKH4yzwYIyNrnRqv0F50hnXiTBJj0jjipZzudiyQ/rbob9vOQtc8NTocs6FrTwFskwKR7su0XduyoW0WGaQpX9iZvn5sppCPOFu+QAJPu0afLaKM13txqnJdZH5kFMtvDx5Rz1Zp7Em+QAJP+MZodN4ALbvDTbLH5GlfIRe4+lycNu6OlALD0ZgqbFZAtbLFxxvwOP9STmF4znex9bqeQ740lTicqkHzTkIYQZ7vTv4POkkrI3+d/8VkNaBoQT1Ug0qFlJ5uPbn1muDtSEgeSFOhzwwZs2GGdrEBewWd7cEEgzEO2SQF9lBCIpUK2t0SkZRhgsw6ypTlZ3ZjYN8zxmC1AcZUifW4Zk725Mi8ViNP6By1km4bcxzJYrp4J8gInUOamaKmQt+sL5RMWSL5pCIJr/8krXqyQIYNJE4VGDTaHaMBalOmUBZJvGjI/3Clt6k3yBbivU2pYbXM8BDxdyUcpTclZYpbIkG0acvM1eml6sVL6KCYQW4WsjFelAnGc3r2ZbNOQj7ZPq2L6KCcQw93WW97u4TLTFki+oCxTyumjoECs8wtgOWvaAskYlGVIofn5nIICMSg2tMbVfE9EmjOgZE8lki0oy44y67ugpEAsdwzn3J7GFVY/8J7evRm4Xi9F9gfvKCoQc4Vc/A2BGMa+ZaHwymFZgVjU11nnZPICyXdE3YTSK+uFBWIY/W6B8wIhLWTLlGVA/vj2DUoLxOxovwnu07s3A+8rJPv5qC2KC8TunLoBlQrENLDHkIvc52sbKC+Q2b9sVfBpKhVIpWu9ufMzNOJAIBUNkrOmLFMC/6vChT58CKQehcDf6siXjlSGk5uRky6vZQwAd+vDKHW4HV6qeXnpcsOTzErgbYXUtFh4Q8b87d246fI6ourgbIXY1PiyomD47gZ+utz0PJoK+Fojn/ERaqBs+NUajrr8DK3jGbhaJfWspueqP9gHT11+6n+cDE/rBJ/BOxeZ6tf2w1eXW2bFkAA/6+QHPoRvnO01OetyaeytAXCzUmoYZPUpXJwTb13u/C4HL2sFn8IxuypOZsddl9vmcmCBk7XifpDl70yzvy53HRUBH6vF+TJIa72qcjjs8iPHvQgXq8V1GqDuYqyF8Njl//zGLsLDenEc0vNxJR+mH3x2uTRXj5LKkvM2gA/ij2dw0BlO74lez8DVLxDjZGTJeE055nXQcOBzIlJb9uoGXG7GXri98/gdVbvsyPpyj26Dj+KJt3DNIY6nnR7DT8cgEH/z9M/wzCOOBeIxAH4MAnH3CHHdqJ4FMnvvbiJSZWrFTWxLswzl4j3c8olrgfg7qz4Kgbh6hHg5e96Gc4E4u9uNRCCO4t38nK1twbtAnIVm1Zmcdwt8mvI4DL7awL1AZqeeAk9qTa24gbTsVjofT+GPY/wLxFVOp5EIxMcjxE1qny5qEMjsEi1aHm/n3VLxsBfif3h1SxUCmb38jkYtDhyqHnyccnx/CU+cU0uP25bh7g/cqZuz8kEKr+CKe6rp8SMfGQfgTcW8cXCW4Mr35uAqFfW4i9is/70qX/QonfevXNxmPMdebVLTLdG6Jm5fnlxWMn5e4+Wll5xKVZ0ZqGvM8BRNXJyLw+LVJQexf+4mJ1ZlC4GVDao9JQV6erwHr3xz6ubRccs7eFULtc06r30ldPj6zveU5OiLr3DPjw7Kcg6jNoE4rIt/dfjX5Zzk26G77DDu8ibupj6B+Dyu/vnSU1zR6aXH45h+D553UKFA3GbQ/Pr773N4WI5/f387Lfj4Ax7WRZUCme37TS139fnTfqER1/6nz37zt3/0mDaxB3UKxH1Jw7eHf3JOR3/+OXcTrdbMOTytjloFMttz/o245cn58Znt1OT07PjcbRrKe77XsSDeRLUCmc0eofXdc3Hy6vKFdnby/MXlq5Ma6uHMcVSTczAVC2T20s3Gej+uTg4fvjm4Tn+mnF4fvHl4WI8wFjytMTDnjpoF4ryWSCdXTz7M1bJ3Az7MNrc/nGviw5PKRLFCHeeiWqlbIK6O4wYNVHGstovaBeI1y3VwS5Vbg+tUL5BaqhtPkTq3BtcZgUBmp5VN1ifC0wqS+uxmDAK5GWfVO4cdK1f1j67mjEMgFW2KTISatz7WGItAHIbBT5gKw9rbGI9AZntOo1gnx9d6A0u2GZFAZrNvMRUpz9U39MY4GJVAYipSntFMPsDIBOKzsuF0qCnjVT9GJ5DZz5iKlOLrT/TBiBifQGazA5cVpEfP25HsfKwzRoHMZn9jtp6bqwdo+5ExToHMZn9CIjm5qiqd6BDGKpCQSEYujtHmI2S8ApnNHkYkfA4uHqK9R8mYBRISycEntPVIGbdAZrMv6MbAhtpyUQ9m7ALxlRB+bPxGG4+Y8QskJGLFIdp31ExBILPZo5iLqLkY/eBqwTQEMpv98ZvNt0auKk/m05+pCGQ2exExWiq+nqFNJ8B0BDKb7UWkr4KTEYYktjMlgdzgPCl8BRxWnUh0OBMTyGz2Kebr6VyM7TjUbiYnkJv5ekTDp/F2tBGJHUxQILPZfszXh/O00hJRJJMUyGz28neMtIZw8XtiU487JiqQG154Kq/vmycTWtbdZLoCueFRHBnZzcUXtNY0mbRAbmYjv/A1CJo5mebM456JC+SGh/EYaeNq5Gc9+hACmc2uI61vE7/eo30mTQhkzpvYG1nn4yVaZuqEQMDrTxHvu+Tq3Shq30gIgdxz+i6mI6GODUIga0xdIxfnkwrV7UEIZJOf51PdZA91NBACaWCSGnl8hE8frBICaeboMb430yDU0UYIpJXr39NY17p6FRse7YRAOvk79lCUk5EmZZcRAtnFzy9jfZB8/H2Nzxi0EgLpw9/xBaP8+ovPFnQSAunJ3qPxRKN8/BLruX0JgQzg22H9o62rx/HoGEIIZCBHX57iq1YfX9/Fau5QQiAJPH/zubqdxM9vIsQqhRBIKgevapmUfHw1yvqzeQiBMFx/8p754dmnWMqlCIHQvL/84HHu/vHDZeyQ84RANLw+eHeCb2Z5nr07eA2/ApIQiJLrN4dlJyZvH7+JIZWUEIicly8uX53kPnd1dfLq8kU8NvSEQMx4/uLy/Jn1cvDFs/Pjs1jAtSMEYs7p2fH5M3yfZYQwMhECycje0cHxo8OT1K34pyeHj44PjvZgLchBCKQUe/sHBw8e3vDo8IbHT26Z62D+r8e3Lz66/fGDg4P90EQxQiBB0EEIJAg6CIEEQQchkCBoZTb7P0RaNbAjeYjBAAAAAElFTkSuQmCC" alt="koka-logo" data-path="images/koka-logo.png" data-linkid="koka-logo" style="max-height:120px;padding:1rem 1rem 1rem 1.5rem"></a>
</p><span data-line=""></span>
<nav class="toc toc-contents expand-all" style="font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">
<div class="tocblock tocblock1">
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-getting-started" data-toc-depth="1" data-toc-line="[1]{.heading-label}.&#8194;Getting started" style="toctarget:sec-getting-started"><a href="#sec-getting-started" class="localref"><span class="heading-label">1</span>.&#8194;Getting started</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-installing-the-compiler" data-toc-depth="2" data-toc-line="[1.1]{.heading-label}.&#8194;Installing the compiler" style="toctarget:sec-installing-the-compiler"><a href="#sec-installing-the-compiler" class="localref"><span class="heading-label">1.1</span>.&#8194;Installing the compiler</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-running-the-compiler" data-toc-depth="2" data-toc-line="[1.2]{.heading-label}.&#8194;Running the compiler" style="toctarget:sec-running-the-compiler"><a href="#sec-running-the-compiler" class="localref"><span class="heading-label">1.2</span>.&#8194;Running the compiler</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-running-the-interactive-compiler" data-toc-depth="2" data-toc-line="[1.3]{.heading-label}.&#8194;Running the interactive compiler" style="toctarget:sec-running-the-interactive-compiler"><a href="#sec-running-the-interactive-compiler" class="localref"><span class="heading-label">1.3</span>.&#8194;Running the interactive compiler</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-algebraic-effect-handlers" data-toc-depth="2" data-toc-line="[1.4]{.heading-label}.&#8194;Algebraic effect handlers" style="toctarget:sec-algebraic-effect-handlers"><a href="#sec-algebraic-effect-handlers" class="localref"><span class="heading-label">1.4</span>.&#8194;Algebraic effect handlers</a></div></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="tour" data-toc-depth="1" data-toc-line="[2]{.heading-label}.&#8194;A Tour of Koka" style="toctarget:tour"><a href="#tour" class="localref"><span class="heading-label">2</span>.&#8194;A Tour of Koka</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-hello-world" data-toc-depth="2" data-toc-line="[2.1]{.heading-label}.&#8194;Hello world" style="toctarget:sec-hello-world"><a href="#sec-hello-world" class="localref"><span class="heading-label">2.1</span>.&#8194;Hello world</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-dot" data-toc-depth="2" data-toc-line="[2.2]{.heading-label}.&#8194;Dot selection" style="toctarget:sec-dot"><a href="#sec-dot" class="localref"><span class="heading-label">2.2</span>.&#8194;Dot selection</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-types" data-toc-depth="2" data-toc-line="[2.3]{.heading-label}.&#8194;Types" style="toctarget:sec-types"><a href="#sec-types" class="localref"><span class="heading-label">2.3</span>.&#8194;Types</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-anon" data-toc-depth="2" data-toc-line="[2.4]{.heading-label}.&#8194;Anonymous functions" style="toctarget:sec-anon"><a href="#sec-anon" class="localref"><span class="heading-label">2.4</span>.&#8194;Anonymous functions</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-effect-types" data-toc-depth="2" data-toc-line="[2.5]{.heading-label}.&#8194;Effect types" style="toctarget:sec-effect-types"><a href="#sec-effect-types" class="localref"><span class="heading-label">2.5</span>.&#8194;Effect types</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-semantics-of-effects" data-toc-depth="2" data-toc-line="[2.6]{.heading-label}.&#8194;Semantics of effects" style="toctarget:sec-semantics-of-effects"><a href="#sec-semantics-of-effects" class="localref"><span class="heading-label">2.6</span>.&#8194;Semantics of effects</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-combining-effects" data-toc-depth="2" data-toc-line="[2.7]{.heading-label}.&#8194;Combining effects" style="toctarget:sec-combining-effects"><a href="#sec-combining-effects" class="localref"><span class="heading-label">2.7</span>.&#8194;Combining effects</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-polymorphic-effects" data-toc-depth="2" data-toc-line="[2.8]{.heading-label}.&#8194;Polymorphic effects" style="toctarget:sec-polymorphic-effects"><a href="#sec-polymorphic-effects" class="localref"><span class="heading-label">2.8</span>.&#8194;Polymorphic effects</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-runst" data-toc-depth="2" data-toc-line="[2.9]{.heading-label}.&#8194;Isolated state" style="toctarget:sec-runst"><a href="#sec-runst" class="localref"><span class="heading-label">2.9</span>.&#8194;Isolated state</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-a-larger-example--cracking-caesar-encoding" data-toc-depth="2" data-toc-line="[2.10]{.heading-label}.&#8194;A larger example: cracking Caesar encoding" style="toctarget:sec-a-larger-example--cracking-caesar-encoding"><a href="#sec-a-larger-example--cracking-caesar-encoding" class="localref"><span class="heading-label">2.10</span>.&#8194;A larger example: cracking Caesar encoding</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-optional-and-named-parameters" data-toc-depth="2" data-toc-line="[2.11]{.heading-label}.&#8194;Optional and named parameters" style="toctarget:sec-optional-and-named-parameters"><a href="#sec-optional-and-named-parameters" class="localref"><span class="heading-label">2.11</span>.&#8194;Optional and named parameters</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-structs" data-toc-depth="2" data-toc-line="[2.12]{.heading-label}.&#8194;Structs" style="toctarget:sec-structs"><a href="#sec-structs" class="localref"><span class="heading-label">2.12</span>.&#8194;Structs</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-copying" data-toc-depth="2" data-toc-line="[2.13]{.heading-label}.&#8194;Copying" style="toctarget:sec-copying"><a href="#sec-copying" class="localref"><span class="heading-label">2.13</span>.&#8194;Copying</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-more-data-types" data-toc-depth="2" data-toc-line="[2.14]{.heading-label}.&#8194;More data types" style="toctarget:sec-more-data-types"><a href="#sec-more-data-types" class="localref"><span class="heading-label">2.14</span>.&#8194;More data types</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-matching" data-toc-depth="2" data-toc-line="[2.15]{.heading-label}.&#8194;Matching" style="toctarget:sec-matching"><a href="#sec-matching" class="localref"><span class="heading-label">2.15</span>.&#8194;Matching</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-inductive-co-inductive-and-recursive-types" data-toc-depth="2" data-toc-line="[2.16]{.heading-label}.&#8194;Inductive, co-inductive, and recursive types" style="toctarget:sec-inductive-co-inductive-and-recursive-types"><a href="#sec-inductive-co-inductive-and-recursive-types" class="localref"><span class="heading-label">2.16</span>.&#8194;Inductive, co-inductive, and recursive types</a></div></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-koka-language-specification" data-toc-depth="1" data-toc-line="[3]{.heading-label}.&#8194;Koka language specification" style="toctarget:sec-koka-language-specification"><a href="#sec-koka-language-specification" class="localref"><span class="heading-label">3</span>.&#8194;Koka language specification</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-lexical-syntax" data-toc-depth="2" data-toc-line="[3.1]{.heading-label}.&#8194;Lexical syntax" style="toctarget:sec-lexical-syntax"><a href="#sec-lexical-syntax" class="localref"><span class="heading-label">3.1</span>.&#8194;Lexical syntax</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-source-code" data-toc-depth="3" data-toc-line="[3.1.1]{.heading-label}.&#8194;Source code" style="toctarget:sec-source-code"><a href="#sec-source-code" class="localref"><span class="heading-label">3.1.1</span>.&#8194;Source code</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-encoding" data-toc-depth="3" data-toc-line="[3.1.2]{.heading-label}.&#8194;Encoding" style="toctarget:sec-encoding"><a href="#sec-encoding" class="localref"><span class="heading-label">3.1.2</span>.&#8194;Encoding</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-lexical-grammar" data-toc-depth="2" data-toc-line="[3.2]{.heading-label}.&#8194;Lexical grammar" style="toctarget:sec-lexical-grammar"><a href="#sec-lexical-grammar" class="localref"><span class="heading-label">3.2</span>.&#8194;Lexical grammar</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-lexical-tokens" data-toc-depth="3" data-toc-line="[3.2.1]{.heading-label}.&#8194;Lexical tokens" style="toctarget:sec-lexical-tokens"><a href="#sec-lexical-tokens" class="localref"><span class="heading-label">3.2.1</span>.&#8194;Lexical tokens</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-identifiers" data-toc-depth="3" data-toc-line="[3.2.2]{.heading-label}.&#8194;Identifiers" style="toctarget:sec-identifiers"><a href="#sec-identifiers" class="localref"><span class="heading-label">3.2.2</span>.&#8194;Identifiers</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-operators-and-symbols" data-toc-depth="3" data-toc-line="[3.2.3]{.heading-label}.&#8194;Operators and symbols" style="toctarget:sec-operators-and-symbols"><a href="#sec-operators-and-symbols" class="localref"><span class="heading-label">3.2.3</span>.&#8194;Operators and symbols</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-literals" data-toc-depth="3" data-toc-line="[3.2.4]{.heading-label}.&#8194;Literals" style="toctarget:sec-literals"><a href="#sec-literals" class="localref"><span class="heading-label">3.2.4</span>.&#8194;Literals</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-white-space" data-toc-depth="3" data-toc-line="[3.2.5]{.heading-label}.&#8194;White space" style="toctarget:sec-white-space"><a href="#sec-white-space" class="localref"><span class="heading-label">3.2.5</span>.&#8194;White space</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-character-classes" data-toc-depth="3" data-toc-line="[3.2.6]{.heading-label}.&#8194;Character classes" style="toctarget:sec-character-classes"><a href="#sec-character-classes" class="localref"><span class="heading-label">3.2.6</span>.&#8194;Character classes</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec:layout" data-toc-depth="2" data-toc-line="[3.3]{.heading-label}.&#8194;Semicolon insertion" style="toctarget:sec:layout"><a href="#sec:layout" class="localref"><span class="heading-label">3.3</span>.&#8194;Semicolon insertion</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-the-layout-algorithm" data-toc-depth="3" data-toc-line="[3.3.1]{.heading-label}.&#8194;The layout algorithm" style="toctarget:sec-the-layout-algorithm"><a href="#sec-the-layout-algorithm" class="localref"><span class="heading-label">3.3.1</span>.&#8194;The layout algorithm</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec:lex-implementation" data-toc-depth="3" data-toc-line="[3.3.2]{.heading-label}.&#8194;Implementation" style="toctarget:sec:lex-implementation"><a href="#sec:lex-implementation" class="localref"><span class="heading-label">3.3.2</span>.&#8194;Implementation</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-context-free-syntax" data-toc-depth="2" data-toc-line="[3.4]{.heading-label}.&#8194;Context-free syntax" style="toctarget:sec-context-free-syntax"><a href="#sec-context-free-syntax" class="localref"><span class="heading-label">3.4</span>.&#8194;Context-free syntax</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-modules" data-toc-depth="3" data-toc-line="[3.4.1]{.heading-label}.&#8194;Modules" style="toctarget:sec-modules"><a href="#sec-modules" class="localref"><span class="heading-label">3.4.1</span>.&#8194;Modules</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-top-level-declarations" data-toc-depth="3" data-toc-line="[3.4.2]{.heading-label}.&#8194;Top level declarations" style="toctarget:sec-top-level-declarations"><a href="#sec-top-level-declarations" class="localref"><span class="heading-label">3.4.2</span>.&#8194;Top level declarations</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-type-declarations" data-toc-depth="3" data-toc-line="[3.4.3]{.heading-label}.&#8194;Type declarations" style="toctarget:sec-type-declarations"><a href="#sec-type-declarations" class="localref"><span class="heading-label">3.4.3</span>.&#8194;Type declarations</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-value-and-function-declarations" data-toc-depth="3" data-toc-line="[3.4.4]{.heading-label}.&#8194;Value and function declarations" style="toctarget:sec-value-and-function-declarations"><a href="#sec-value-and-function-declarations" class="localref"><span class="heading-label">3.4.4</span>.&#8194;Value and function declarations</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-statements" data-toc-depth="3" data-toc-line="[3.4.5]{.heading-label}.&#8194;Statements" style="toctarget:sec-statements"><a href="#sec-statements" class="localref"><span class="heading-label">3.4.5</span>.&#8194;Statements</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-expressions" data-toc-depth="3" data-toc-line="[3.4.6]{.heading-label}.&#8194;Expressions" style="toctarget:sec-expressions"><a href="#sec-expressions" class="localref"><span class="heading-label">3.4.6</span>.&#8194;Expressions</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-operator-expressions" data-toc-depth="3" data-toc-line="[3.4.7]{.heading-label}.&#8194;Operator expressions" style="toctarget:sec-operator-expressions"><a href="#sec-operator-expressions" class="localref"><span class="heading-label">3.4.7</span>.&#8194;Operator expressions</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-atomic-expressions" data-toc-depth="3" data-toc-line="[3.4.8]{.heading-label}.&#8194;Atomic expressions" style="toctarget:sec-atomic-expressions"><a href="#sec-atomic-expressions" class="localref"><span class="heading-label">3.4.8</span>.&#8194;Atomic expressions</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-matching" data-toc-depth="3" data-toc-line="[3.4.9]{.heading-label}.&#8194;Matching" style="toctarget:sec-matching"><a href="#sec-matching" class="localref"><span class="heading-label">3.4.9</span>.&#8194;Matching</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-operation-clauses" data-toc-depth="3" data-toc-line="[3.4.10]{.heading-label}.&#8194;Operation Clauses" style="toctarget:sec-operation-clauses"><a href="#sec-operation-clauses" class="localref"><span class="heading-label">3.4.10</span>.&#8194;Operation Clauses</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-type-schemes" data-toc-depth="3" data-toc-line="[3.4.11]{.heading-label}.&#8194;Type schemes" style="toctarget:sec-type-schemes"><a href="#sec-type-schemes" class="localref"><span class="heading-label">3.4.11</span>.&#8194;Type schemes</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-types" data-toc-depth="3" data-toc-line="[3.4.12]{.heading-label}.&#8194;Types" style="toctarget:sec-types"><a href="#sec-types" class="localref"><span class="heading-label">3.4.12</span>.&#8194;Types</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-kinds" data-toc-depth="3" data-toc-line="[3.4.13]{.heading-label}.&#8194;Kinds" style="toctarget:sec-kinds"><a href="#sec-kinds" class="localref"><span class="heading-label">3.4.13</span>.&#8194;Kinds</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-implementation" data-toc-depth="3" data-toc-line="[3.4.14]{.heading-label}.&#8194;Implementation" style="toctarget:sec-implementation"><a href="#sec-implementation" class="localref"><span class="heading-label">3.4.14</span>.&#8194;Implementation</a></div></div></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-references" data-toc-depth="1" data-toc-line="References" style="toctarget:sec-references"><a href="#sec-references" class="localref">References</a></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-full-grammar-specification" data-toc-depth="1" data-toc-line="[A]{.heading-label}.&#8194;Full grammar specification" style="toctarget:sec-full-grammar-specification"><a href="#sec-full-grammar-specification" class="localref"><span class="heading-label">A</span>.&#8194;Full grammar specification</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec:full-lexical" data-toc-depth="2" data-toc-line="[A.1]{.heading-label}.&#8194;Lexical syntax" style="toctarget:sec:full-lexical"><a href="#sec:full-lexical" class="localref"><span class="heading-label">A.1</span>.&#8194;Lexical syntax</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec:full-grammar" data-toc-depth="2" data-toc-line="[A.2]{.heading-label}.&#8194;Context-free syntax" style="toctarget:sec:full-grammar"><a href="#sec:full-grammar" class="localref"><span class="heading-label">A.2</span>.&#8194;Context-free syntax</a></div></div></div></nav></div>
<div class="mainpanel">

<div class="maincontent">
<h1 id="sec-getting-started" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-getting-started" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">1</span>.&#8194;</span>Getting started</h1>
<p class="p noindent">Welcome to Koka. This manual provides an overview and formal specification of the language.
For more background information, see:
</p>
<ul class="ul list-star compact">
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">The&nbsp;<a href="https://koka-lang.github.io/koka/doc/toc.html" data-linkid="libraries" target="_top">library documentation</a>.
</li>
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">The&nbsp;<a href="https://github.com/koka-lang/koka" data-linkid="kokarepo" target="_top">github repository</a>.
</li>
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">The article <em class="em-low1">Algebraic Effects for Functional Programming</em>&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#leijen:algeff" title="Algebraic Effects for Functional Programming
Leijen, 2016" class="bibref localref" style="target-element:bibitem"><span class="cite-number">2</span></a>]</span> about the algebraic effect handlers in Koka.
</li>
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">An article about the type system and semantics of Koka&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#leijen:msfp" title="Koka: Programming with Row Polymorphic Effect Types
Leijen, 2014" class="bibref localref" style="target-element:bibitem"><span class="cite-number">1</span></a>]</span>.
</li></ul>
<h2 id="sec-installing-the-compiler" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-installing-the-compiler" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">1.1</span>.&#8194;</span>Installing the compiler</h2>
<p class="p noindent">For Linux and macOS on x86 64-bit, you can install Koka using:
</p>
<pre class="para-block pre-fenced pre-fenced4" style="display:block"><code>&gt; curl -sSL https://github.com/koka-lang/koka/releases/latest/download/install.sh | sh</code></pre>
<p class="p noindent para-continued">After installation, verify if Koka installed correctly:
</p>
<pre class="para-block pre-fenced pre-fenced4" style="display:block"><code>&gt; koka
 _          _           ____
| |        | |         |__  \
| | __ ___ | | __ __ _  __) |
| |/ // _ \| |/ // _` || ___/ welcome to the koka interpreter
|   &lt;| (_) |   &lt;| (_| ||____| version 2.0.10, Nov 28 2020, libc 64-bit (gcc)
|_|\_\\___/|_|\_\\__,_|       type :? for help

loading: std/core
loading: std/core/types
loading: std/core/hnd</code></pre>
<p class="p noindent para-continued">Type <code class="code code2">:q</code> to exit the interpreter.
</p>
<p class="p indent">For detailed instructions and other platforms (including Windows) see the&nbsp;<a href="https://github.com/koka-lang/koka/releases" data-linkid="releases">releases</a> page.
It is also straightforward to build the compiler&nbsp;<a href="https://github.com/koka-lang/koka/#build-from-source" data-linkid="build">from source</a>.
</p><h2 id="sec-running-the-compiler" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-running-the-compiler" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">1.2</span>.&#8194;</span>Running the compiler</h2>
<p class="p noindent">You can compile a Koka source using <code class="koka"><span class="op"><span class="minus">-</span></span>c</code> (note that all&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples"><code class="koka">samples</code></a> are pre-installed):
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; koka -c samples/basic/caesar.kk</code></strong></span>
compile: samples/basic/caesar.kk
loading: std/core
loading: std/core/types
loading: std/core/hnd
loading: std/num/double
loading: std/text/parse
loading: std/num/int32
check  : samples/basic/caesar
linking: samples_basic_caesar
created: out/v2.0.9/gcc-debug/samples_basic_caesar</code></pre>
<p class="p noindent para-continued">and run the resulting executable:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; out/v2.0.9/gcc-debug/samples_basic_caesar</code></strong></span>
plain  : Koka is a well-typed language
encoded: Krnd lv d zhoo-wbshg odqjxdjh
cracked: Koka is a well-typed language</code></pre>
<p class="p noindent para-continued">The <code class="code code2">-O2</code> flag builds an optimized program. Let&#39;s try it on a purely functional implementation
of balanced insertion in a red-black tree (<a href="https://github.com/koka-lang/koka/tree/master/samples/basic/rbtree.kk"><code class="koka">rbtree<span class="kw op">.</span>kk</code></a>:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; koka -O2 -c samples/basic/rbtree.kk</code></strong></span>
...
linking: samples_basic_rbtree
created: out/v2.0.10/gcc-drelease/samples_basic_rbtree

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; time out/v2.0.10/gcc-drelease/samples_basic_rbtree</code></strong></span>
420000
real    0m0.750s
...</code></pre>
<p class="p noindent para-continued">We can compare this against an in-place updating C++ implementation using <code class="code code2">stl::map</code>
(<a href="https://github.com/koka-lang/koka/tree/master/samples/basic/rbtree.cpp"><code class="code code2">rbtree.cpp</code></a>) (which also uses a
<a href="https://code.woboq.org/gcc/libstdc++-v3/src/c++98/tree.cc.html">red-black tree</a> internally):
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; clang++ --std=c++17 -o cpp-rbtree -O3 samples/basic/rbtree.cpp</code></strong></span>
<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; time ./cpp-rbtree</code></strong></span>
420000
real    0m0.864s
...</code></pre>
<p class="p noindent para-continued">The excellent performance relative to C++ here (on an AMD 3600XT) is the result of Perceus automatically
transforming the fast path of the pure functional rebalancing to use mostly in-place updates,
closely mimicking the imperative rebalancing code of the hand optimized C++ library.
</p><h2 id="sec-running-the-interactive-compiler" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-running-the-interactive-compiler" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">1.3</span>.&#8194;</span>Running the interactive compiler</h2>
<p class="p noindent">Without giving any input files, the interactive interpreter runs by default:
</p>
<pre class="para-block pre-fenced pre-fenced4" style="display:block"><code>&gt; koka
 _          _           ____
| |        | |         |__  \
| | __ ___ | | __ __ _  __) |
| |/ // _ \| |/ // _` || ___/ welcome to the koka interpreter
|   &lt;| (_) |   &lt;| (_| ||____| version 2.0.9, Nov 27 2020, libc 64-bit (gcc)
|_|\_\\___/|_|\_\\__,_|       type :? for help

loading: std/core
loading: std/core/types
loading: std/core/hnd
&gt;</code></pre>
<p class="p noindent para-continued">Now you can test some expressions:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; println(&quot;hi koka&quot;)</code></strong></span>
check  : interactive
check  : interactive
linking: interactive
created: out\v2.0.9\mingw-debug\interactive

hi koka

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :t &quot;hi&quot;</code></strong></span>
string

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :t println(&quot;hi&quot;)</code></strong></span>
console ()</code></pre>
<p class="p noindent para-continued">Or load a demo (use <code class="code code2">tab</code> completion to avoid typing too much):
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :l samples/basic/fibonacci</code></strong></span>
compile: samples/basic/fibonacci.kk
loading: std/core
loading: std/core/types
loading: std/core/hnd
check  : samples/basic/fibonacci
modules:
  samples/basic/fibonacci

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; main()</code></strong></span>
check  : interactive
check  : interactive
linking: interactive
created: out\v2.0.9\mingw-debug\interactive

The 10000th fibonacci number is 33644764876431783266621612005107543310302148460680063906564769974680081442166662368155595513633734025582065332680836159373734790483865268263040892463056431887354544369559827491606602099884183933864652731300088830269235673613135117579297437854413752130520504347701602264758318906527890855154366159582987279682987510631200575428783453215515103870818298969791613127856265033195487140214287532698187962046936097879900350962302291026368131493195275630227837628441540360584402572114334961180023091208287046088923962328835461505776583271252546093591128203925285393434620904245248929403901706233888991085841065183173360437470737908552631764325733993712871937587746897479926305837065742830161637408969178426378624212835258112820516370298089332099905707920064367426202389783111470054074998459250360633560933883831923386783056136435351892133279732908133732642652633989763922723407882928177953580570993691049175470808931841056146322338217465637321248226383092103297701648054726243842374862411453093812206564914032751086643394517512161526545361333111314042436854805106765843493523836959653428071768775328348234345557366719731392746273629108210679280784718035329131176778924659089938635459327894523777674406192240337638674004021330343297496902028328145933418826817683893072003634795623117103101291953169794607632737589253530772552375943788434504067715555779056450443016640119462580972216729758615026968443146952034614932291105970676243268515992834709891284706740862008587135016260312071903172086094081298321581077282076353186624611278245537208532365305775956430072517744315051539600905168603220349163222640885248852433158051534849622434848299380905070483482449327453732624567755879089187190803662058009594743150052402532709746995318770724376825907419939632265984147498193609285223945039707165443156421328157688908058783183404917434556270520223564846495196112460268313970975069382648706613264507665074611512677522748621598642530711298441182622661057163515069260029861704945425047491378115154139941550671256271197133252763631939606902895650288268608362241082050562430701794976171121233066073310059947366875</code></pre>
<p class="p noindent para-continued">And quit the interpreter:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :q</code></strong></span>

I think of my body as a side effect of my mind.
  -- Carrie Fisher (1956)</code></pre>
<p class="p noindent para-continued">The&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples/syntax"><code class="code code2">samples/syntax</code></a>
and&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples/basic"><code class="code code2">samples/basic</code></a> 
directories contain various basic Koka examples to start with. If you type:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :l samples/</code></strong></span></code></pre>
<p class="p noindent para-continued">in the interpreter, you can <code class="code code2">tab</code> twice to see the available sample files and directories.
Use <code class="code code2">:s</code> to see the source of a loaded module.
</p><h2 id="sec-algebraic-effect-handlers" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-algebraic-effect-handlers" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">1.4</span>.&#8194;</span>Algebraic effect handlers</h2>
<p class="p noindent">A novel feature of Koka is a compiled and typed implementation of algebraic
effect handlers (described in detail in&nbsp;<a href="#references" class="localref">[3]</a>).
In the interactive environment, you can load various demo files with algebraic
effects which are located in the&nbsp;<a href="https://github.com/koka-lang/koka/tree/master/samples/handlers"><code class="code code2">samples/handlers</code></a> directory.
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :f samples/handlers/basic</code></strong></span></code></pre>
<p class="p noindent para-continued">where <code class="code code2">:f</code> forces a recompile (versus <code class="code code2">:l</code> which avoids a recompile if possible).
Use the <code class="code code2">:?</code> command to get an overview of all commands. After
loading the <code class="code code2">common</code> demo, we can run it directly from the interpreter:
</p>
<pre class="para-block pre-indented" style="display:block"><code><span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :f samples/handlers/basic</code></strong></span>
compile: samples/handlers/basic.kk
...
check  : samples/handlers/basic
modules:
  samples/handlers/basic

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; :t test2    </code></strong></span>
() -&gt; console ()

<span class="code-escaped"><strong class="strong-star2"><code class="code code2">&gt; test2()</code></strong></span>
check  : interactive
check  : interactive
linking: interactive
created: out\v2.0.5\mingw-debug\interactive

Hello there, there</code></pre>
<p class="p noindent para-continued">Some interesting demos are:
</p>
<ul class="ul list-star loose">
<li class="li ul-li list-star-li loose-li" style="margin-bottom:1ex">
<p><code class="code code2">basic.kk</code>: Various examples from the paper &#8220;<em class="em-low1">Algebraic Effects for
Functional Programming</em>&#8221;&nbsp;<a href="#references" class="localref">[3]</a>. Shows how to implement
common control-flow abstractions like exceptions, state, iterators,
ambiguity, and asynchronous programming.
</p></li>
<li class="li ul-li list-star-li loose-li" style="margin-bottom:1ex">
<p><code class="code code2">nim.kk</code>: Various examples from the paper &#8220;<em class="em-low1">Liberating effects with
rows and handlers</em>&#8221;&nbsp;<a href="#references" class="localref">[1]</a>.
</p></li>
<li class="li ul-li list-star-li loose-li" style="margin-bottom:1ex">
<p><code class="code code2">scoped.kk</code>: Examples from the paper &#8220;<em class="em-low1">Effect Handlers in Scope</em>&#8221;&nbsp;<a href="#references" class="localref">[5]</a>.
</p></li></ul>
<h1 id="tour" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#tour" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2</span>.&#8194;</span>A Tour of Koka</h1>
<p class="p noindent">This is a short introduction to the Koka programming language meant for
programmers familiar with languages like C++, C#, or JavaScript.
</p>
<p class="p indent">Koka is a <em class="em-low1">function-oriented</em> language that separates pure values from
side-effecting computations (The word &#8216;k&#333;ka&#8217; (or &#x52B9;&#x679C;) means
&#8220;effect&#8221; or &#8220;effective&#8221; in Japanese). Koka is also
flexible and <code class="koka"><span class="kw">fun</span></code>: Koka has many features that help programmers to easily
change their data types and code organization correctly even in large-scale
programs, while having a small strongly-typed language core with a familiar
JavaScript like syntax.
</p><h2 id="sec-hello-world" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-hello-world" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.1</span>.&#8194;</span>Hello world</h2>
<p class="p noindent">As usual, we start with the familiar <em class="em-low1">Hello world</em> program:<span id=`examplemain`></span>
</p><pre class="koka source"><span class="plaincode">fun main() {
  println("Hello world!") // println output
}
</span><span class="nicecode"><span class="decl-fun" id="main"><span class="kw">fun</span> <a class="pp" href="#main">main<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>main: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"Hello world!"</span>) <span class="comment">// println output
</span></span>}
</span></pre>


<p class="p noindent">Koka uses familiar curly-braces syntax where <code class="koka"></code> starts a line
comment. Functions are declared using the <code class="koka"><span class="kw">fun</span></code> keyword (and anonymous functions with <code class="koka"><span class="kw">fn</span></code>).
</p>
<p class="p indent">Here is another short example program that encodes a string using the
<em class="em-low1">Caesar cipher</em>, where each lower-case letter in a string is replaced by the letter
three places up in the alphabet:
</p><pre class="koka source"><span class="plaincode">fun main() { println(caesar("koka is fun")) }

fun encode( s : string, shift : int )
{
  fun encode-char(c) {
    if (c &lt; 'a' || c &gt; 'z') return c
    val base = (c - 'a').int
    val rot  = (base + shift) % 26
    (rot.char + 'a')
  }
  s.map(encode-char)
}

fun caesar( s : string ) : string {
  s.encode( 3 )
}
</span><span class="nicecode"><span class="decl-fun" id="encode"><span class="kw">fun</span> <a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> )
{
  <span class="decl-fun" id="encode_char"><span class="kw">fun</span> <a class="pp">encode-char<span class="pc">encode<span class="dash">-</span>char: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">char</span></span></a>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>) {
    <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">'a'</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_gt_">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">'z'</span>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">char</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>
    <span class="kw">val</span> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash__4">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.4</span>: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">char</span></span></a> <span class="st">'a'</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#int">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <span class="kw">val</span> <a class="pp">rot<span class="pc">rot: <span class="tp">int</span></span></a>  <span class="kw">=</span> (<a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">26</span>
    (<a class="pp">rot<span class="pc">rot: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#char">char<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>char: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__5">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.5</span>: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">char</span></span></a> <span class="st">'a'</span>)
  </span>}
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_6">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.6</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">string</span></span></a>(<a class="pp">encode-char<span class="pc">encode<span class="dash">-</span>char: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">char</span></span></a>)
</span>}

<span class="decl-fun" id="caesar"><span class="kw">fun</span> <a class="pp" href="#caesar">caesar<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>caesar: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <span class="number">3</span> )
</span>}
</span></pre>



<p class="p noindent">In this example, we declare a local function <code class="koka">encode<span class="dash">-</span>char</code> which encodes a
single character <code class="koka">c</code>. The final statement <code class="koka">s<span class="kw op">.</span>map(encode<span class="dash">-</span>char)</code> applies the
<code class="koka">encode<span class="dash">-</span>char</code> function to each character in the string <code class="koka">s</code>, returning a
new string where each character is Caesar encoded. The result of the final
statement in a function is also the return value of that function, and you can
generally leave out an explicit <code class="koka"><span class="kw">return</span></code> keyword.
Similarly, Koka&#39;s grammar is constructed in such a way that no semi-colons
are needed to separate statements.
</p><h2 id="sec-dot" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-dot" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.2</span>.&#8194;</span>Dot selection</h2>
<p class="p noindent">Koka is a <em class="em-low1">function-oriented</em> language where <em class="em-low1">functions</em> and <em class="em-low1">data</em> form the
core of the language (in contrast to objects for example). In particular, the
expression <code class="koka">s<span class="kw op">.</span><a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a>(<span class="number">3</span>)</code> does <em class="em-low1">not</em> select the <code class="koka"><a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a></code> method from the
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a></code> object, but it is simply syntactic sugar for the function call
<code class="koka"><a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a>(s,<span class="number">3</span>)</code> where <code class="koka">s</code> becomes the first argument. Similarly, <code class="koka">c<span class="kw op">.</span>int</code>
converts a character to an integer by calling <code class="koka">int(c)</code> (and both expressions
are equivalent). The dot notation is intu&#239;tive and quite convenient to
chain multiple calls together, as in:
</p><pre class="koka source"><span class="plaincode">fun showit( s : string ) { s.encode(3).count.println }
</span><span class="nicecode"><span class="decl-fun" id="showit"><span class="kw">fun</span> <a class="pp" href="#showit">showit<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>showit: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) { <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<span class="number">3</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#count_1">count<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println_1">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> </span>}
</span></pre>



<p class="p noindent">for example (where the body desugars as <code class="koka">println(length(<a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a>(s,<span class="number">3</span>)))</code>). An
advantage of the dot notation as syntactic sugar for function calls is that it
is easy to extend the &#8216;primitive&#8217; methods of any data type: just write a new
function that takes that type as its first argument. In most object-oriented
languages one would need to add that method to the class definition itself
which is not always possible if such class came as a library for example.
</p><h2 id="sec-types" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-types" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.3</span>.&#8194;</span>Types</h2>
<p class="p noindent">Koka is also strongly typed. It uses a powerful type inference engine to
infer most types, and types generally do not get in the way. In
particular, you can always leave out the types of any local variables.
This is the case for example for <code class="code code2">base</code> and <code class="code code2">rot</code> values in the
previous example; hover with the mouse over the example to see the types
that were inferred by Koka. Generally, it is good practice though to
write type annotations for function parameters and the function result
since it both helps with type inference, and it provides useful
documentation with better feedback from the compiler.
</p>
<p class="p indent">For the <code class="koka"><a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a></code> function it is actually essential to give the type of
the <code class="koka">s</code> parameter: since the <code class="koka">map</code> function is defined for both <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">V</span></span></a></code>
and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a></code> types and the program is ambiguous without an annotation.
Try to load the example in the editor and remove the annotation to see
what error Koka produces.
</p><h2 id="sec-anon" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-anon" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.4</span>.&#8194;</span>Anonymous functions</h2>
<p class="p noindent">Koka also allows for anonymous function expressions using the <code class="koka"><span class="kw">fn</span></code> keyword.
For example, instead of
declaring the <code class="koka">encode<span class="dash">-</span>char</code> function, we could just have passed it directly to
the <code class="koka">map</code> function as a function expression:
</p><pre class="koka source"><span class="plaincode">fun encode2( s : string, shift : int )
{
  s.map( fn(c) {
    if (c &lt; 'a' || c &gt; 'z') return c
    val base = (c - 'a').int
    val rot  = (base + shift) % 26
    (rot.char + 'a')
  });
}
</span><span class="nicecode"><span class="decl-fun" id="encode2"><span class="kw">fun</span> <a class="pp" href="#encode2">encode2<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode2: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> )
{
  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_6">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.6</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">string</span></span></a>( <span class="kw">fn</span>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>) {
    <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt_">&lt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">'a'</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_gt_">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;): <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">,</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="st">'z'</span>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">char</span></span></a> <a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>
    <span class="kw">val</span> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <span class="kw">=</span> (<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash__4">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.4</span>: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">char</span></span></a> <span class="st">'a'</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#int">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp sp">(</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <span class="kw">val</span> <a class="pp">rot<span class="pc">rot: <span class="tp">int</span></span></a>  <span class="kw">=</span> (<a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_perc_">%<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(%): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">26</span>
    (<a class="pp">rot<span class="pc">rot: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#char">char<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>char: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">char</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__5">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.5</span>: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">char</span></span></a> <span class="st">'a'</span>)
  });
</span>}
</span></pre>



<p class="p noindent">It is a bit annoying we had to put the final right-parenthesis after the last
brace. As a convenience, Koka allows anonymous functions to <em class="em-low1">follow</em>
the function call instead. For example, here is how we can print the numbers
<code class="code code2">1</code> to <code class="code code2">10</code>:
</p><pre class="koka source"><span class="plaincode">fun main() { print10() }

fun print10()
{
  for(1,10) fn(i) {
    println(i)
  }
}
</span><span class="nicecode"><span class="decl-fun" id="print10"><span class="kw">fun</span> <a class="pp" href="#print10">print10<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>print10: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>for: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="number">1</span>,<span class="number">10</span>) <span class="kw">fn</span>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println_1">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>)
  }
</span>}
</span></pre>



<p class="p noindent">which is desugared to <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>for: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <span class="number">1</span>, <span class="number">10</span>, <span class="kw">fn</span>(i){ println(i) } )</code>. In fact, since we
pass the <code class="koka">i</code> argument directly to <code class="koka">println</code>, we can also the function itself
directly, and write <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#for">for<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>for: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">end</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="number">1</span>,<span class="number">10</span>,println)</code>.
</p>
<p class="p indent">Anonymous functions without any arguments can be shortened further by leaving
out the <code class="koka"><span class="kw">fn</span></code> keyword and just using braces directly. Here is an example using
the <code class="koka">repeat</code> function:
</p><pre class="koka source"><span class="plaincode">fun main() { printhi10() }

fun printhi10()
{
  repeat(10) {
    println("hi")
  }
}
</span><span class="nicecode"><span class="decl-fun" id="printhi10"><span class="kw">fun</span> <a class="pp" href="#printhi10">printhi10<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>printhi10: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#repeat_1">repeat<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>repeat<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="number">10</span>) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"hi"</span>)
  }
</span>}
</span></pre>



<p class="p noindent">where the body desugars to <code class="koka">repeat( <span class="number">10</span>, <span class="kw">fn</span>(){println(</code><code class="koka">hi</code><code class="koka">)} )</code>. The is
especially convenient for the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> loop since this is not a built-in
operator in Koka but just a regular function:
</p><pre class="koka source"><span class="plaincode">fun main() { print11() }

fun print11() {
  var i := 10
  while { i &gt;= 0 } {
    println(i)
    i := i - 1
  }
}
</span><span class="nicecode"><span class="decl-fun" id="print11"><span class="kw">fun</span> <a class="pp" href="#print11">print11<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>print11: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">console</span><span class="tp sp">,</span><span class="tp">div</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1851</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">:=</span> <span class="number">10</span>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> { <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_get">i<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_gt__eq__1">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span> } {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println_1">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_get">i<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a>)
    <a class="pp">i<span class="pc">i: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1851</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_get">i<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>
  }
</span>}
</span></pre>



<p class="p noindent">Note how the first argument to <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> is in braces instead of the usual
parenthesis: Koka makes it always explicit whether code is evaluated
before a function is called (in between parenthesis), or whether
code is evaluated (potentially
multiple times) by the called function instead (in between braces).
</p><h2 id="sec-effect-types" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-effect-types" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.5</span>.&#8194;</span>Effect types</h2>
<p class="p noindent">A novel part about Koka is that it automatically infers all the <em class="em-low1">side effects</em>
that occur in a function. The absence of any effect is denoted as <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> (or
<code class="koka"><span class="op">&#60;</span><span class="op">&#62;</span></code>) and corresponds to pure mathematical functions. If a function can raise
an exception the effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a></code>, and if a function may not terminate the
effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code> (for divergence). The combination of <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a></code> and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code> is
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a></code> and corresponds directly to Haskell&#39;s notion of purity. Non-
deterministic functions get the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a></code> effect. The &#8216;worst&#8217; effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a></code>
and means that a program can raise exceptions, not terminate, be non-
deterministic, read and write to the heap, and do any input/output operations.
Here are some examples of effectful functions:
</p><pre class="koka source"><span class="plaincode">fun square1( x : int ) : total int
{
  return x&#42;x
}

fun square2( x : int ) : io int
{
  println( "a not so secret side-effect" )
  return x&#42;x
}

fun square3( x : int ) : div int
{
  square3( x )
  return x&#42;x
}

fun square4( x : int ) : exn int
{
  throw( "oops" )
  return x&#42;x
}
</span><span class="nicecode"><span class="decl-fun" id="square1"><span class="kw">fun</span> <a class="pp" href="#square1">square1<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>square1: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp"><span class="effect">total</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
{
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}

<span class="decl-fun" id="square2"><span class="kw">fun</span> <a class="pp" href="#square2">square2<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>square2: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <span class="st">"a not so secret side-effect"</span> )
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}

<span class="decl-fun" id="square3"><span class="kw">fun</span> <a class="pp" href="#square3">square3<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>square3: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
{
  <a class="pp" href="#square3">square3<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>square3: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> )
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}

<span class="decl-fun" id="square4"><span class="kw">fun</span> <a class="pp" href="#square4">square4<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>square4: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#throw">throw<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>throw: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">info</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">exception<span class="dash">-</span>info</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">exn</span> <span class="tp tv">a</span></span></a>( <span class="st">"oops"</span> )
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}
</span></pre>



<p class="p noindent">When the effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> we usually leave it out in the type annotation.
For example, when we write:
</p><pre class="koka source"><span class="plaincode">fun square5( x : int ) : int { x&#42;x }
</span><span class="nicecode"><span class="decl-fun" id="square5"><span class="kw">fun</span> <a class="pp" href="#square5">square5<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>square5: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> { <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> </span>}
</span></pre>



<p class="p noindent">Then the assumed effect is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code>. Sometimes, we write an effectful
function, but are not interested in explicitly writing down its effect type.
In that case, we can use a <em class="em-low1">wildcard type</em> which stands for some inferred
type. A wildcard type is denoted by writing an identifier prefixed with an
underscore, or even just an underscore by itself:
</p><pre class="koka source"><span class="plaincode">fun square6( x : int ) : &#95;e int
{
  println("I did not want to write down the io effect")
  return x&#42;x
}
</span><span class="nicecode"><span class="decl-fun" id="square6"><span class="kw">fun</span> <a class="pp" href="#square6">square6<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>square6: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp"><span class="tp tv"><span class="effect">&#95;e</span></span><span class="pc">&#95;e: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"I did not want to write down the io effect"</span>)
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}
</span></pre>



<p class="p noindent">Hover over <code class="koka"><a class="pp" href="#square6">square6<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>square6: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">console</span> <span class="tp">int</span></span></a></code> to see the inferred effect for <code class="koka"><span class="tp tv">&#95;e</span></code>
</p><h2 id="sec-semantics-of-effects" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-semantics-of-effects" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.6</span>.&#8194;</span>Semantics of effects</h2>
<p class="p noindent">The inferred effects are not just considered as some extra type information on
functions. On the contrary, through the inference of effects, Koka has a very
strong connection to its denotational semantics. In particular, <em class="em-low1">the full type
of a Koka functions corresponds directly to the type signature of the
mathematical function that describes its denotational semantics</em>. For example,
using &#x301A;<code class="koka"><span class="tp tv">t</span></code>&#x301B; to translate a type <code class="koka"><span class="tp tv">t</span></code> into its corresponding
mathematical type signature, we have:
</p><table class="madoko block">
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1"></td><td class="tbody tr-even col cell-line col-even" data-row="0" data-col="2"></td><td class="tbody tr-even col cell-line col-odd col-last" data-row="0" data-col="3"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1">&#x301A;<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#x301B;        </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> =&#160;&#160; </td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="3"> &#8484;<sub>32</sub> &#8594; &#8484;<sub>32</sub>                                             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">&#x301A;<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#x301B;          </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> =             </td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="3"> &#8484;<sub>32</sub> &#8594; (1 + &#8484;<sub>32</sub>)                                       </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">&#x301A;<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#x301B;         </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> =             </td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="3"> &#8484;<sub>32</sub> &#8594; (1 + &#8484;<sub>32</sub>)<sub>&#8869;</sub>                              </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="4" data-col="1">&#x301A;<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a><span class="tp sp">&#62;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>&#x301B; </td><td class="tbody tr-even tr-last col col-even" data-row="4" data-col="2"> =             </td><td class="tbody tr-even tr-last col col-odd col-last" data-row="4" data-col="3"> (<em class="em-low1">Heap</em> &#215; &#8484;<sub>32</sub>) &#8594; (<em class="em-low1">Heap</em> &#215; (1 + &#8484;<sub>32</sub>))<sub>&#8869;</sub></td></tr></tbody></table>
<p class="p noindent">In the above translation, we use <em class="em-low1">1 + t</em> as a sum
where we have either a unit 1 (i.e. exception) or a type <em class="em-low1">t</em>, and we use
<em class="em-low1">Heap &#215; t</em> for a product consisting of a pair of a
heap and a type <em class="em-low1">t</em>. From the above correspondence, we can immediately see that
a <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> function is truly total in the mathematical sense, while a stateful
function (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>) that can raise exceptions or not terminate (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a></code>)
takes an implicit heap parameter, and either does not terminate (&#8869;) or
returns an updated heap together with either a value or an exception (<code class="koka"><span class="number">1</span></code>).
</p>
<p class="p indent">We believe that this semantic correspondence is the true power of full effect
types and it enables effective equational reasoning about the code by a
programmer. For almost all other existing programming languages, even the most
basic semantics immediately include complex effects like heap manipulation and
divergence. In contrast, Koka allows a layered semantics where we can easily
separate out nicely behaved parts, which is essential for many domains, like
safe LINQ queries, parallel tasks, tier-splitting, sand-boxed mobile code,
etc.
</p><h2 id="sec-combining-effects" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-combining-effects" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.7</span>.&#8194;</span>Combining effects</h2>
<p class="p noindent">Often, a function contains multiple effects, for example:
</p><pre class="koka source unchecked"><span class="plaincode">fun combine-effects()
{
  val i = srandom-int() // non-deterministic
  error("hi")           // exception raising
  combine-effects()     // and non-terminating
}
</span><span class="nicecode"><span class="kw">fun</span> combine<span class="dash">-</span>effects()
{
  <span class="kw">val</span> i <span class="kw">=</span> srandom<span class="dash">-</span>int() <span class="comment">// non-deterministic
</span>  error(<span class="st">"hi"</span>)           <span class="comment">// exception raising
</span>  combine<span class="dash">-</span>effects()     <span class="comment">// and non-terminating
</span>}
</span></pre>



<p class="p noindent">The effect assigned to <code class="koka">combine<span class="dash">-</span>effects</code> are <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a></code>, <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code>, and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a></code>. We
can write such combination as a <em class="em-low1">row</em> of effects as <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp sp">&#62;</span></code>. When
you hover over the <code class="koka">combine<span class="dash">-</span>effects</code> identifiers, you will see that the type
inferred is really <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp sp">&#62;</span></code> where <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a></code> is a type alias defined as
</p><pre class="koka source unchecked"><span class="plaincode">alias pure = &lt;div,exn&gt;
</span><span class="nicecode"><span class="tp kw">alias</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_pure"><span class="tp">pure</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pure: <span class="tp">E</span></span></a> <span class="tp kw">=</span> <span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span>
</span></pre>


<h2 id="sec-polymorphic-effects" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-polymorphic-effects" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.8</span>.&#8194;</span>Polymorphic effects</h2>
<p class="p noindent">Many functions are polymorphic in their effect. For example, the
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">b</span><span class="tp sp">&#62;</span></span></a></code> function
applies a function <code class="koka">f</code> to each element of a (finite) list. As such, the effect
depends on the effect of <code class="koka">f</code>, and the type of <code class="koka">map</code> becomes:
</p><pre class="koka source unchecked"><span class="plaincode">map : (xs : list&lt;a&gt;, f : (a) -&gt; e b) -&gt; e list&lt;b&gt;
</span><span class="nicecode">map <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span>
</span></pre>



<p class="p noindent">We use single letters (possibly followed by digits) for polymorphic types.
Here, the <code class="koka">map</code> functions takes a list with elements of some type <code class="koka"><span class="tp tv">a</span></code>, and a
function <code class="code code2">f</code> that takes an element of type <code class="koka"><span class="tp tv">a</span></code> and returns a new element of
type <code class="koka"><span class="tp tv">b</span></code>. The final result is a list with elements of type <code class="koka"><span class="tp tv">b</span></code>. Moreover,
the effect of the applied function <code class="koka"><span class="tp tv">e</span></code> is also the effect of the <code class="koka">map</code>
function itself; indeed, this function has no other effect by itself since it
does not diverge, nor raises exceptions.
</p>
<p class="p indent">We can use the notation <code class="koka"><span class="tp sp">&#60;</span><span class="tp tv">l</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span></code> to extend an effect <code class="koka"><span class="tp tv">e</span></code> with another effect
<code class="koka"><span class="tp tv">l</span></code>. This is used for example in the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> function which has type:
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <span class="tp kw op">:</span> <span class="tp sp">(</span> <span class="tp tpp">pred</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></code>.
The <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> function takes a
predicate function and an action to perform, both with effect <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span></code>.
Indeed, since while may diverge depending on the predicate its effect must
include divergence.
</p>
<p class="p indent">The reader may be worried that the type of <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code> forces the predicate and
action to have exactly the same effect <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span></code>, which even includes
divergence. However, when effects are inferred at the call-site, both the
effects of predicate and action are extended automatically until they match.
This ensures we take the union of the effects in the predicate and action.
Take for example the following loop
</p><pre class="koka source"><span class="plaincode">import std/num/random
fun main() { looptest() }

fun looptest()
{
  while { is-odd(srandom-int()) }
  {
    throw("odd")
  }
}
</span><span class="nicecode"><span class="kw">fun</span> looptest()
{
  while { is<span class="dash">-</span>odd(srandom<span class="dash">-</span>int()) }
  {
    throw(<span class="st">"odd"</span>)
  }
}
</span></pre>



<p class="p noindent">In the above program, Koka infers that the predicate <code class="code code2">odd(srandom-int())</code> has
effect <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e1</span><span class="tp sp">&#62;</span></code> while the action has effect <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp kw op">|</span><span class="tp tv">e2</span><span class="tp sp">&#62;</span></code> for some <code class="koka"><span class="tp tv">e1</span></code> and <code class="koka"><span class="tp tv">e2</span></code>.
When applying <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#while">while<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>while: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">predicate</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp">bool</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">div</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a></code>, those
effects are unified to the type <code class="koka"><span class="tp sp">&#60;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a><span class="tp kw op">|</span><span class="tp tv">e3</span><span class="tp sp">&#62;</span></code> for some <code class="koka"><span class="tp tv">e3</span></code> (which can
be seen by hovering over the <code class="koka">looptest</code> identifier)
</p><h2 id="sec-runst" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-runst" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.9</span>.&#8194;</span>Isolated state</h2>
<p class="p noindent">The Fibonacci numbers are a sequence where each subsequent Fibonacci number is
the sum of the previous two, where <code class="koka"><a class="pp" href="#fib">fib<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<span class="number">0</span>) <span class="op">==</span> <span class="number">0</span></code> and <code class="koka"><a class="pp" href="#fib">fib<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<span class="number">1</span>) <span class="op">==</span> <span class="number">1</span></code>. We can
easily calculate Fibonacci numbers using a recursive function:
</p><pre class="koka source"><span class="plaincode">fun main() { println(fib(10)) }

fun fib(n : int) : div int
{
  if (n &lt;= 0)   then 0
  elif (n == 1) then 1
  else fib(n - 1) + fib(n - 2)
}
</span><span class="nicecode"><span class="decl-fun" id="fib"><span class="kw">fun</span> <a class="pp" href="#fib">fib<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp"><span class="effect">div</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>
{
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>)   <span class="kw">then</span> <span class="number">0</span>
  <span class="kw">elif</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">1</span>) <span class="kw">then</span> <span class="number">1</span>
  <span class="kw">else</span> <a class="pp" href="#fib">fib<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="#fib">fib<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">div</span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">2</span>)
</span>}
</span></pre>



<p class="p noindent">Note that the type inference engine is currently not powerful enough to
prove that this recursive function always terminates, which leads to
inclusion of the divergence effect <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_div"><span class="tp">div</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>div: <span class="tp">X</span></span></a></code> in the result type.
</p>
<p class="p indent">Here is another version of the Fibonacci function but this time
implemented using local state. We use the <code class="koka">repeat</code> function to
iterate <code class="koka">n</code> times:
</p><pre class="koka source"><span class="plaincode">fun main() { println(fib2(10)) }

fun fib2(n)
{
  var x : int := 0
  var y := 1
  repeat(n) {
    val y0 = y
    y := x+y
    x := y0
  }
  return x
}
</span><span class="nicecode"><span class="decl-fun" id="fib2"><span class="kw">fun</span> <a class="pp" href="#fib2">fib2<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib2: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>)
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1096</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> <span class="kw op">:=</span> <span class="number">0</span>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_hnd.html#local_var"><span class="kw">var</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>hnd<span class="fslash last">/</span></span>local<span class="dash">-</span>var: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">h</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">init</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tpp">l</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">b</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1096</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">:=</span> <span class="number">1</span>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#repeat_1">repeat<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>repeat<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) {
    <span class="kw">val</span> <a class="pp">y0<span class="pc">y0: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_get">y<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp">y<span class="pc">y: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1096</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_get">x<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_get">y<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp">x<span class="pc">x: <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1096</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">y0<span class="pc">y0: <span class="tp">int</span></span></a>
  }
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#local_get">x<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>local<span class="dash">-</span>get: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">v</span> <span class="tp kw op">:</span> <span class="tp">local<span class="dash">-</span>var</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">local</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a>
</span>}
</span></pre>



<p class="p noindent">The <code class="koka"><span class="kw">var</span></code> declaration declares a variable that can be assigned too using the
<code class="koka"><span class="op">(:=)</span></code> operator. In contrast, a regular equality sign, as in <code class="koka">y0 <span class="kw">=</span> y</code>
introduces an immutable value <code class="koka">y0</code>. For clarity, one can actually write <code class="koka"><span class="kw">val</span> y0 <span class="kw">=</span> y</code>
for such declaration too but we usually leave out the <code class="koka"><span class="kw">val</span></code> keyword.
</p>
<p class="p indent">Local variables declared using <code class="koka"><span class="kw">var</span></code> are actually syntactic sugar for
allocating explicit references to mutable cells. A reference to a mutable
integer is allocated using <code class="koka">r <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp">ref</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>(<span class="number">0</span>)</code> (since the reference itself is
actually a value!), and can be dereferenced using the bang operator, as <code class="code code2">!r</code>.
The desugared version of our previously Fibonacci function can be written
using explicit references as
</p><pre class="koka source"><span class="plaincode">fun main() { println(fib3(10)) }

fun fib3(n)
{
  val x = ref(0)
  val y = ref(1)
  repeat(n) {
    val y0 = !y
    y := !x + !y
    x := y0
  }
  return !x
}
</span><span class="nicecode"><span class="decl-fun" id="fib3"><span class="kw">fun</span> <a class="pp" href="#fib3">fib3<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib3: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>)
{
  <span class="kw">val</span> <a class="pp">x<span class="pc">x: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1281</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<span class="number">0</span>)
  <span class="kw">val</span> <a class="pp">y<span class="pc">y: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1281</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#ref">ref<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">value</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">alloc</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<span class="number">1</span>)
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#repeat_1">repeat<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>repeat<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) {
    <span class="kw">val</span> <a class="pp">y0<span class="pc">y0: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl__1">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!)<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1281</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp">y<span class="pc">y: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1281</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl__1">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!)<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1281</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl__1">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!)<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1281</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp">x<span class="pc">x: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1281</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#set"><span class="kw">:=</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>set: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">assigned</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">write</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a> <a class="pp">y0<span class="pc">y0: <span class="tp">int</span></span></a>
  }
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#_excl__1">!<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(!)<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">ref</span> <span class="tp kw op">:</span> <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">&lt;</span><span class="tp">read</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">&gt;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp tv">a</span> <span class="tp kw">with</span> <span class="tp">hdiv</span><span class="tp sp">&lt;</span><span class="tp tv">h</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">ref</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;1281</span><span class="tp sp">,</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>
</span>}
</span></pre>



<p class="p noindent">As we can see, using <code class="koka"><span class="kw">var</span></code> declarations is quite convenient since such
declaration automatically adds a dereferencing operator to all occurrences
except on the left-hand side of an assignment.
</p>
<p class="p indent">When we look at the types inferred for the references, we see that <code class="koka">x</code> and <code class="koka">y</code>
have type <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_ref"><span class="tp">ref</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>ref: <span class="tp sp">(</span><span class="tp">H</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">V</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">&#62;</span></code> which stands for a reference to a mutable value of
type <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code> in some heap <code class="koka"><span class="tp tv">h</span></code>. The effects on heaps are allocation as
<code class="koka"><span class="tp">heap</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>, reading from a heap as <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_read"><span class="tp">read</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>read: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">X</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code> and writing to a heap as
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_write"><span class="tp">write</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>write: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">X</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>. The combination of these effects is called stateful and denoted
with the alias <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>.
</p>
<p class="p indent">Clearly, the effect of the body of <code class="koka"><a class="pp" href="#fib3">fib3<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib3: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> is <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>; but when we hover over
<code class="koka"><a class="pp" href="#fib3">fib3<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib3: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code>, we see the type inferred is actually the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_total"><span class="tp">total</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>total: <span class="tp">E</span></span></a></code> effect: <code class="koka"><span class="tp sp">(</span><span class="tp tpp">n</span><span class="tp kw op">:</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code>.
Indeed, even though <code class="koka"><a class="pp" href="#fib3">fib3<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>fib3: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> is stateful inside, its side-effects can
never be observed. It turns out that we can safely discard the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code>
effect whenever the heap type <code class="koka"><span class="tp tv">h</span></code> cannot be referenced outside this function,
i.e. it is not part of an argument or return type. More formally, the Koka
compiler proves this by showing that a function is fully polymorphic in the
heap type <code class="koka"><span class="tp tv">h</span></code> and applies the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#run">run<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>run: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">e</span><span class="tp sp">,</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">action</span> <span class="tp kw op">:</span> <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">alloc</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><span class="tp">read</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp sp">,</span><span class="tp">write</span><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span><span class="tp kw op">|</span><span class="tp tv">e</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp tv">e</span> <span class="tp tv">a</span></span></a></code> function (corresponding to <code class="code code2">runST</code> in
Haskell) to discard the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_st"><span class="tp">st</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>st: <span class="tp">H</span> <span class="tp kw op">-&gt;</span> <span class="tp">E</span></span></a><span class="tp sp">&#60;</span><span class="tp tv">h</span><span class="tp sp">&#62;</span></code> effect.
</p>
<p class="p indent">The Garsia-Wachs algorithm is nice example where side-effects are used
internally across function definitions and data structures, but where the
final algorithm itself behaves like a pure function, see the
<code class="code code2">lib/demo/garsiaWachs.kk</code> example in the distribution.
</p><h2 id="sec-a-larger-example--cracking-caesar-encoding" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-a-larger-example--cracking-caesar-encoding" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.10</span>.&#8194;</span>A larger example: cracking Caesar encoding</h2>
<p class="p noindent">Enough about effects and imperative updates. Let&#39;s look at some more functional examples :-)
For example, cracking Caesar encoded strings:
</p><pre class="koka source"><span class="plaincode">fun main() { test-uncaesar() }

fun encode( s : string, shift : int )
{
  function encode-char(c) {
    if (c &lt; 'a' || c &gt; 'z') return c
    val base = (c - 'a').int
    val rot  = (base + shift) % 26
    (rot.char + 'a')
  }

  s.map(encode-char)
}

// The letter frequency table for English
val english = [8.2,1.5,2.8,4.3,12.7,2.2,
               2.0,6.1,7.0,0.2,0.8,4.0,2.4,
               6.7,7.5,1.9,0.1, 6.0,6.3,9.1,
               2.8,1.0,2.4,0.2,2.0,0.1]

// Small helper functions
fun percent( n : int, m : int ) {
  100.0 &#42; (n.double / m.double)
}

fun rotate( xs, n ) {
  xs.drop(n) + xs.take(n)
}

// Calculate a frequency table for a string
fun freqs( s : string ) : list&lt;double&gt;
{
  val lowers = list('a','z')
  val occurs = lowers.map( fn(c){ s.count(c.string) })
  val total  = occurs.sum
  occurs.map( fn(i){ percent(i,total) } )
}

// Calculate how well two frequency tables match according
// to the &#95;chi-square&#95; statistic.
fun chisqr( xs : list&lt;double&gt;, ys : list&lt;double&gt; ) : double
{
  zipwith(xs,ys, fn(x,y){ ((x - y)^2.0)/y } ).foldr(0.0,(+))
}

// Crack a Caesar encoded string
fun uncaesar( s : string ) : string
{
  val table  = freqs(s)                   // build a frequency table for &#96;s&#96;
  val chitab = list(0,25).map( fn(n) {    // build a list of chisqr numbers for each shift between 0 and 25
                  chisqr( table.rotate(n), english )
               })
  val min    = chitab.minimum()           // find the mininal element
  val shift  = chitab.index-of( fn(f){ f == min } ).negate  // and use its position as our shift
  s.encode( shift )
}

fun test-uncaesar() {
  println( uncaesar( "nrnd lv d ixq odqjxdjh" ) )
}
</span><span class="nicecode"><span class="comment">// The letter frequency table for English
</span><span class="decl-val" id="english"><span class="kw">val</span> <a class="pp" href="#english">english<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>english: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a><span class="number">8.2</span>,<span class="number">1.5</span>,<span class="number">2.8</span>,<span class="number">4.3</span>,<span class="number">12.7</span>,<span class="number">2.2</span>,
               <span class="number">2.0</span>,<span class="number">6.1</span>,<span class="number">7.0</span>,<span class="number">0.2</span>,<span class="number">0.8</span>,<span class="number">4.0</span>,<span class="number">2.4</span>,
               <span class="number">6.7</span>,<span class="number">7.5</span>,<span class="number">1.9</span>,<span class="number">0.1</span>, <span class="number">6.0</span>,<span class="number">6.3</span>,<span class="number">9.1</span>,
               <span class="number">2.8</span>,<span class="number">1.0</span>,<span class="number">2.4</span>,<span class="number">0.2</span>,<span class="number">2.0</span>,<span class="number">0.1</span></span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>

<span class="comment">// Small helper functions
</span><span class="decl-fun" id="percent"><span class="kw">fun</span> <a class="pp" href="#percent">percent<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>percent: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">m<span class="pc">m: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) {
  <span class="number">100.0</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> (<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">m<span class="pc">m: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
</span>}

<span class="decl-fun" id="rotate"><span class="kw">fun</span> <a class="pp" href="#rotate">rotate<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>rotate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2054</span><span class="tp sp">&gt;</span></span></a>, <a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a> ) {
  <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2054</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#drop">drop<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>drop: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__4">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.4</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">&#95;2054</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#take">take<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>take: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Calculate a frequency table for a string
</span><span class="decl-fun" id="freqs"><span class="kw">fun</span> <a class="pp" href="#freqs">freqs<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>freqs: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>
{
  <span class="kw">val</span> <a class="pp">lowers<span class="pc">lowers: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#list_2">list<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">lo</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">,</span> <span class="tp tpp">hi</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a>(<span class="st">'a'</span>,<span class="st">'z'</span>)
  <span class="kw">val</span> <a class="pp">occurs<span class="pc">occurs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">lowers<span class="pc">lowers: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">char</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>( <span class="kw">fn</span>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a>){ <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#count">count<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pattern</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">c<span class="pc">c: <span class="tp">char</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#string">string<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp sp">(</span><span class="tp tpp">c</span> <span class="tp kw op">:</span> <span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>) })
  <span class="kw">val</span> <a class="pp">total<span class="pc">total: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">occurs<span class="pc">occurs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#sum">sum<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>sum: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  <a class="pp">occurs<span class="pc">occurs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>( <span class="kw">fn</span>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>){ <a class="pp" href="#percent">percent<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>percent: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">m</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>,<a class="pp">total<span class="pc">total: <span class="tp">int</span></span></a>) } )
</span>}

<span class="comment">// Calculate how well two frequency tables match according
</span><span class="comment">// to the &#95;chi-square&#95; statistic.
</span><span class="decl-fun" id="chisqr"><span class="kw">fun</span> <a class="pp" href="#chisqr">chisqr<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>chisqr: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">ys<span class="pc">ys: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#zipwith">zipwith<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zipwith: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">c</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">c</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">c</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>,<a class="pp">ys<span class="pc">ys: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>, <span class="kw">fn</span>(<a class="pp">x<span class="pc">x: <span class="tp">double</span></span></a>,<a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>){ ((<a class="pp">x<span class="pc">x: <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash__3">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_hat_">^<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(^): <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><span class="number">2.0</span>)<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_fs__1">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">double</span></span></a> } )<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#foldr">foldr<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>foldr: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">z</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span></span></a>(<span class="number">0.0</span>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__3">(+)<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>)
</span>}

<span class="comment">// Crack a Caesar encoded string
</span><span class="decl-fun" id="uncaesar"><span class="kw">fun</span> <a class="pp" href="#uncaesar">uncaesar<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>uncaesar: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>
{
  <span class="kw">val</span> <a class="pp">table<span class="pc">table: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>  <span class="kw">=</span> <a class="pp" href="#freqs">freqs<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>freqs: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a>)                   <span class="comment">// build a frequency table for &#96;s&#96;
</span>  <span class="kw">val</span> <a class="pp">chitab<span class="pc">chitab: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#list">list<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp sp">(</span><span class="tp tpp">lo</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">hi</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">total</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a>(<span class="number">0</span>,<span class="number">25</span>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#map_5">map<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>map<span class="postfix">.5</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">,</span><span class="tp tv">e</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp tv">e</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">b</span><span class="tp sp">&gt;</span></span></a>( <span class="kw">fn</span>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>) {    <span class="comment">// build a list of chisqr numbers for each shift between 0 and 25
</span>                  <a class="pp" href="#chisqr">chisqr<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>chisqr: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>( <a class="pp">table<span class="pc">table: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#rotate">rotate<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>rotate: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">n<span class="pc">n: <span class="tp">int</span></span></a>), <a class="pp" href="#english">english<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>english: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a> )
               })
  <span class="kw">val</span> <a class="pp">min<span class="pc">min: <span class="tp">double</span></span></a>    <span class="kw">=</span> <a class="pp">chitab<span class="pc">chitab: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#minimum_1">minimum<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>minimum<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>()           <span class="comment">// find the mininal element
</span>  <span class="kw">val</span> <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">chitab<span class="pc">chitab: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">double</span><span class="tp sp">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#index_of">index-of<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>index<span class="dash">-</span>of: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">pred</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <span class="kw">fn</span>(<a class="pp">f<span class="pc">f: <span class="tp">double</span></span></a>){ <a class="pp">f<span class="pc">f: <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__2">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">min<span class="pc">min: <span class="tp">double</span></span></a> } )<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#negate">negate<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>negate: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>  <span class="comment">// and use its position as our shift
</span>  <a class="pp">s<span class="pc">s: <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="#encode">encode<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>encode: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">shift</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">shift<span class="pc">shift: <span class="tp">int</span></span></a> )
</span>}

<span class="decl-fun" id="test_uncaesar"><span class="kw">fun</span> <a class="pp" href="#test_uncaesar">test-uncaesar<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>test<span class="dash">-</span>uncaesar: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>() {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#println">println<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>println: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>( <a class="pp" href="#uncaesar">uncaesar<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>uncaesar: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <span class="st">"nrnd lv d ixq odqjxdjh"</span> ) )
</span>}
</span></pre>



<p class="p noindent">The <code class="koka"><span class="kw">val</span></code> keyword declares a static value. In the example, the value <code class="koka"><a class="pp" href="#english">english<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>english: <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span></span></a></code>
is a list of floating point numbers (of type <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a></code>) denoting the average
frequency for each letter. The function <code class="koka"><a class="pp" href="#freqs">freqs<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>freqs: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span></span></a></code> builds a frequency table for a
specific string, while the function <code class="koka"><a class="pp" href="#chisqr">chisqr<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>chisqr: <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">ys</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">double</span></span></a></code> calculates how well two frequency
tables match. In the function <code class="koka">crack</code> these functions are used to find a
<code class="koka">shift</code> value that results in a string whose frequency table matches the
<code class="koka"><a class="pp" href="#english">english<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>english: <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp">double</span><span class="tp sp">&#62;</span></span></a></code> one the closest &#8211; and we use that to decode the string. Let&#39;s try
it out in the editor!
</p><h2 id="sec-optional-and-named-parameters" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-optional-and-named-parameters" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.11</span>.&#8194;</span>Optional and named parameters</h2>
<p class="p noindent">Being a function-oriented language, Koka has powerful support for function
calls where it supports both optional and named parameters. For example, the
function <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#replace_all">replace<span class="dash">-</span>all<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>replace<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pattern</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">repl</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a></code> takes a string, a <code class="code code2">pattern</code> pattern, and
a replacement string <code class="code code2">repl</code>:
</p><pre class="koka source"><span class="plaincode">fun main() { println(world()) }

fun world()
{
  replace-all("hi there", "there", "world")  // returns "hi world"
}
</span><span class="nicecode"><span class="decl-fun" id="world"><span class="kw">fun</span> <a class="pp" href="#world">world<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>world: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>()
{
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#replace_all">replace-all<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>replace<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pattern</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">repl</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<span class="st">"hi there"</span>, <span class="st">"there"</span>, <span class="st">"world"</span>)  <span class="comment">// returns "hi world"
</span></span>}
</span></pre>



<p class="p noindent">Using named parameters, we can also write the function call as:
</p><pre class="koka source"><span class="plaincode">fun main() { println(world2()) }

fun world2()
{
  return "hi there".replace-all( repl="world", pattern="there" )
}
</span><span class="nicecode"><span class="decl-fun" id="world2"><span class="kw">fun</span> <a class="pp" href="#world2">world2<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>world2: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>()
{
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">string</span></span></a> <span class="st">"hi there"</span><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#replace_all">replace-all<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>replace<span class="dash">-</span>all: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">pattern</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">repl</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( repl<span class="kw">=</span><span class="st">"world"</span>, pattern<span class="kw">=</span><span class="st">"there"</span> )
</span>}
</span></pre>



<p class="p noindent">Optional parameters let you specify default values for parameters that do not
need to be provided at a call-site.  As an example, let&#39;s define a function
<code class="koka"><a class="pp" href="#sublist">sublist<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>sublist: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">len</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> that takes a list, a <code class="code code2">start</code> position, and the length <code class="code code2">len</code> of the desired
sublist.  We can make the <code class="code code2">len</code> parameter optional and by default return all
elements following the <code class="code code2">start</code> position by picking the length of the input list by
default:
</p><pre class="koka source"><span class="plaincode">fun main() { println( ['a','b','c'].sublist(1).string ) }

fun sublist( xs : list&lt;a&gt;, start : int,
                  len : int = xs.length ) : list&lt;a&gt;
{
  if (start &lt;= 0) return xs.take(len)
  match(xs) {
    Nil -&gt; Nil
    Cons(&#95;,xx) -&gt; xx.sublist(start - 1, len)
  }
}
</span><span class="nicecode"><span class="decl-fun" id="sublist"><span class="kw">fun</span> <a class="pp" href="#sublist">sublist<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>sublist: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">len</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">2867</span><span class="op">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
                  <a class="pp">len<span class="pc">len: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">2867</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#length_1">length<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>length<span class="postfix">.1</span>: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp"><span class="tp tv">a</span><span class="pc">a: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>
{
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>) <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">2867</span><span class="op">&gt;</span></span></a> <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">2867</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#take">take<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>take: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">len<span class="pc">len: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
  <span class="kw">match</span>(<a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">2867</span><span class="op">&gt;</span></span></a>) {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a> <span class="kw op">-></span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(&#95;,<a class="pp">xx<span class="pc">xx: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">2867</span><span class="op">&gt;</span></span></a>) <span class="kw op">-></span> <a class="pp">xx<span class="pc">xx: <span class="tp">list</span><span class="tp op">&lt;$</span><span class="number">2867</span><span class="op">&gt;</span></span></a><span class="kw op">.</span><a class="pp" href="#sublist">sublist<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>sublist: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">len</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>(<a class="pp">start<span class="pc">start: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>, <a class="pp">len<span class="pc">len: <span class="tp">int</span></span></a>)
  }
</span>}
</span></pre>



<p class="p noindent">Hover over the <code class="koka"><a class="pp" href="#sublist">sublist<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>sublist: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">xs</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">start</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">len</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code> identifier to see its full type, where the <code class="code code2">len</code>
parameter has gotten an optional <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a></code> type signified by the question mark:
<code class="koka"><span class="op">:?</span>int</code>.
</p><h2 id="sec-structs" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-structs" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.12</span>.&#8194;</span>Structs</h2>
<p class="p noindent">An important aspect of a function-oriented language is to be able to define
rich data types over which the functions work. A common data type is that of a
<em class="em-low1">struct</em> or <em class="em-low1">record</em>. Here is an example of a struct that contains information
about a person:
</p><pre class="koka source"><span class="plaincode">struct person( age : int,
               name : string,
               realname : string = name )

val gaga = Person( 25, "Lady Gaga" )
</span><span class="nicecode"><span class="decl-type" id="type_space_person"><span class="tp kw">struct</span> <span class="decl-con" id="con_space_Person"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a>( <span class="decl-fun" id="age"><a class="pp">age<span class="pc">age: <span class="tp">int</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
               <span class="decl-fun" id="name"><a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
               <span class="decl-fun" id="realname"><a class="pp">realname<span class="pc">realname: <span class="tp">string</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a> </span></span>)

<span class="decl-val" id="gaga"><span class="kw">val</span> <a class="pp" href="#gaga">gaga<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>gaga: <span class="tp">person</span></span></a> <span class="kw">=</span> <a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>( <span class="number">25</span>, <span class="st">"Lady Gaga"</span> </span>)
</span></pre>



<p class="p noindent">Every <code class="koka"><span class="tp kw">struct</span></code> (and other data types) come with constructor functions to
create instances, as in <code class="koka"><a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a>(<span class="number">25</span>,</code><code class="koka"><a class="pp" href="#gaga">gaga<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>gaga: <span class="tp">person</span></span></a></code><code class="koka">)</code>. Moreover, these
constructors can use named arguments so we can also call the constructor
as <code class="koka"><a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a>( <a class="pp" href="#name">name<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a> <span class="kw">=</span> <span class="st">&#34;Lady Gaga&#34;</span>, <a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="number">25</span>, <a class="pp" href="#realname">realname<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>realname: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">string</span></span></a> <span class="kw">=</span> <span class="st">&#34;Stefani Joanne Angelina Germanotta&#34;</span> )</code>
which is quite close regular record syntax but without any special rules;
it is just functions all the way down!
</p>
<p class="p indent">Also, Koka automatically generates accessor functions for each field in a
struct (or other data type), and we can access the <code class="koka"><a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> of a <code class="koka"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a></code> as
<code class="koka"><a class="pp" href="#gaga">gaga<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>gaga: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> (which is of course just syntactic sugar for <code class="koka"><a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a>(<a class="pp" href="#gaga">gaga<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>gaga: <span class="tp">person</span></span></a>)</code>).
</p><h2 id="sec-copying" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-copying" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.13</span>.&#8194;</span>Copying</h2>
<p class="p noindent">By default, all structs (and other data types) are <em class="em-low1">immutable</em>. Instead of
directly mutating a field in a struct, we usually return a new struct where
the fields are updated. For example, here is a <code class="koka"><a class="pp" href="#birthday">birthday<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>birthday: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a></code> function that
increments the <code class="koka"><a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> field:
</p><pre class="koka source"><span class="plaincode">fun main() { println( gaga.birthday.age ) }

struct person( age : int, name : string, realname : string = name )

val gaga = Person( 25, "Lady Gaga" )

fun birthday( p : person ) : person  
{
  return p( age = p.age + 1 )
}
</span><span class="nicecode"><span class="decl-fun" id="birthday"><span class="kw">fun</span> <a class="pp" href="#birthday">birthday<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>birthday: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>( <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a>  
{
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">person</span></span></a> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a>( age <span class="kw">=</span> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span> )
</span>}
</span></pre>



<p class="p noindent">Here, <code class="koka"><a class="pp" href="#birthday">birthday<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>birthday: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a></code> returns a fresh <code class="koka"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a></code> which is equal to <code class="koka">p</code> but with the
<code class="koka"><a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a></code> incremented. The syntax <code class="code code2">p(...)</code> is sugar for calling the copy constructor of
a <code class="koka"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a></code>. This constructor is also automatically generated for each data
type, and is basically defined as:
</p><pre class="koka source"><span class="plaincode">fun main() { println( gaga.copy().age ) }

struct person( age : int, name : string, realname : string = name )

val gaga = Person( 25, "Lady Gaga" )

fun copy( p, age = p.age, name = p.name,
               rname = p.realname )
{
  return Person(age, name, rname)
}
</span><span class="nicecode"><span class="decl-fun" id="copy"><span class="kw">fun</span> <a class="pp" href="#copy">copy<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>copy: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">,</span> <span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">,</span> <span class="tp tpp">rname</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>( <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a>, <a class="pp">age<span class="pc">age: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">int</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">name<span class="pc">name: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#name">name<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>,
               <a class="pp">rname<span class="pc">rname: <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp">p<span class="pc">p: <span class="tp">person</span></span></a><span class="kw op">.</span><a class="pp" href="#realname">realname<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>realname: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> )
{
  <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">person</span></span></a> <a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>(<a class="pp">age<span class="pc">age: <span class="tp">int</span></span></a>, <a class="pp">name<span class="pc">name: <span class="tp">string</span></span></a>, <a class="pp">rname<span class="pc">rname: <span class="tp">string</span></span></a>)
</span>}
</span></pre>



<p class="p noindent">When arguments follow a data value, as in <code class="code code2">p( age = age + 1)</code>, it is desugared to call this
copy function, as in <code class="koka">p<span class="kw op">.</span><a class="pp" href="#copy">copy<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>copy: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">,</span> <span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&#60;</span><span class="tp">int</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&#60;</span><span class="tp">string</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">rname</span> <span class="tp kw op">:</span> <span class="tp">optional</span><span class="tp sp">&#60;</span><span class="tp">string</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">person</span></span></a>( <a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a> <span class="kw">=</span> p<span class="kw op">.</span><a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">int</span></span></a><span class="op">+</span><span class="number">1</span> )</code>. Again, there are no special
rules for record updates and everything is just function calls with optional
and named parameters.
</p><h2 id="sec-more-data-types" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-more-data-types" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.14</span>.&#8194;</span>More data types</h2>
<p class="p noindent">Koka also supports algebraic data types where there are multiple alternatives.
For example, here is an enumeration:
</p><pre class="koka source unchecked"><span class="plaincode">type colors {
  Red
  Green
  Blue
}
</span><span class="nicecode"><span class="tp kw">type</span> <span class="tp">colors</span> {
  <span class="co">Red</span>
  <span class="co">Green</span>
  <span class="co">Blue</span>
}
</span></pre>



<p class="p noindent">Special cases of these enumerated types are the <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_void"><span class="tp">void</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>void: <span class="tp">V</span></span></a></code> type which has no
alternatives (and therefore there exists no value with this type), the unit
type <code class="koka"><a class="doc link" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space__lp__rp_"><span class="tp">()</span></a></code> which has just one constructor, also written as <code class="koka">()</code> (and
therefore, there exists only one value with the type <code class="koka"><a class="doc link" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space__lp__rp_"><span class="tp">()</span></a></code>, namely <code class="koka">()</code>), and
finally the boolean type <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a></code> with two constructors <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code> and <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a></code>.
</p><pre class="koka source unchecked"><span class="plaincode">type void
type () {
  ()
}
type bool {
  False
  True
}
</span><span class="nicecode"><span class="tp kw">type</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_void"><span class="tp">void</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>void: <span class="tp">V</span></span></a>
<span class="tp kw">type</span> <span class="tp sp">(</span><span class="tp sp">)</span> {
  ()
}
<span class="tp kw">type</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
}
</span></pre>



<p class="p noindent">Constructors can have parameters. For example, here is how to create a
<code class="koka"><span class="tp">number</span></code> type which is either an integer or the infinity value:
</p><pre class="koka source unchecked"><span class="plaincode">type number {
  Infinity
  Integer( i : int )
}
</span><span class="nicecode"><span class="tp kw">type</span> <span class="tp">number</span> {
  <span class="co">Infinity</span>
  <span class="co">Integer</span>( i <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> )
}
</span></pre>



<p class="p noindent">We can create such number by writing <code class="koka">integer(<span class="number">1</span>)</code> or <code class="koka">infinity</code>. Moreover,
data types can be polymorphic and recursive. Here is the definition of the
<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-&gt;</span> <span class="tp">V</span></span></a></code> type which is either empty (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>) or is a head element followed by a
tail list (<code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>):
</p><pre class="koka source unchecked"><span class="plaincode">type list&lt;a&gt; {
  Nil
  Cons( head : a, tail : list&lt;a&gt; )
}
</span><span class="nicecode"><span class="tp kw">type</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>( head <span class="tp kw op">:</span> <span class="tp tv">a</span>, tail <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_list"><span class="tp">list</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>list: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> )
}
</span></pre>



<p class="p noindent">Koka automatically generates accessor functions for each named parameter. For
lists for example, we can access the head of a list as <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>(<span class="number">1</span>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">Nil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">list</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>)<span class="kw op">.</span>head</code>.
</p>
<p class="p indent">We can now also see that <code class="koka"><span class="tp kw">struct</span></code> types are just syntactic sugar for regular a
<code class="koka"><span class="tp kw">type</span></code> with a single constructor of the same name as the type. For example,
our earlier <code class="koka"><a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a></code> struct, defined as
</p><pre class="koka source unchecked"><span class="plaincode">struct person( age : int, name : string,
               realname : string = name )
</span><span class="nicecode"><span class="tp kw">struct</span> <a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a>( <a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp" href="#name">name<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>,
               <a class="pp" href="#realname">realname<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>realname: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#name">name<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> )
</span></pre>



<p class="p noindent">desugars to:
</p><pre class="koka source unchecked"><span class="plaincode">type person {
  Person( age : int, name : string, realname : string = name )
}
</span><span class="nicecode"><span class="tp kw">type</span> <a class="pp" href="#type_space_person"><span class="tp">person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>person: <span class="tp">V</span></span></a> {
  <a class="pp" href="#con_space_Person"><span class="co">Person</span><span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>Person: <span class="tp sp">(</span><span class="tp tpp">age</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">name</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">realname</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">person</span></span></a>( <a class="pp" href="#age">age<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>age: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp" href="#name">name<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <a class="pp" href="#realname">realname<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>realname: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#name">name<span class="pc"><span class="mo">overview<span class="fslash last">/</span></span>name: <span class="tp sp">(</span><span class="tp tpp">person</span> <span class="tp kw op">:</span> <span class="tp">person</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> )
}
</span></pre>


<h2 id="sec-matching" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-matching" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.15</span>.&#8194;</span>Matching</h2>
<p class="p noindent">Todo
</p><h2 id="sec-inductive-co-inductive-and-recursive-types" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-inductive-co-inductive-and-recursive-types" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">2.16</span>.&#8194;</span>Inductive, co-inductive, and recursive types</h2>
<p class="p noindent">For the purposes of equational reasoning and termination checking, a <code class="koka"><span class="tp kw">type</span></code>
declaration is limited to finite inductive types. There are two more
declarations, namely <code class="koka">co <span class="tp kw">type</span></code> and <code class="koka">rec <span class="tp kw">type</span></code> that allow for co-inductive types,
and arbitrary recursive types respectively.
</p><h1 id="sec-koka-language-specification" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-koka-language-specification" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3</span>.&#8194;</span>Koka language specification</h1>
<p class="p noindent">This is the draft language specification of the Koka language, version v2.0.11<br>
Currently only the lexical and context-free grammar are specified.
The&nbsp;<a href="toc.html" data-linkid="stdlib">standard libraries</a> are documented separately.
</p><h2 id="sec-lexical-syntax" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-lexical-syntax" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.1</span>.&#8194;</span>Lexical syntax</h2>
<p class="p noindent">We define the grammar and lexical syntax of the language using standard BNF
notation where non-terminals are generated by alternative patterns:
</p><table class="grammar madoko block">
<tbody><tr><td class="tbody tr-odd tr-last tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">nonterm</em> </td><td class="tbody tr-odd tr-last tr-first col col-even" data-row="1" data-col="2"> ::= </td><td class="tbody tr-odd tr-last tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">pattern</em><sub>1</sub> <span class="bar">|</span> <em class="em-low1">pattern</em><sub>2</sub> </td><td class="tbody tr-odd tr-last tr-first col col-even col-last" data-row="1" data-col="4">   </td></tr></tbody></table>
<p class="p noindent">In the patterns, we use the following notations:
</p><table class="grammar madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <code class="koka">terminal</code>                         </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2">   </td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="3"> A terminal symbol                                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <code class="code code2">x0A</code>                            </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="3"> A character with hexadecimal code 0A                                       </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <code class="code code2">a..f</code>                           </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">   </td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="3"> The characters from a to f                                                 </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> &#160;                             </td><td class="tbody tr-even col col-even" data-row="4" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="4" data-col="3">                                                                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> ( <em class="em-low1">pattern</em> )                      </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">   </td><td class="tbody tr-odd col col-odd col-last" data-row="5" data-col="3"> Grouping                                                                   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> [ <em class="em-low1">pattern</em> ]                      </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="6" data-col="3"> Optional occurrence of <em class="em-low1">pattern</em>                                           </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> { <em class="em-low1">pattern</em> }                      </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">   </td><td class="tbody tr-odd col col-odd col-last" data-row="7" data-col="3"> Zero or more occurrences of <em class="em-low1">pattern</em>                                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">pattern</em><sub>1</sub> <span class="bar">|</span> <em class="em-low1">pattern</em><sub>2</sub> </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="8" data-col="3"> Choice: either <em class="em-low1">pattern</em><sub>1</sub> or <em class="em-low1">pattern</em><sub>2</sub>                                </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;                             </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">   </td><td class="tbody tr-odd col col-odd col-last" data-row="9" data-col="3">                                                                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">pattern</em><sub>&#60;!<em class="em-low1">diff</em>&gt;</sub>            </td><td class="tbody tr-even col col-even" data-row="10" data-col="2">   </td><td class="tbody tr-even col col-odd col-last" data-row="10" data-col="3"> Difference: elements generated by <em class="em-low1">pattern</em> except those in <em class="em-low1">diff</em>         </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">nonterm</em><sub>[<em class="em-low1">lex</em>]</sub>               </td><td class="tbody tr-odd tr-last col col-even" data-row="11" data-col="2">   </td><td class="tbody tr-odd tr-last col col-odd col-last" data-row="11" data-col="3"> Generate <em class="em-low1">nonterm</em> by drawing lexemes from <em class="em-low1">lex</em>                           </td></tr></tbody></table><!--
| _pattern_~&lt;_postfix_>~          |   | Postfix: any elements in _pattern_ that are directly followed by _postfix_ |
| ~&lt;_prefix_>~_pattern_           |   | Prefix: any elements in _pattern_ that directly follow _prefix_            |
-->



<p class="p grammar noindent">Care must be taken to distinguish meta-syntax such as
 <span class="bar">|</span> and )
from concrete terminal symbols as <code class="code code2">|</code> and <code class="code code2">)</code>. In the specification
the order of the productions is not important and at each point the
<em class="em-low1">longest matching lexeme</em> is preferred. For example, even though
<code class="koka"><span class="kw">function</span></code> is a reserved word, the word <code class="koka">functions</code> is considered a
single identifier. A <em class="em-low1">prefix</em> or <em class="em-low1">postfix</em> pattern is included
when considering a longest match.</p><h3 id="sec-source-code" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-source-code" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.1.1</span>.&#8194;</span>Source code</h3>
<p class="p noindent">Source code consists of a sequence of 8-bit characters. Valid characters in
actual program code consists strictly of ASCII characters which range from 0
to 127 and can be encoded in 7-bits. Only comments, string literals, and
character literals are allowed to contain extended 8-bit characters.
</p><h3 id="sec-encoding" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-encoding" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.1.2</span>.&#8194;</span>Encoding</h3>
<p class="p noindent">A program source is assumed to be UTF-8 encoded which allows comments,
string literals, and character literals to contain (encoded) unicode
characters. Moreover, the grammar is designed such that a lexical
analyzer and parser can directly work on source files without doing UTF-8
decoding or unicode category identification. To further facilitate the
processing of UTF-8 encoded files the lexical analyzer ignores an initial
byte-order mark that some UTF-8 encoders insert. In particular, any
program source is allowed to start with three byte-order mark bytes
<code class="code code2">0xEF</code>, <code class="code code2">0xBB</code>, and <code class="code code2">0xBF</code>, which are ignored.
</p><h2 id="sec-lexical-grammar" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-lexical-grammar" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.2</span>.&#8194;</span>Lexical grammar</h2>
<p class="p noindent">In the specification of the lexical grammar all white space is explicit
and there is no implicit white space between juxtaposed symbols. The
lexical token stream is generated by the non-terminal <em class="em-low1">lex</em> which
consists of lexemes and whitespace.
</p>
<p class="p indent">Before doing lexical analysis, there is a <em class="em-low1">linefeed</em> character inserted
at the start and end of the input, which makes it easier to specify line
comments and directives.
</p><h3 id="sec-lexical-tokens" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-lexical-tokens" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.2.1</span>.&#8194;</span>Lexical tokens</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">lex</em>                </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">lexeme</em> <span class="bar">|</span> <em class="em-low1">whitespace</em>                               </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">lexeme</em>&#160;&#160; </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">conid</em> <span class="bar">|</span> <em class="em-low1">qconid</em>                                    </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">                      </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">varid</em> <span class="bar">|</span> <em class="em-low1">qvarid</em>                                    </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">                      </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">op</em> <span class="bar">|</span> <em class="em-low1">opid</em> <span class="bar">|</span> <em class="em-low1">qopid</em> <span class="bar">|</span> <em class="em-low1">wildcard</em>    </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">                      </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">natural</em> <span class="bar">|</span> <em class="em-low1">float</em> <span class="bar">|</span> <em class="em-low1">string</em> <span class="bar">|</span> <em class="em-low1">char</em> </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">                      </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">reserved</em> <span class="bar">|</span> <em class="em-low1">opreserved</em>                             </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">     </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="7" data-col="1">                      </td><td class="tbody tr-odd tr-last col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd tr-last col col-odd" data-row="7" data-col="3"> <em class="em-low1">special</em>                                                    </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="7" data-col="4">     </td></tr></tbody></table>
<p class="p noindent">The main program consists of <em class="em-low1">whitespace</em> or <em class="em-low1">lexeme</em>&#39;s. The context-free
grammar will draw it&#39;s lexemes from the <em class="em-low1">lex</em> production.
</p><h3 id="sec-identifiers" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-identifiers" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.2.2</span>.&#8194;</span>Identifiers</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">anyid</em>      </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">varid</em> <span class="bar">|</span> <em class="em-low1">qvarid</em> <span class="bar">|</span> <em class="em-low1">opid</em> <span class="bar">|</span> <em class="em-low1">qopid</em> <span class="bar">|</span> <em class="em-low1">conid</em> <span class="bar">|</span> <em class="em-low1">qconid</em> </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">qconid</em>     </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">modulepath</em> <em class="em-low1">conid</em>                                                                          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">qvarid</em>     </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">modulepath</em> <em class="em-low1">lowerid</em>                                                                        </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">modulepath</em> </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">lowerid</em> <code class="koka"><span class="op"><span class="divide">/</span></span></code> <span class="many">{ <em class="em-low1">lowerid</em> <code class="koka"><span class="op"><span class="divide">/</span></span></code> }</span>                                                          </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3">                                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">conid</em>      </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">upperid</em>                                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">varid</em>      </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">lowerid</em><sub>&#60;!<em class="em-low1">reserved</em>&#62;</sub>                                                                </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">lowerid</em>    </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">lower</em> <em class="em-low1">idtail</em>                                                                              </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">upperid</em>    </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">upper</em> <em class="em-low1">idtail</em>                                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">wildcard</em>   </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <code class="code code2">_</code> <em class="em-low1">idtail</em>                                                                                </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">typevarid</em>  </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">letter</em> <span class="many">{ <em class="em-low1">digit</em> }</span>                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="14" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3">                                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">idtail</em>     </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <span class="many">{ <em class="em-low1">idchar</em> }</span> <span class="opt">[ <em class="em-low1">idfinal</em> ]</span>                                                           </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">idchar</em>     </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <em class="em-low1">letter</em> <span class="bar">|</span> <em class="em-low1">digit</em> <span class="bar">|</span> <code class="code code2">_</code> <span class="bar">|</span> <code class="code code2">-</code>                                       </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1"> <em class="em-low1">idfinal</em>    </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <span class="many">{ <code class="code code2">&#39;</code> }</span>                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="18" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3">                                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1"> <em class="em-low1">reserved</em>   </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <code class="koka"><span class="kw">infix</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">infixr</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">infixl</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">prefix</span></code>                                 </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> <code class="koka"><span class="tp kw">type</span></code> <span class="bar">|</span> <code class="koka"><span class="tp kw">struct</span></code> <span class="bar">|</span> <code class="koka"><span class="tp kw">alias</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">con</span></code>                                                    </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3"> <code class="koka"><span class="kw">forall</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">exists</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">some</span></code>                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <code class="koka"><span class="kw">fun</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">fn</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">val</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">var</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">extern</span></code>                           </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3"> <code class="koka"><span class="kw">if</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">then</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">else</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">elif</span></code>                                          </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="24" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="24" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="24" data-col="3"> <code class="koka"><span class="kw">match</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">return</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">with</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">in</span></code>                                       </td><td class="tbody tr-even col col-even col-last" data-row="24" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="25" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="25" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="25" data-col="3"> <code class="koka"><span class="kw">handle</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">handler</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">mask</span></code>                                                   </td><td class="tbody tr-odd col col-even col-last" data-row="25" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="26" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="26" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="26" data-col="3"> <code class="koka"><span class="kw">override</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">control</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">rcontrol</span></code>                                             </td><td class="tbody tr-even col col-even col-last" data-row="26" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="27" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="27" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="27" data-col="3"> <code class="koka"><span class="tp kw">effect</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">named</span></code>                                               </td><td class="tbody tr-odd col col-even col-last" data-row="27" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="28" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="28" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="28" data-col="3"> <code class="code code2">module</code> <span class="bar">|</span> <code class="koka"><span class="kw">import</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">as</span></code>                                                    </td><td class="tbody tr-even col col-even col-last" data-row="28" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="29" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="29" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="29" data-col="3"> <code class="koka"><span class="kw">public</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">private</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">abstract</span></code>                                               </td><td class="tbody tr-odd col col-even col-last" data-row="29" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="30" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="30" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="30" data-col="3"> <code class="koka"><span class="kw">pub</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">interface</span></code> <span class="bar">|</span> <code class="koka">yield</code> <span class="bar">|</span> <code class="koka">qualified</code> <span class="bar">|</span> <code class="koka">hiding</code> <span class="bar">|</span> <code class="koka"><span class="kw">unsafe</span></code>         </td><td class="tbody tr-even col col-even col-last" data-row="30" data-col="4"> (future reserved words) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="31" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="31" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="31" data-col="3">                                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="31" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="32" data-col="1"> <em class="em-low1">specialid</em>  </td><td class="tbody tr-even col col-even" data-row="32" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="32" data-col="3"> <code class="koka">co</code> <span class="bar">|</span> <code class="koka">rec</code> <span class="bar">|</span> <code class="koka">open</code> <span class="bar">|</span> <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#extend">extend<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>extend: <span class="tp sp">(</span><span class="tp tpp">slice</span> <span class="tp kw op">:</span> <span class="tp">sslice</span><span class="tp sp">,</span> <span class="tp tpp">count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">sslice</span></span></a></code> <span class="bar">|</span> <code class="koka">behind</code>                                                    </td><td class="tbody tr-even col col-even col-last" data-row="32" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="33" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="33" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="33" data-col="3"> <code class="koka">linear</code> <span class="bar">|</span> <code class="koka">value</code> <span class="bar">|</span> <code class="koka">reference</code>                                                </td><td class="tbody tr-odd col col-even col-last" data-row="33" data-col="4">                         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="34" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="34" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="34" data-col="3"> <code class="koka">inline</code> <span class="bar">|</span> <code class="koka">noinline</code> <span class="bar">|</span> <code class="koka">include</code> <span class="bar">|</span> <code class="koka"><span class="kw">import</span></code>                             </td><td class="tbody tr-even col col-even col-last" data-row="34" data-col="4">                         </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="35" data-col="1">              </td><td class="tbody tr-odd tr-last col col-even" data-row="35" data-col="2"> &#124; </td><td class="tbody tr-odd tr-last col col-odd" data-row="35" data-col="3"> <code class="koka">js</code> <span class="bar">|</span> <code class="koka">c</code>  <span class="bar">|</span> <code class="koka">file</code>                                                            </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="35" data-col="4">                         </td></tr></tbody></table>
<p class="p noindent">Identifiers always start with a letter, may contain underscores and
dashes, and can end with prime ticks.
Like in Haskell, constructors always begin with an uppercase
letter while regular identifiers are lowercase. The rationale is to
visibly distinguish constants from variables in pattern matches.
Here are some example of valid identifiers:
</p><pre class="koka source unchecked"><span class="plaincode">x
concat1
visit-left
is-nil
x'
Cons
True  
</span><span class="nicecode">x
concat1
visit<span class="dash">-</span>left
<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#is_nil">is<span class="dash">-</span>nil<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">list</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>
x'
<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">Cons</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>  
</span></pre>


<p class="p noindent">To avoid confusion with the subtraction operator, the occurrences of
dashes are restricted in identifiers. After lexical analysis, only
identifiers where each dash is surrounded on both sides with a <em class="em-low1">letter</em>
are accepted:
</p>
<pre class="para-block pre-fenced pre-fenced4 language-koka lang-koka koka colorized" style="display:block"><code>fold-right
n-1        <span style="color:darkgreen">//</span><span style="color:darkgreen"> illegal, a digit cannot follow a dash</span>
n - <span class="constant" style="color:purple">1</span>      <span style="color:darkgreen">//</span><span style="color:darkgreen"> n minus 1</span>
n-x-1      <span style="color:darkgreen">//</span><span style="color:darkgreen"> illegal, a digit cannot follow a dash</span>
n-x - <span class="constant" style="color:purple">1</span>    <span style="color:darkgreen">//</span><span style="color:darkgreen"> identifier </span><span style="color:darkgreen">&quot;</span><span style="color:gray">n-x</span><span style="color:darkgreen">&quot;</span><span style="color:darkgreen"> minus 1</span>
n - x - <span class="constant" style="color:purple">1</span>  <span style="color:darkgreen">//</span><span style="color:darkgreen"> n minus x minus 1</span></code></pre>
<p class="p noindent para-continued">Qualified identifiers are prefixed with a module path. Module
paths can be partial as long as they are unambiguous.
</p>
<pre class="para-block pre-fenced pre-fenced4 language-koka lang-koka koka colorized" style="display:block"><code><span style="color:navy">core/</span>map
<span style="color:navy">std/</span>core/(&amp;)</code></pre><h3 id="sec-operators-and-symbols" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-operators-and-symbols" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.2.3</span>.&#8194;</span>Operators and symbols</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">qopid</em>      </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">modulepath</em> <em class="em-low1">opid</em>                                                                                                                                   </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">opid</em>       </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <code class="koka">(</code> <em class="em-low1">symbols</em> <code class="koka">)</code>                                                                                                                                     </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                                                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">op</em>         </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">symbols</em><sub>&#60;!&#160;<em class="em-low1">opreserved</em><span class="bar">|</span><em class="em-low1">optype</em>&#62;</sub>  <span class="bar">|</span>  <code class="code code2"><span class="code-escaped">&#124;&#124;</span></code>                                                                      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3">                                                                                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">symbols</em>    </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">symbol</em> <span class="many">{ <em class="em-low1">symbol</em> }</span><span class="bar">|</span> <code class="code code2">/</code>                                                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">symbol</em>     </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="op">$</span></code> <span class="bar">|</span> <code class="koka"><span class="op">%</span></code> <span class="bar">|</span> <code class="code code2">&amp;</code> <span class="bar">|</span> <code class="koka"><span class="op">&#42;</span></code> <span class="bar">|</span> <code class="koka"><span class="op">+</span></code>                                                                                             </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="code code2">~</code> <span class="bar">|</span> <code class="code code2">!</code> <span class="bar">|</span> <code class="code code2">\</code> <span class="bar">|</span> <code class="koka"><span class="op">^</span></code> <span class="bar">|</span> <code class="code code2">#</code>                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="code code2">=</code> <span class="bar">|</span> <code class="code code2">.</code> <span class="bar">|</span> <code class="code code2">:</code> <span class="bar">|</span> <code class="koka"><span class="op"><span class="minus">-</span></span></code> <span class="bar">|</span> <code class="koka"><span class="op">?</span></code>                                                                                         </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">anglebar</em>                                                                                                                                            </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">anglebar</em>   </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="code code2">&lt;</code> <span class="bar">|</span> <code class="code code2">&gt;</code> <span class="bar">|</span> <code class="code code2"><span class="code-escaped">&#124;</span></code>                                                                                                           </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="12" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3">                                                                                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">opreserved</em> </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <code class="koka"><span class="kw">=</span></code> <span class="bar">|</span> <code class="koka"><span class="kw op">.</span></code> <span class="bar">|</span> <code class="code code2">:</code> <span class="bar">|</span> <code class="koka"><span class="kw op">-&gt;</span></code>                                                                                                         </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">optype</em>     </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">anglebar</em> <em class="em-low1">anglebar</em> <span class="many">{ <em class="em-low1">anglebar</em> }</span>                                                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3">                                                                                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">special</em>    </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <code class="koka">{</code> <span class="bar">|</span> <code class="koka">}</code> <span class="bar">|</span> <code class="koka">(</code> <span class="bar">|</span> <code class="koka">)</code> <span class="bar">|</span> <code class="koka">[</code> <span class="bar">|</span> <code class="koka">]</code> <span class="bar">|</span> <code class="code code2"><span class="code-escaped">&#124;</span></code> <span class="bar">|</span> <code class="koka">;</code> <span class="bar">|</span> <code class="koka">,</code>                                 </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="17" data-col="1"> &#160;       </td><td class="tbody tr-odd tr-last col col-even" data-row="17" data-col="2">       </td><td class="tbody tr-odd tr-last col col-odd" data-row="17" data-col="3">                                                                                                                                                       </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="17" data-col="4">    </td></tr></tbody></table><h3 id="sec-literals" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-literals" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.2.4</span>.&#8194;</span>Literals</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">string</em>      </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=    </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="code code2">@&quot;</code> <span class="many">{ <em class="em-low1">graphic</em><sub>&#60;<code class="code code2">&quot;</code>&#62;</sub> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">tab</em> <span class="bar">|</span> <em class="em-low1">newline</em> <span class="bar">|</span> <code class="code code2">&quot;&quot;</code> }</span> <code class="code code2">&quot;</code> </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4"> (raw string) </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <code class="code code2">&quot;</code> <span class="many">{ <em class="em-low1">graphic</em><sub>&#60;<code class="code code2">&quot;</code><span class="bar">|</span><code class="code code2">\</code>&#62;</sub> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">escape</em> }</span> <code class="code code2">&quot;</code>                     </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">char</em>        </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <code class="code code2">&#39;</code> ( <em class="em-low1">graphic</em><sub>&#60;<code class="code code2">&#39;</code><span class="bar">|</span><code class="code code2">\</code>&#62;</sub> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">escape</em> ) <code class="code code2">&#39;</code>                          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="4" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3">                                                                                                                           </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">escape</em>      </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="code code2">\</code> ( <em class="em-low1">charesc</em> <span class="bar">|</span> <em class="em-low1">hexesc</em> )                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">charesc</em>     </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka">n</code> <span class="bar">|</span> <code class="koka">r</code> <span class="bar">|</span> <code class="koka">t</code> <span class="bar">|</span> <code class="code code2">\</code> <span class="bar">|</span> <code class="code code2">&quot;</code> <span class="bar">|</span> <code class="code code2">&#39;</code>                                                      </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">hexesc</em>      </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka">x</code> <em class="em-low1">hexdigit</em><sub>2</sub> <span class="bar">|</span>   <code class="koka">u</code> <em class="em-low1">hexdigit</em><sub>4</sub> <span class="bar">|</span>   <code class="code code2">U</code> <em class="em-low1">hexdigit</em><sub>4</sub> <em class="em-low1">hexdigit</em><sub>2</sub>                                 </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">hexdigit</em><sub>4</sub> </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">hexdigit</em> <em class="em-low1">hexdigit</em> <em class="em-low1">hexdigit</em> <em class="em-low1">hexdigit</em>                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">hexdigit</em><sub>2</sub> </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <em class="em-low1">hexdigit</em> <em class="em-low1">hexdigit</em>                                                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="10" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3">                                                                                                                           </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">float</em>       </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">decimal</em> <code class="koka"><span class="kw op">.</span></code> <em class="em-low1">decimal</em> <span class="opt">[ <em class="em-low1">exponent</em> ]</span>                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">exponent</em>    </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> (<code class="code code2">e</code> &#124;  <code class="code code2">E</code>) <span class="opt">[ <code class="code code2">-</code> &#124;  <code class="code code2">+</code> ]</span> <em class="em-low1">decimal</em>                                                                     </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">natural</em>     </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">decimal</em> <span class="bar">|</span> <code class="koka"><span class="number">0</span></code> &#160; (<code class="code code2">x</code> &#124;  <code class="code code2">X</code>) <em class="em-low1">hexadecimal</em>                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">decimal</em>     </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">digit</em> <span class="many">{ <em class="em-low1">digit</em> }</span>                                                                                                  </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">              </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">hexadecimal</em> </td><td class="tbody tr-odd tr-last col col-even" data-row="15" data-col="2"> ::=    </td><td class="tbody tr-odd tr-last col col-odd" data-row="15" data-col="3"> <em class="em-low1">hexdigit</em> <span class="many">{ <em class="em-low1">hexdigit</em> }</span>                                                                                            </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="15" data-col="4">              </td></tr></tbody></table><h3 id="sec-white-space" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-white-space" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.2.5</span>.&#8194;</span>White space</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">whitespace</em>    </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=    </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">white</em> <span class="many">{ <em class="em-low1">white</em> }</span> <span class="bar">|</span> <em class="em-low1">newline</em>                                                                           </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">white</em>         </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">space</em>                                                                         </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">                 </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">linecomment</em> <span class="bar">|</span> <em class="em-low1">blockcomment</em>                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">                 </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">linedirective</em>                                                                                    </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> &#160;          </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3">                                                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">linecomment</em>   </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="code code2">//</code> <span class="many">{ <em class="em-low1">linechar</em> }</span>                                                                  </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">linedirective</em> </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">newline</em> <code class="code code2">#</code> <span class="many">{ <em class="em-low1">linechar</em> }</span>                                            </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">linechar</em>      </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">graphic</em> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">tab</em>                                          </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;          </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">blockcomment</em>  </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code>/&#42;</code> <em class="em-low1">blockpart</em> <span class="many">{ <em class="em-low1">blockcomment</em> <em class="em-low1">blockpart</em> }</span> <code>&#42;/</code>            </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (allows nested comments) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">blockpart</em>     </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">blockchars</em><sub>&#60;<em class="em-low1">blockchars</em>&#160;(<code>/&#42;</code><span class="bar">|</span><code>&#42;/</code>)&#160;<em class="em-low1">blockchars</em>&#62;</sub> </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">blockchars</em>    </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <span class="many">{ <em class="em-low1">blockchar</em> }</span>                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                          </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">blockchar</em>     </td><td class="tbody tr-odd tr-last col col-even" data-row="13" data-col="2"> ::=    </td><td class="tbody tr-odd tr-last col col-odd" data-row="13" data-col="3"> <em class="em-low1">graphic</em> <span class="bar">|</span> <em class="em-low1">utf8</em> <span class="bar">|</span> <em class="em-low1">space</em> <span class="bar">|</span> <em class="em-low1">tab</em> <span class="bar">|</span> <em class="em-low1">newline</em>                       </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="13" data-col="4">                          </td></tr></tbody></table><h3 id="sec-character-classes" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-character-classes" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.2.6</span>.&#8194;</span>Character classes</h3><table class="grammar lex madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">letter</em>   </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=    </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">upper</em> <span class="bar">|</span> <em class="em-low1">lower</em>                </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">upper</em>    </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <code class="code code2">A..Z</code>                                  </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">lower</em>    </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <code class="code code2">a..z</code>                                  </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">digit</em>    </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <code class="code code2">0..9</code>                                  </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">hexdigit</em> </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="code code2">a..f</code> <span class="bar">|</span> <code class="code code2">A..F</code> <span class="bar">|</span> <em class="em-low1">digit</em> </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> &#160;     </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3">                                         </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">newline</em>  </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <span class="opt">[ <em class="em-low1">return</em> ]</span> <em class="em-low1">linefeed</em>             </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4"> (windows or unix style end of line) </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> &#160;     </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3">                                         </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">space</em>    </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="code code2">x20</code>                                   </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (a space)                           </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">tab</em>      </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="code code2">x09</code>                                   </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (a tab (<code class="code code2">\t</code>))                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">linefeed</em> </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="code code2">x0A</code>                                   </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4"> (a line feed (<code class="code code2">\n</code>))                </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">return</em>   </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <code class="code code2">x0D</code>                                   </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4"> (a carriage return (<code class="code code2">\r</code>))          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">graphic</em>  </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <code class="code code2">x21</code>..<code class="code code2">x7E</code>                            </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4"> (a visible character)               </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> &#160;     </td><td class="tbody tr-even col col-even" data-row="14" data-col="2">        </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3">                                         </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">utf8</em>     </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> ::=    </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <code class="code code2">xC0</code> <code class="code code2">x80</code>                             </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4"> (encoded 0 character)               </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> (<code class="code code2">xC2</code>..<code class="code code2">xDF</code>) <em class="em-low1">cont</em>                   </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <code class="code code2">xE0</code> (<code class="code code2">xA0</code>..<code class="code code2">xBF</code>) <em class="em-low1">cont</em>             </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="18" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3"> (<code class="code code2">xE1</code>..<code class="code code2">xEC</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em>            </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <code class="code code2">xED</code> (<code class="code code2">x80</code>..<code class="code code2">x9F</code>) <em class="em-low1">cont</em>             </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> (<code class="code code2">xEE</code>..<code class="code code2">xEF</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em>            </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3"> <code class="code code2">xF0</code> (<code class="code code2">x90</code>..<code class="code code2">xBF</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em>      </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> (<code class="code code2">xF1</code>..<code class="code code2">xF3</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em> <em class="em-low1">cont</em>     </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3"> <code class="code code2">xF4</code> (<code class="code code2">x80</code>..<code class="code code2">x8F</code>) <em class="em-low1">cont</em> <em class="em-low1">cont</em>      </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">                                     </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="24" data-col="1"> <em class="em-low1">cont</em>     </td><td class="tbody tr-even tr-last col col-even" data-row="24" data-col="2"> ::=    </td><td class="tbody tr-even tr-last col col-odd" data-row="24" data-col="3"> <code class="code code2">x80</code>..<code class="code code2">xBF</code>                            </td><td class="tbody tr-even tr-last col col-even col-last" data-row="24" data-col="4">                                     </td></tr></tbody></table><!--
### Semicolons?

Many languages have rules to avoid writing semicolons to separate
statements. Even though most of the time these rules are quite intuitive
to use, their actual definition can be quite subtle. For example,
both [Scala][lscala] and [Go][lgo] require remembering specific tokens to
know precisely when semicolon insertion takes place. In the case
of [JavaScript][ljavascript] and [Haskell][lhaskell] (I am sad to admit)
the precise behavior is bizarrely complex where semicolon insertion
depends on the interaction between the lexer and parser.

In Koka, the grammar is carefully constructed to not need any statement
separator at all and semicolons are never required by the grammar.
They are still allowed in the grammar but strictly to help new programmers
that are used to putting semicolons at the end of statements.

The construction of a grammar that does not need statement separators is
also good from a human perspective. The reason semicolons are required is
to resolve ambiguities in the syntax. When such ambiguities do not occur
in the first place, that also removes a cognitive burden from the
programmer. In particular, Koka statements often start with a keyword,
like <code class="koka"><span class="kw">val</span></code> or <code class="koka"><span class="kw">match</span></code>, signifying intention to both programmer and parser.

In other cases, we restrict the expression grammar. For example, one
reason why C requires semicolons is due to prefix- and postfix operators.
If we write ``p ++ q`` the C parser needs a semicolon in order to know if
we meant ``p++; q`` or ``p; ++q``. Such ambiguity is resolved in Koka by
not having postfix operators and restricting prefix operators to ``!``
and ``~``.

One other reason that Koka can do without a statement separator is the
effect inference system: without such effect inference subtle bugs may
occur if we leave out semicolons. For example, consider the following
function:
<pre class="koka source"><span class="plaincode">fun square( x : int ) {
  x &#42; x
}
</span><span class="nicecode"><span class="decl-fun" id="square"><span class="kw">fun</span> <a class="pp" href="#square">square<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>square: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) {
  <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a>
</span>}
</span></pre>
which returns the square of <code class="koka">x</code>. Suppose now that we forgot to put
in the multiplication operation, giving:
<pre class="koka source unchecked"><span class="plaincode">fun square-wrong( x : int ) {
  x x
}
</span><span class="nicecode"><span class="kw">fun</span> square<span class="dash">-</span>wrong( x <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) {
  x x
}
</span></pre>
The Koka grammar sees this as 2 separate statements now, &ie; as ``x; x``
returning ``x`` instead. In a language without effect inference it is hard
to detect such errors, but the Koka type system rejects this program:

    > fun square-wrong(x:int) { x x }
                                ^
    ((1),27): error: expression has no effect and is unused
      hint: did you forget an operator? or is there a space between an application?


[LHaskell]: http://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17800010.3  
[LPython]: http://docs.python.org/2/reference/lexical_analysis.html
[LJavaScript]: https://tc39.github.io/ecma262/#sec-rules-of-automatic-semicolon-insertion
[LScala]: http://www.scala-lang.org/old/sites/default/files/linuxsoft_archives/docu/files/ScalaReference.pdf#page=13
[LGo]: http://golang.org/ref/spec#Semicolons

-->


<h2 id="sec:layout" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec:layout" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.3</span>.&#8194;</span>Semicolon insertion</h2>
<p class="p noindent">Just like programming languages like
<a href="http://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17800010.3" data-linkid="haskell">Haskell</a>,&nbsp;<a href="http://docs.python.org/2/reference/lexical_analysis.html" data-linkid="python">Python</a>,&nbsp;<a href="https://tc39.github.io/ecma262/#sec-rules-of-automatic-semicolon-insertion" data-linkid="javascript">JavaScript</a>,&nbsp;<a href="http://www.scala-lang.org/old/sites/default/files/linuxsoft_archives/docu/files/ScalaReference.pdf#page=13" data-linkid="scala">Scala</a>,&nbsp;<a href="http://golang.org/ref/spec#Semicolons" data-linkid="go">Go</a>, etc., there is a layout rule
which automatically adds semicolons at appropriate places. This enables the
programmer to leave out most semicolons:
</p>
<p class="p indent" style="padding-left:1em">Koka inserts semicolons automatically for any statements
and declarations that are <em class="em-low1">aligned between curly braces</em> (<code class="koka">{</code> and <code class="koka">}</code>).</p>
<p class="p grammar indent">For example, in the following program:</p><pre class="koka source"><span class="plaincode">fun eq1( x : int, y : int ) : io bool
{  
  print("calculate equality")
  val result = if (x == y) then True            
                else False
  result
}  
</span><span class="nicecode"><span class="decl-fun" id="eq1"><span class="kw">fun</span> <a class="pp" href="#eq1">eq1<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>eq1: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">bool</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>
{  
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"calculate equality"</span>)
  <span class="kw">val</span> <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>            
                <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
  <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a>
</span>}  
</span></pre>



<p class="p noindent">we get semicolons before each statement that was aligned between the braces:
</p><pre class="koka source"><span class="plaincode">fun eqSemi( x : int, y : int ) : io bool
{;  
  print("calculate equality");
  val result = if (x == y) then True            
                else False;
  result;
}  
</span><span class="nicecode"><span class="decl-fun" id="eqSemi"><span class="kw">fun</span> <a class="pp" href="#eqSemi">eqSemi<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>eqSemi: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">bool</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>
{;  
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"calculate equality"</span>);
  <span class="kw">val</span> <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>            
                <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>;
  <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a>;
</span>}  
</span></pre>



<p class="p noindent">Since semicolons are only inserted for <em class="em-low1">aligned</em> statements, we can
write a long statement on multiple lines by using more indentation:
</p><pre class="koka source"><span class="plaincode">fun eq2( x : int, y : int ) : io bool
{  
  print("calculate " +
         "equ" +
         "ality")
  val result = if (x == y)
                then True
                else False
  result
}  
</span><span class="nicecode"><span class="decl-fun" id="eq2"><span class="kw">fun</span> <a class="pp" href="#eq2">eq2<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>eq2: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">bool</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a>
{  
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"calculate "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__6">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.6</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
         <span class="st">"equ"</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_plus__6">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.6</span>: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>
         <span class="st">"ality"</span>)
  <span class="kw">val</span> <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a> <span class="kw">=</span> <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>)
                <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>
                <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
  <a class="pp">result<span class="pc">result: <span class="tp">bool</span></span></a>
</span>}  
</span></pre>



<p class="p noindent">In contrast to token-based layout rules (as in&nbsp;<a href="http://www.scala-lang.org/old/sites/default/files/linuxsoft_archives/docu/files/ScalaReference.pdf#page=13" data-linkid="scala">Scala</a> or&nbsp;<a href="http://golang.org/ref/spec#Semicolons" data-linkid="go">Go</a> for example), this
allows you to put line breaks at any point in a statement by just indenting
more. Moreover, it means that the visual indentation of a program corresponds
directly to how the compiler interprets the statements. Many tricky layout
examples in other programming languages are often based on a mismatch between
the visual representation and how a compiler interprets the tokens &#8211; with
Koka&#39;s layout rule such issues are largely avoided.
</p>
<p class="p grammar indent">To still allow for &#8220;block-style&#8221; layout, the
layout rule does not insert a  semicolon for an aligned statement if it
starts with <code class="koka"><span class="kw">then</span></code>, <code class="koka"><span class="kw">else</span></code>, <code class="koka"><span class="kw">elif</span></code>, or one of <code class="koka">{</code>, <code class="koka">,</code>, <code class="koka">)</code>, or <code class="koka">]</code>.</p><pre class="koka source"><span class="plaincode">fun bar()
{  
  val xs = [
    "list",
    "elements",
  ]
  if (is-odd(3&#42;3))
  {
    print("odd")
  }
  else
    print("even")
}  
</span><span class="nicecode"><span class="decl-fun" id="bar"><span class="kw">fun</span> <a class="pp" href="#bar">bar<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>bar: <span class="tp sp">(</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>()
{  
  <span class="kw">val</span> <a class="pp">xs<span class="pc">xs: <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp">string</span><span class="tp sp">&gt;</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Cons"><span class="co">[</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Cons: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">head</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">tail</span> <span class="tp kw op">:</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
    <span class="st">"list"</span>,
    <span class="st">"elements"</span>,
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#con_space_Nil"><span class="co">]</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nil: <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span> <span class="tp">list</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span></span></a>
  <span class="kw">if</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#is_odd">is-odd<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>is<span class="dash">-</span>odd: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>(<span class="number">3</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">3</span>))
  {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"odd"</span>)
  }
  <span class="kw">else</span>
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"even"</span>)
</span>}  
</span></pre>



<p class="p noindent">Of course, it is still allowed to use semicolons explicitly which can be used
for example to put multiple statements on a single line:
</p><pre class="koka source"><span class="plaincode">fun equalLine( x : int, y : int ) : io bool {
  print("calculate equality"); (x == y)
}  
</span><span class="nicecode"><span class="decl-fun" id="equalLine"><span class="kw">fun</span> <a class="pp" href="#equalLine">equalLine<span class="pc"><span class="mo">spec<span class="fslash last">/</span></span>equalLine: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">io</span> <span class="tp">bool</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp"><span class="effect">io</span></span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#print">print<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>print: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">console</span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"calculate equality"</span>); (<a class="pp">x<span class="pc">x: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#_eq__eq__1">==<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(==)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">int</span></span></a>)
</span>}  
</span></pre>



<p class="p noindent">The layout algorithm also checks for invalid layouts where the layout would
not visually correspond to how the compiler interprets the tokens. In
particular, it is illegal to indent less than the layout context or to put
comments into the indentation (because of tabs or potential unicode
characters). For example, the program:
</p><pre class="koka source unchecked"><span class="plaincode">fun equal( x : int, y : int ) : io bool {   
    print("calculate equality")
  result = if (x == y) then True   // wrong: too little indentation
  /&#42; wrong &#42;/      else False
    result
}  
</span><span class="nicecode"><span class="kw">fun</span> equal( x <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, y <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {   
    print(<span class="st">"calculate equality"</span>)
  result <span class="kw">=</span> <span class="kw">if</span> (x <span class="op">==</span> y) <span class="kw">then</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a>   <span class="comment">// wrong: too little indentation
</span>  <span class="comment">/&#42; wrong &#42;/</span>      <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core_types.html#con_space_False"><span class="co">False</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash">/</span>types<span class="fslash last">/</span></span>False: <span class="tp">bool</span></span></a>
    result
}  
</span></pre>



<p class="p noindent">is rejected. In order to facilitate code generation or source code
compression, compilers are also required to support a mode where the layout
rule is not applied and where no semicolons are inserted. A recognized command
line flag for that mode should be <code class="code code2">--nosemi</code>.
</p><h3 id="sec-the-layout-algorithm" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-the-layout-algorithm" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.3.1</span>.&#8194;</span>The layout algorithm</h3>
<p class="p noindent">A nice property of the layout
algorithm is that it is performed on the token stream in-between lexing
and parsing, and is independent of both. In particular, there are no intricate dependencies with the parser
that lead to bizarrely complex layout rules, as is the case in languages like
<a href="http://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-17800010.3" data-linkid="haskell">Haskell</a> or&nbsp;<a href="https://tc39.github.io/ecma262/#sec-rules-of-automatic-semicolon-insertion" data-linkid="javascript">JavaScript</a>.
</p>
<p class="p indent">To define the layout algorithm formally, we first establish some terminology:
</p>
<ul class="ul list-star compact">
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">A new line is started after every <em class="em-low1">linefeed</em> character.
</li>
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">Any non-<em class="em-low1">white</em> token is called a <em class="em-low1">lexeme</em>, where a line without lexemes
is called <em class="em-low1">blank</em>.
</li>
<li class="li ul-li list-star-li compact-li" style="margin-bottom:1ex">The indentation of a lexeme is the column number of its first character on
that line (starting at 1), and the indentation of a line is the indentation
of the first lexeme on the line.
</li></ul>

<p class="p noindent">Because braces can be nested, we use a <em class="em-low1">layout stack</em> of strictly
increasing indentations. The top indentation on the layout stack holds the
<em class="em-low1">layout indentation</em>. The initial layout stack contains the single
value 0 (which is never popped). We now proceed through the token stream
where we perform the operations on the layout stack before the semicolon insertion:
</p>
<ul class="ul list-star grammar loose">
<li class="li ul-li list-star-li grammar-li loose-li" style="margin-bottom:1ex">
<p><em class="em-low1">Layout stack operations</em>: If the previous lexeme was an
open brace <code class="koka">{</code> or the start of the lexical token sequence, we push the
indentation of the current lexeme on the layout stack. The pushed indentation
must be larger than the previous layout indentation (unless the current lexeme
is a closing brace).  When a closing brace <code class="koka">}</code> is encountered the top
indentation is popped from the layout stack.
</p></li>
<li class="li ul-li list-star-li grammar-li loose-li" style="margin-bottom:1ex">
<p><em class="em-low1">Semicolon insertion</em>: For each non-blank line, the
indentation must be equal or larger to the layout indentation. A semicolon is
inserted before the line whenever the indentation is equal, unless the first
lexeme on the line is one of <code class="koka"><span class="kw">then</span></code>, <code class="koka"><span class="kw">else</span></code>, <code class="koka"><span class="kw">elif</span></code>, or one of <code class="koka">{</code>, <code class="koka">,</code>, <code class="koka">)</code>, or
<code class="koka">]</code>. Also, a semicolon is always inserted before a closing brace <code class="koka">}</code> and
before the end of the token sequence.
</p></li></ul>

<p class="p noindent">As defined, semicolons are inserted whenever statements or declarations are
aligned, unless the lexeme happens to be a clear statement continuation. To
simplify the grammar specification, a semicolon is also always inserted before
a closing brace and the end of the source. This allows us to specify many
grammar elements as ended by semicolons instead of separated by semicolons
which is more difficult to specify for a LALR(1) grammar.
</p>
<p class="p indent">Semicolon insertion can be easily implemented as part of the lexer, but could
also be implemented as a straightforward transformation on the lexical token
stream.
</p><h3 id="sec:lex-implementation" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec:lex-implementation" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.3.2</span>.&#8194;</span>Implementation</h3>
<p class="p noindent">There is a full&nbsp;<a href="https://koka.codeplex.com/SourceControl/latest#doc/spec/grammar/lexer.lex" data-linkid="flexlexer">Flex (Lex) implementation</a> of lexical
analysis and the layout algorithm.
Ultimately, the Flex implementation serves as <em class="em-low1">the</em>
specification, and this document and the Flex implementation should
always be in agreement.
</p><h2 id="sec-context-free-syntax" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-context-free-syntax" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4</span>.&#8194;</span>Context-free syntax</h2>
<p class="p noindent">The grammar specification starts with the non terminal <em class="em-low1">module</em> which draws
its lexical tokens from <em class="em-low1">lex</em> where all <em class="em-low1">whitespace</em> tokens are implicitly
ignored.
</p><h3 id="sec-modules" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-modules" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.1</span>.&#8194;</span>Modules</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">module</em><sub><span class="opt">[ <em class="em-low1">lex</em> ]</span></sub> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <span class="opt">[ <em class="em-low1">moduledecl</em> ]</span> <em class="em-low1">modulebody</em>                 </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;                  </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                   </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">moduledecl</em>            </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">semis</em>  <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <code class="koka"></code> <em class="em-low1">moduleid</em> </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">moduleid</em>              </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">qvarid</em> <span class="bar">|</span> <em class="em-low1">varid</em>                         </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> &#160;                  </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3">                                                   </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">modulebody</em>            </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <em class="em-low1">declarations</em> <code class="koka">}</code> <em class="em-low1">semis</em>            </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">                         </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">semis</em> <em class="em-low1">declarations</em>                            </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> &#160;                  </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3">                                                   </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">visibility</em>            </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka"><span class="kw">public</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">private</span></code>                       </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">semis</em>                 </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <span class="many">{ <code class="koka">;</code> }</span>                                      </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">semi</em>                  </td><td class="tbody tr-odd tr-last col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd tr-last col col-odd" data-row="11" data-col="3"> <code class="koka">;</code> <em class="em-low1">semis</em>                                         </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="11" data-col="4">   </td></tr></tbody></table><h3 id="sec-top-level-declarations" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-top-level-declarations" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.2</span>.&#8194;</span>Top level declarations</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">declarations</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <span class="many">{ <em class="em-low1">import</em> }</span> <span class="many">{ <em class="em-low1">fixitydecl</em> }</span> <em class="em-low1">topdecls</em>                                    </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">import</em>       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <code class="koka"><span class="kw">import</span></code> <span class="opt">[ <em class="em-low1">moduleid</em> <code class="koka"><span class="kw">=</span></code> ]</span> <em class="em-low1">moduleid</em> <em class="em-low1">semi</em>                </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="4" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3">                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">fixitydecl</em>   </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">fixity</em> <em class="em-low1">natural</em> <em class="em-low1">identifier</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">identifier</em> }</span> <em class="em-low1">semi</em> </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">fixity</em>       </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka"><span class="kw">infixl</span></code>                                                                              </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">                </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="kw">infixr</span></code>                                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">                </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="kw">infix</span></code>                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;         </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">topdecls</em>     </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <span class="many">{ <em class="em-low1">topdecl</em> <em class="em-low1">semi</em> }</span>                                                             </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">topdecl</em>      </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">puredecl</em>                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1">                </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">aliasdecl</em>                                                      </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1">                </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">typedecl</em>                                                       </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1">                </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <em class="em-low1">externdecl</em>                                                     </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">   </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="15" data-col="1">                </td><td class="tbody tr-odd tr-last col col-even" data-row="15" data-col="2"> &#124; </td><td class="tbody tr-odd tr-last col col-odd" data-row="15" data-col="3"> <code class="koka"><span class="kw">abstract</span></code> <em class="em-low1">typedecl</em>                                                                </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="15" data-col="4">   </td></tr></tbody></table><h3 id="sec-type-declarations" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-type-declarations" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.3</span>.&#8194;</span>Type declarations</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">aliasdecl</em>   </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="koka"><span class="tp kw">alias</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">type</em>                                          </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">typedecl</em>    </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">typemod</em> <code class="koka"><span class="tp kw">type</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <span class="opt">[ <em class="em-low1">typebody</em> ]</span>                         </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">structmod</em> <code class="koka"><span class="tp kw">struct</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <span class="opt">[ <em class="em-low1">conparams</em> ]</span>                    </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <span class="opt">[ <em class="em-low1">opdecls</em> ]</span>                      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <em class="em-low1">opdecl</em>                                        </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka"><span class="kw">named</span></code> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <em class="em-low1">typeid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <span class="opt">[ <em class="em-low1">opdecls</em> ]</span>              </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="kw">named</span></code> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <em class="em-low1">opdecl</em>                                </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="kw">named</span></code> <em class="em-low1">effectmod</em> <code class="koka"><span class="tp kw">effect</span></code> <em class="em-low1">varid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">kannot</em> ]</span> <code class="koka"><span class="kw">in</span></code> <em class="em-low1">type</em> <span class="opt">[ <em class="em-low1">opdecls</em> ]</span>   </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                                                            </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">typemod</em>     </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="koka">co</code> <span class="bar">|</span> <code class="koka">rec</code> <span class="bar">|</span> <code class="koka">open</code> <span class="bar">|</span> <code class="koka"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core.html#extend">extend<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>extend: <span class="tp sp">(</span><span class="tp tpp">slice</span> <span class="tp kw op">:</span> <span class="tp">sslice</span><span class="tp sp">,</span> <span class="tp tpp">count</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">sslice</span></span></a></code> <span class="bar">|</span> <em class="em-low1">structmod</em>                                 </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">structmod</em>   </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="koka">value</code> <span class="bar">|</span> <code class="koka">reference</code>                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> <em class="em-low1">effectmod</em>   </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <span class="opt">[ <code class="koka">linear</code> ]</span> <span class="opt">[ <code class="koka">rec</code> ]</span>                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3">                                                                                                            </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">typeid</em>      </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">varid</em>                                                                                                    </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <code class="code code2">[]</code>                                                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <code class="koka">(</code> <span class="many">{ <code class="koka">,</code> }</span> <code class="koka">)</code>                                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <code class="koka"><span class="op">&#62;</span></code>                                                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="18" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <span class="koka code">&#124;</span> <code class="koka"><span class="op">&#62;</span></code>                                                                              </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3">                                                                                                            </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1"> <em class="em-low1">typeparams</em>  </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <span class="opt">[ <em class="em-low1">tbinders</em> ]</span> <code class="koka"><span class="op">&#62;</span></code>                                                                                 </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1"> <em class="em-low1">tbinders</em>    </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3"> <em class="em-low1">tbinder</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">tbinder</em> }</span>                                                                           </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1"> <em class="em-low1">tbinder</em>     </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <em class="em-low1">varid</em> <span class="opt">[ <em class="em-low1">kannot</em> ]</span>                                                                                   </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1"> <em class="em-low1">typebody</em>    </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">constructor</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                                                              </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="24" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="24" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="24" data-col="3">                                                                                                            </td><td class="tbody tr-even col col-even col-last" data-row="24" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="25" data-col="1"> <em class="em-low1">constructor</em> </td><td class="tbody tr-odd col col-even" data-row="25" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="25" data-col="3"> <span class="opt">[ <code class="koka"><span class="kw">con</span></code> ]</span> <em class="em-low1">conid</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <span class="opt">[ <em class="em-low1">conparams</em> ]</span>                                             </td><td class="tbody tr-odd col col-even col-last" data-row="25" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="26" data-col="1"> <em class="em-low1">conparams</em>   </td><td class="tbody tr-even col col-even" data-row="26" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="26" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">conparam</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                                                                 </td><td class="tbody tr-even col col-even col-last" data-row="26" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="27" data-col="1"> <em class="em-low1">conparam</em>    </td><td class="tbody tr-odd col col-even" data-row="27" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="27" data-col="3"> (<em class="em-low1">paramid</em> <span class="bar">|</span> <em class="em-low1">wildcard</em>) <code class="code code2">:</code> <em class="em-low1">paramtype</em> <span class="opt">[ <code class="koka"><span class="kw">=</span></code> <em class="em-low1">expr</em> ]</span>                                       </td><td class="tbody tr-odd col col-even col-last" data-row="27" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="28" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="28" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="28" data-col="3">                                                                                                            </td><td class="tbody tr-even col col-even col-last" data-row="28" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="29" data-col="1"> <em class="em-low1">opdecls</em>     </td><td class="tbody tr-odd col col-even" data-row="29" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="29" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">opdecl</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                                                                   </td><td class="tbody tr-odd col col-even col-last" data-row="29" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="30" data-col="1"> <em class="em-low1">opdecl</em>      </td><td class="tbody tr-even col col-even" data-row="30" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="30" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> <code class="koka"><span class="kw">val</span></code> <em class="em-low1">identifier</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span>  <code class="code code2">:</code> <em class="em-low1">tatom</em>                                </td><td class="tbody tr-even col col-even col-last" data-row="30" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="31" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="31" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="31" data-col="3"> <span class="opt">[ <em class="em-low1">visibility</em> ]</span> (<code class="koka"><span class="kw">fun</span></code> <span class="bar">|</span> <code class="koka"><span class="kw">control</span></code>) <em class="em-low1">identifier</em> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <em class="em-low1">opparams</em> <code class="code code2">:</code> <em class="em-low1">tatom</em> </td><td class="tbody tr-odd col col-even col-last" data-row="31" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="32" data-col="1"> <em class="em-low1">opparams</em>    </td><td class="tbody tr-even col col-even" data-row="32" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="32" data-col="3"> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">opparam</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">opparam</em> }</span> ]</span> <code class="koka">)</code>                                                           </td><td class="tbody tr-even col col-even col-last" data-row="32" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="33" data-col="1"> <em class="em-low1">opparam</em>     </td><td class="tbody tr-odd tr-last col col-even" data-row="33" data-col="2"> ::=   </td><td class="tbody tr-odd tr-last col col-odd" data-row="33" data-col="3"> <span class="opt">[ <em class="em-low1">paramid</em> ]</span> <code class="code code2">:</code> <em class="em-low1">paramtype</em>                                                                        </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="33" data-col="4">    </td></tr></tbody></table><h3 id="sec-value-and-function-declarations" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-value-and-function-declarations" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.4</span>.&#8194;</span>Value and function declarations</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">puredecl</em>     </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">inlinemod</em> <code class="koka"><span class="kw">val</span></code> <em class="em-low1">valdecl</em>                                                   </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">                </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">inlinemod</em> <code class="koka"><span class="kw">fun</span></code> <em class="em-low1">fundecl</em>                                                   </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">inlinemod</em>    </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <code class="koka">inline</code> <span class="bar">|</span> <code class="koka">noinline</code>                                                  </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="4" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3">                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">valdecl</em>      </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">binder</em> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">expr</em>                                                           </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">binder</em>       </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">identifier</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">type</em> ]</span>                                             </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> &#160;         </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3">                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">fundecl</em>      </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">funid</em> <em class="em-low1">funparam</em> <em class="em-low1">bodyexpr</em>                                                 </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">funparam</em>     </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <span class="opt">[ <em class="em-low1">typeparams</em> ]</span> <em class="em-low1">parameters</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">tresult</em> ]</span> <span class="opt">[ <em class="em-low1">qualifier</em> ]</span> </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">funid</em>        </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">identifier</em>                                                                  </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1">                </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="code code2">[</code> <span class="many">{ <code class="koka">,</code> }</span> <code class="code code2">]</code>                                                      </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4"> (indexing operator)  </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="12" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3">                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">parameters</em>   </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">parameter</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">parameter</em> }</span> ]</span> <code class="koka">)</code>                          </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">parameter</em>    </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">paramid</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">paramtype</em> ]</span> <span class="opt">[ <code class="koka"><span class="kw">=</span></code> <em class="em-low1">expr</em> ]</span>                        </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">paramid</em>      </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <em class="em-low1">identifier</em> <span class="bar">|</span> <em class="em-low1">wildcard</em>                                              </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">paramtype</em>    </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <em class="em-low1">type</em>                                                                        </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1">                </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <code class="koka"><span class="op">?</span></code> <em class="em-low1">type</em>                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4"> (optional parameter) </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1"> &#160;         </td><td class="tbody tr-even col col-even" data-row="18" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3">                                                                               </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1"> <em class="em-low1">qidentifier</em>  </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <em class="em-low1">qvarid</em> <span class="bar">|</span> <em class="em-low1">qidop</em> <span class="bar">|</span> <em class="em-low1">identifier</em>                               </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1"> <em class="em-low1">identifier</em>   </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> <em class="em-low1">varid</em> <span class="bar">|</span> <em class="em-low1">idop</em>                                                       </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1"> &#160;         </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3">                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1"> <em class="em-low1">qoperator</em>    </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <em class="em-low1">op</em>                                                                          </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1"> &#160;         </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3">                                                                               </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">                      </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="24" data-col="1"> <em class="em-low1">qconstructor</em> </td><td class="tbody tr-even tr-last col col-even" data-row="24" data-col="2"> ::=   </td><td class="tbody tr-even tr-last col col-odd" data-row="24" data-col="3"> <em class="em-low1">conid</em> <span class="bar">|</span> <em class="em-low1">qconid</em>                                                     </td><td class="tbody tr-even tr-last col col-even col-last" data-row="24" data-col="4">                      </td></tr></tbody></table><h3 id="sec-statements" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-statements" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.5</span>.&#8194;</span>Statements</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">block</em>     </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="code code2">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">statement</em> <em class="em-low1">semi</em> }</span> <code class="code code2">}</code> </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;      </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                 </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">statement</em> </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">decl</em>                                          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">withstat</em>                                      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">returnexpr</em>                                    </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">basicexpr</em>                                     </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> &#160;      </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3">                                                 </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">decl</em>      </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="kw">fun</span></code> <em class="em-low1">fundecl</em>                                 </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka"><span class="kw">val</span></code> <em class="em-low1">apattern</em> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">valexpr</em>                  </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (local values can use a pattern binding) </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="10" data-col="1">             </td><td class="tbody tr-even tr-last col col-even" data-row="10" data-col="2"> &#124; </td><td class="tbody tr-even tr-last col col-odd" data-row="10" data-col="3"> <code class="koka"><span class="kw">var</span></code> <em class="em-low1">binder</em> <code class="code code2">:=</code> <em class="em-low1">valexpr</em>                 </td><td class="tbody tr-even tr-last col col-even col-last" data-row="10" data-col="4">                                          </td></tr></tbody></table><h3 id="sec-expressions" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-expressions" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.6</span>.&#8194;</span>Expressions</h3><table class="madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">bodyexpr</em>    </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">blockexpr</em>                                                            </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">block</em>                                                                     </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                                             </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">blockexpr</em>   </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">expr</em>                                                                      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4"> (<em class="em-low1">block</em> is interpreted as statements) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> &#160;        </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3">                                                                             </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> <em class="em-low1">expr</em>        </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">withexpr</em>                                                                  </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">block</em>                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4"> (interpreted as <code class="koka"><span class="kw">fn</span>(){<span class="op">...</span>}</code>)           </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">returnexpr</em>                                                                </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <em class="em-low1">basicexpr</em>                                                                 </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="10" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">basicexpr</em>   </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">ifexpr</em>                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <em class="em-low1">fnexpr</em>                                                                    </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">matchexpr</em>                                                                 </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">handlerexpr</em>                                                               </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <em class="em-low1">opexpr</em>                                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="16" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1"> <em class="em-low1">ifexpr</em>      </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <code class="koka"><span class="kw">if</span></code> <em class="em-low1">atom</em> <em class="em-low1">then</em> <span class="many">{ <em class="em-low1">elif</em> }</span> <span class="opt">[ <code class="koka"><span class="kw">else</span></code> <em class="em-low1">expr</em><sub>&#60;!<em class="em-low1">ifexpr</em>&#62;</sub> ]</span> </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1"> <em class="em-low1">then</em>        </td><td class="tbody tr-even col col-even" data-row="18" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3"> <span class="opt">[ <code class="koka"><span class="kw">then</span></code> ]</span> <em class="em-low1">expr</em><sub>&#60;!<em class="em-low1">ifexpr</em>&#62;</sub>                                    </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1"> <em class="em-low1">elif</em>        </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <code class="koka"><span class="kw">elif</span></code> <em class="em-low1">atom</em> <em class="em-low1">then</em>                                                        </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="20" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1"> <em class="em-low1">matchexpr</em>   </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3"> <code class="koka"><span class="kw">match</span></code> <em class="em-low1">atom</em> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">matchrule</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                  </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1"> <em class="em-low1">returnexpr</em>  </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <code class="koka"><span class="kw">return</span></code> <em class="em-low1">opexpr</em>                                                           </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="23" data-col="1"> <em class="em-low1">fnexpr</em>      </td><td class="tbody tr-odd col col-even" data-row="23" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="23" data-col="3"> <code class="koka"><span class="kw">fn</span></code> <em class="em-low1">funparam</em> <em class="em-low1">block</em>                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="23" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="24" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="24" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="24" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="24" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="25" data-col="1"> <em class="em-low1">handlerexpr</em> </td><td class="tbody tr-odd col col-even" data-row="25" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="25" data-col="3"> <code class="koka"><span class="kw">handler</span></code> <span class="opt">[ <code class="koka"><span class="kw">override</span></code> ]</span> <em class="em-low1">heff</em>  <em class="em-low1">opclauses</em>                            </td><td class="tbody tr-odd col col-even col-last" data-row="25" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="26" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="26" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="26" data-col="3"> <code class="koka"><span class="kw">handle</span></code> <span class="opt">[ <code class="koka"><span class="kw">override</span></code> ]</span> <em class="em-low1">heff</em> <code class="koka">(</code> <em class="em-low1">expr</em> <code class="koka">)</code> <em class="em-low1">opclauses</em>               </td><td class="tbody tr-even col col-even col-last" data-row="26" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="27" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="27" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="27" data-col="3"> <code class="koka"><span class="kw">named</span></code> <code class="koka"><span class="kw">handler</span></code> <em class="em-low1">heff</em>  <em class="em-low1">opclauses</em>                                       </td><td class="tbody tr-odd col col-even col-last" data-row="27" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="28" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="28" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="28" data-col="3"> <code class="koka"><span class="kw">named</span></code> <code class="koka"><span class="kw">handle</span></code> <em class="em-low1">heff</em> <code class="koka">(</code> <em class="em-low1">expr</em> <code class="koka">)</code> <em class="em-low1">opclauses</em>                          </td><td class="tbody tr-even col col-even col-last" data-row="28" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="29" data-col="1"> <em class="em-low1">heff</em>        </td><td class="tbody tr-odd col col-even" data-row="29" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="29" data-col="3"> <span class="opt">[ <code class="koka"><span class="op">&#60;</span></code> <em class="em-low1">tbasic</em> <code class="koka"><span class="op">&#62;</span></code> ]</span>                                                    </td><td class="tbody tr-odd col col-even col-last" data-row="29" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="30" data-col="1"> &#160;        </td><td class="tbody tr-even col col-even" data-row="30" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="30" data-col="3">                                                                             </td><td class="tbody tr-even col col-even col-last" data-row="30" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="31" data-col="1"> <em class="em-low1">withexpr</em>    </td><td class="tbody tr-odd col col-even" data-row="31" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="31" data-col="3"> <em class="em-low1">withstat</em> <code class="koka"><span class="kw">in</span></code> <em class="em-low1">expr</em>                                                      </td><td class="tbody tr-odd col col-even col-last" data-row="31" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="32" data-col="1"> <em class="em-low1">withstat</em>    </td><td class="tbody tr-even col col-even" data-row="32" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="32" data-col="3"> <code class="koka"><span class="kw">with</span></code> <em class="em-low1">basicexpr</em>                                                          </td><td class="tbody tr-even col col-even col-last" data-row="32" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="33" data-col="1">               </td><td class="tbody tr-odd col col-even" data-row="33" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="33" data-col="3"> <code class="koka"><span class="kw">with</span></code> <em class="em-low1">binder</em> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">basicexpr</em>                                             </td><td class="tbody tr-odd col col-even col-last" data-row="33" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="34" data-col="1">               </td><td class="tbody tr-even col col-even" data-row="34" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="34" data-col="3"> <code class="koka"><span class="kw">with</span></code> <span class="opt">[ <code class="koka"><span class="kw">override</span></code> ]</span> <em class="em-low1">heff</em>  <em class="em-low1">opclauses</em>                               </td><td class="tbody tr-even col col-even col-last" data-row="34" data-col="4"> (with a handler)                       </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="35" data-col="1">               </td><td class="tbody tr-odd tr-last col col-even" data-row="35" data-col="2">       </td><td class="tbody tr-odd tr-last col col-odd" data-row="35" data-col="3"> <code class="koka"><span class="kw">with</span></code> <em class="em-low1">binder</em> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">heff</em>  <em class="em-low1">opclauses</em>                                     </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="35" data-col="4"> (with a named andler)                  </td></tr></tbody></table>
<p class="p noindent">{.grammar .parse}
</p><h3 id="sec-operator-expressions" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-operator-expressions" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.7</span>.&#8194;</span>Operator expressions</h3>
<p class="p noindent">For simplicity, we parse all operators as if they are left associative with
the same precedence. We assume that a separate pass in the compiler will use
the fixity declarations that are in scope to properly associate all operators
in an expressions.
</p><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">opexpr</em>     </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">prefix</em> <span class="many">{ <em class="em-low1">qoperator</em> <em class="em-low1">prefixexpr</em> }</span>   </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">prefixexpr</em> </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <span class="many">{ <code class="code code2">!</code> <span class="bar">|</span> <code class="code code2">~</code> }</span> <em class="em-low1">appexpr</em>      </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                              </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">appexpr</em>    </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">appexpr</em> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">arguments</em> ]</span> <code class="koka">)</code>        </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4"> (regular application)        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">appexpr</em> <code class="koka">[</code> <span class="opt">[ <em class="em-low1">arguments</em> ]</span> <code class="koka">]</code>        </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4"> (index operation)            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">appexpr</em> <span class="bar">|<em class="em-low1">fnexpr</em> [</span> <em class="em-low1">block</em>) </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4"> (apply function expressions) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">              </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">appexpr</em> <code class="koka"><span class="kw op">.</span></code> <em class="em-low1">atom</em>                         </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">              </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">atom</em>                                       </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                              </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">arguments</em>  </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">argument</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">argument</em> }</span>           </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">argument</em>   </td><td class="tbody tr-odd tr-last col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd tr-last col col-odd" data-row="11" data-col="3"> <span class="opt">[ <em class="em-low1">identifier</em> <code class="koka"><span class="kw">=</span></code> ]</span> <em class="em-low1">expr</em>              </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="11" data-col="4">                              </td></tr></tbody></table><h3 id="sec-atomic-expressions" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-atomic-expressions" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.8</span>.&#8194;</span>Atomic expressions</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">atom</em>     </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">qidentifier</em>                                                  </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">qconstructor</em>                                                 </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <em class="em-low1">literal</em>                                                      </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">mask</em>                                                         </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="koka">(</code> <code class="koka">)</code>                                                        </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4"> (unit)                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka">(</code> <em class="em-low1">annexpr</em> <code class="koka">)</code>                                              </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4"> (parenthesized expression) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">            </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka">(</code> <em class="em-low1">annexprs</em> <code class="koka">)</code>                                             </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4"> (tuple expression)         </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">            </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka">[</code> <span class="opt">[ <em class="em-low1">annexpr</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">annexprs</em> }</span> <span class="opt">[ <code class="koka">,</code> ]</span>  ]</span> <code class="koka">]</code> </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4"> (list expression)          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;     </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">literal</em>  </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">natural</em> <span class="bar">|</span> <em class="em-low1">float</em> <span class="bar">|</span> <em class="em-low1">char</em> <span class="bar">|</span> <em class="em-low1">string</em>   </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">mask</em>     </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="koka"><span class="kw">mask</span></code> <span class="opt">[ <code class="koka">behind</code> ]</span> <code class="koka"><span class="op">&#60;</span></code> <em class="em-low1">tbasic</em> <code class="koka"><span class="op">&#62;</span></code>                       </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> &#160;     </td><td class="tbody tr-even col col-even" data-row="12" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3">                                                                </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">annexprs</em> </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">annexpr</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">annexpr</em> }</span>                               </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                            </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">annexpr</em>  </td><td class="tbody tr-even tr-last col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even tr-last col col-odd" data-row="14" data-col="3"> <em class="em-low1">expr</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">typescheme</em> ]</span>                              </td><td class="tbody tr-even tr-last col col-even col-last" data-row="14" data-col="4">                            </td></tr></tbody></table><h3 id="sec-matching" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-matching" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.9</span>.&#8194;</span>Matching</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">matchrule</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">patterns</em> <code class="code code2"><span class="code-escaped">&#124;</span></code> <em class="em-low1">expr</em> <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">blockexpr</em> </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">patterns</em> <em class="em-low1">bodyexpr</em>                                    </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;      </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">apattern</em>  </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">pattern</em> <span class="opt">[ <code class="koka"></code> <em class="em-low1">typescheme</em> ]</span>                       </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">pattern</em>   </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">identifier</em>                                             </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <em class="em-low1">wildcard</em>                                               </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <em class="em-low1">qconstructor</em> [<code class="koka">(</code> <span class="opt">[ <em class="em-low1">patargs</em> ]</span> <code class="koka">)</code>]          </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">apatterns</em> ]</span> <code class="koka">)</code>                              </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4"> (unit, parenthesized pattern, tuple pattern) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka">[</code> <span class="opt">[ <em class="em-low1">apatterns</em> ]</span> <code class="koka">]</code>                              </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (list pattern)                               </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <em class="em-low1">apattern</em> <code class="koka"><span class="kw">as</span></code> <em class="em-low1">identifier</em>                             </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (named pattern)                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <em class="em-low1">literal</em>                                                </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1"> &#160;      </td><td class="tbody tr-even col col-even" data-row="12" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3">                                                          </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> <em class="em-low1">patterns</em>  </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <em class="em-low1">pattern</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">pattern</em> }</span>                         </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">apatterns</em> </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">apattern</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">apattern</em> }</span>                       </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> <em class="em-low1">patargs</em>   </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3"> <em class="em-low1">patarg</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">patarg</em> }</span>                           </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                                              </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">patarg</em>    </td><td class="tbody tr-even tr-last col col-even" data-row="16" data-col="2"> ::=   </td><td class="tbody tr-even tr-last col col-odd" data-row="16" data-col="3"> <span class="opt">[ <em class="em-low1">identifier</em> <code class="koka"><span class="kw">=</span></code> ]</span> <em class="em-low1">apattern</em>                      </td><td class="tbody tr-even tr-last col col-even col-last" data-row="16" data-col="4"> (possibly named parameter)                   </td></tr></tbody></table><h3 id="sec-operation-clauses" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-operation-clauses" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.10</span>.&#8194;</span>Operation Clauses</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">opclauses</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="koka">{</code> <em class="em-low1">semis</em> <span class="many">{ <em class="em-low1">opclause</em> <em class="em-low1">semi</em> }</span> <code class="koka">}</code>                       </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">opclause</em> <em class="em-low1">semi</em>                                                </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                                  </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">opclause</em>  </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <code class="koka"><span class="kw">val</span></code> <em class="em-low1">qidentifier</em> <span class="opt">[ <code class="koka"></code> <em class="em-low1">type</em> ]</span> <code class="koka"><span class="kw">=</span></code> <em class="em-low1">expr</em>                </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="koka"><span class="kw">fun</span></code> <em class="em-low1">qidentifier</em> <em class="em-low1">opargs</em> <em class="em-low1">bodyexpr</em>                          </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka"><span class="kw">control</span></code> <em class="em-low1">qidentifier</em> <em class="em-low1">opargs</em> <em class="em-low1">bodyexpr</em>                      </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1">             </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="kw">rcontrol</span></code> <em class="em-low1">qidentifier</em> <em class="em-low1">opargs</em> <em class="em-low1">bodyexpr</em>                     </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">             </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="kw">return</span></code>  (<code class="koka">(</code> <em class="em-low1">oparg</em> <code class="koka">)</code> <span class="bar">|</span> <em class="em-low1">paramid</em>) <em class="em-low1">bodyexpr</em> <em class="em-low1">semi</em> </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> &#160;      </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2">       </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3">                                                                  </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4">    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">opargs</em>    </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> ::=   </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="koka">(</code> <span class="opt">[ <em class="em-low1">oparg</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">oparg</em> }</span> ]</span> <code class="koka">)</code>                     </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4">    </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="11" data-col="1"> <em class="em-low1">oparg</em>     </td><td class="tbody tr-odd tr-last col col-even" data-row="11" data-col="2"> ::=   </td><td class="tbody tr-odd tr-last col col-odd" data-row="11" data-col="3"> <em class="em-low1">paramid</em> <span class="opt">[ <code class="code code2">:</code> <em class="em-low1">type</em> ]</span>                                   </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="11" data-col="4">    </td></tr></tbody></table><h3 id="sec-type-schemes" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-type-schemes" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.11</span>.&#8194;</span>Type schemes</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">typescheme</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::= </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">somes</em> <em class="em-low1">foralls</em> <em class="em-low1">tarrow</em> <span class="opt">[ <em class="em-low1">qualifier</em> ]</span> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="4">             </td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="5">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">type</em>       </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::= </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">foralls</em> <em class="em-low1">tarrow</em> <span class="opt">[ <em class="em-low1">qualifier</em> ]</span>         </td><td class="tbody tr-even col col-even" data-row="2" data-col="4">             </td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="5">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">     </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                </td><td class="tbody tr-odd col col-even" data-row="3" data-col="4">             </td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="5">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">foralls</em>    </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::= </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <span class="opt">[ <code class="koka"><span class="kw">forall</span></code> <em class="em-low1">typeparams</em> ]</span>                  </td><td class="tbody tr-even col col-even" data-row="4" data-col="4">             </td><td class="tbody tr-even col col-odd col-last" data-row="4" data-col="5">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1"> <em class="em-low1">some</em>       </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> ::= </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <span class="opt">[ <code class="koka"><span class="kw">some</span></code> <em class="em-low1">typeparams</em> ]</span>                    </td><td class="tbody tr-odd col col-even" data-row="5" data-col="4">             </td><td class="tbody tr-odd col col-odd col-last" data-row="5" data-col="5">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">     </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3">                                                </td><td class="tbody tr-even col col-even" data-row="6" data-col="4">             </td><td class="tbody tr-even col col-odd col-last" data-row="6" data-col="5">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">qualifier</em>  </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::= </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="kw">with</span></code> <code class="koka">(</code> <em class="em-low1">predicates</em> <code class="koka">)</code>                    </td><td class="tbody tr-odd col col-even" data-row="7" data-col="4">             </td><td class="tbody tr-odd col col-odd col-last" data-row="7" data-col="5">   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> &#160;       </td><td class="tbody tr-even col col-even" data-row="8" data-col="2">     </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3">                                                </td><td class="tbody tr-even col col-even" data-row="8" data-col="4">             </td><td class="tbody tr-even col col-odd col-last" data-row="8" data-col="5">   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1"> <em class="em-low1">predicates</em> </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> ::= </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <em class="em-low1">predicate</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">predicate</em> }</span>           </td><td class="tbody tr-odd col col-even" data-row="9" data-col="4">             </td><td class="tbody tr-odd col col-odd col-last" data-row="9" data-col="5">   </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="10" data-col="1"> <em class="em-low1">predicate</em>  </td><td class="tbody tr-even tr-last col col-even" data-row="10" data-col="2"> ::= </td><td class="tbody tr-even tr-last col col-odd" data-row="10" data-col="3"> <em class="em-low1">typeapp</em>                                      </td><td class="tbody tr-even tr-last col col-even" data-row="10" data-col="4"> (interface) </td><td class="tbody tr-even tr-last col col-odd col-last" data-row="10" data-col="5">   </td></tr></tbody></table><h3 id="sec-types" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-types" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.12</span>.&#8194;</span>Types</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">tarrow</em>  </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=    </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <em class="em-low1">tatom</em> <span class="opt">[ <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">tresult</em> ]</span>                                                 </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> <em class="em-low1">tresult</em> </td><td class="tbody tr-even col col-even" data-row="2" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3"> <em class="em-low1">tatom</em> <span class="opt">[ <em class="em-low1">tbasic</em> ]</span>                                                       </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1"> <em class="em-low1">tatom</em>   </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">tbasic</em>                                                                       </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <em class="em-low1">anntype</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">anntype</em> }</span> <span class="opt">[ <code class="code code2"><span class="code-escaped">&#124;</span></code> <em class="em-low1">tatom</em> ]</span> <code class="koka"><span class="op">&#62;</span></code> </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="6" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3"> <code class="koka"><span class="op">&#60;</span></code> <code class="koka"><span class="op">&#62;</span></code>                                                                        </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1"> <em class="em-low1">tbasic</em>  </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <em class="em-low1">typeapp</em>                                                                      </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka">(</code> <code class="koka">)</code>                                                                        </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (unit type)                            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="koka">(</code> <em class="em-low1">tparam</em> <code class="koka">)</code>                                                               </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (parenthesized type or type parameter) </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="koka">(</code> <em class="em-low1">tparam</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">tparam</em> }</span> <code class="koka">)</code>                                         </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4"> (tuple type or parameters)             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <code class="koka">[</code> <em class="em-low1">anntype</em> <code class="koka">]</code>                                                              </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4"> (list type)                            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1"> <em class="em-low1">typeapp</em> </td><td class="tbody tr-even col col-even" data-row="14" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="14" data-col="3"> <em class="em-low1">typecon</em> <span class="opt">[ <code class="koka"><span class="op">&#60;</span></code> <em class="em-low1">anntype</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">anntype</em> }</span> <code class="koka"><span class="op">&#62;</span></code> ]</span>                     </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="15" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="15" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1"> <em class="em-low1">typecon</em> </td><td class="tbody tr-even col col-even" data-row="16" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="16" data-col="3"> <em class="em-low1">varid</em> <span class="bar">|</span> <em class="em-low1">qvarid</em>                                                      </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="17" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="17" data-col="3"> <em class="em-low1">wildcard</em>                                                                     </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="18" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="18" data-col="3"> <code class="koka">(</code> <code class="koka">,</code> <span class="many">{ <code class="koka">,</code> }</span> <code class="koka">)</code>                                                       </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="4"> (tuple constructor)                    </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1">           </td><td class="tbody tr-odd col col-even" data-row="19" data-col="2"> &#124;  </td><td class="tbody tr-odd col col-odd" data-row="19" data-col="3"> <code class="koka">[</code> <code class="koka">]</code>                                                                        </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="4"> (list constructor)                     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1">           </td><td class="tbody tr-even col col-even" data-row="20" data-col="2"> &#124;  </td><td class="tbody tr-even col col-odd" data-row="20" data-col="3"> <code class="koka">(</code> <code class="koka"><span class="kw op">-&gt;</span></code> <code class="koka">)</code>                                                                   </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="4"> (function constructor)                 </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="21" data-col="1"> &#160;    </td><td class="tbody tr-odd col col-even" data-row="21" data-col="2">        </td><td class="tbody tr-odd col col-odd" data-row="21" data-col="3">                                                                                </td><td class="tbody tr-odd col col-even col-last" data-row="21" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="22" data-col="1"> <em class="em-low1">tparam</em>  </td><td class="tbody tr-even col col-even" data-row="22" data-col="2"> ::=    </td><td class="tbody tr-even col col-odd" data-row="22" data-col="3"> <span class="opt">[ <em class="em-low1">varid</em> <code class="code code2">:</code> ]</span> <em class="em-low1">anntype</em>                                                  </td><td class="tbody tr-even col col-even col-last" data-row="22" data-col="4">                                        </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="23" data-col="1"> <em class="em-low1">anntype</em> </td><td class="tbody tr-odd tr-last col col-even" data-row="23" data-col="2"> ::=    </td><td class="tbody tr-odd tr-last col col-odd" data-row="23" data-col="3"> <em class="em-low1">type</em> <span class="opt">[ <em class="em-low1">kannot</em> ]</span>                                                        </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="23" data-col="4">                                        </td></tr></tbody></table><h3 id="sec-kinds" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-kinds" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.13</span>.&#8194;</span>Kinds</h3><table class="grammar parse madoko block">
<tbody><tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1"> <em class="em-low1">kannot</em> </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2"> ::=   </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3"> <code class="code code2">::</code> <em class="em-low1">kind</em>                                  </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1"> &#160;   </td><td class="tbody tr-even col col-even" data-row="2" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3">                                                </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1"> <em class="em-low1">kind</em>   </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3"> <code class="koka">(</code> <em class="em-low1">kind</em> <span class="many">{ <code class="koka">,</code> <em class="em-low1">kind</em> }</span> <code class="koka">)</code> <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">kind</em> </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1">          </td><td class="tbody tr-even col col-even" data-row="4" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="4" data-col="3"> <em class="em-low1">katom</em> <code class="koka"><span class="kw op">-&gt;</span></code> <em class="em-low1">kind</em>                            </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1">          </td><td class="tbody tr-odd col col-even" data-row="5" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="5" data-col="3"> <em class="em-low1">katom</em>                                        </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="4">                              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1"> &#160;   </td><td class="tbody tr-even col col-even" data-row="6" data-col="2">       </td><td class="tbody tr-even col col-odd" data-row="6" data-col="3">                                                </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="4">                              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1"> <em class="em-low1">katom</em>  </td><td class="tbody tr-odd col col-even" data-row="7" data-col="2"> ::=   </td><td class="tbody tr-odd col col-odd" data-row="7" data-col="3"> <code class="koka"><span class="co">V</span></code>                                            </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="4"> (value type)                 </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1">          </td><td class="tbody tr-even col col-even" data-row="8" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="8" data-col="3"> <code class="koka"><span class="co">X</span></code>                                            </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="4"> (effect type)                </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1">          </td><td class="tbody tr-odd col col-even" data-row="9" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="9" data-col="3"> <code class="koka"><span class="co">E</span></code>                                            </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="4"> (effect row)                 </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1">          </td><td class="tbody tr-even col col-even" data-row="10" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="10" data-col="3"> <code class="koka"><span class="co">H</span></code>                                            </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="4"> (heap type)                  </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1">          </td><td class="tbody tr-odd col col-even" data-row="11" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="11" data-col="3"> <code class="koka"><span class="co">P</span></code>                                            </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="4"> (predicate type)             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1">          </td><td class="tbody tr-even col col-even" data-row="12" data-col="2"> &#124; </td><td class="tbody tr-even col col-odd" data-row="12" data-col="3"> <code class="koka"><span class="co">S</span></code>                                            </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="4"> (scope type)                 </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1">          </td><td class="tbody tr-odd col col-even" data-row="13" data-col="2"> &#124; </td><td class="tbody tr-odd col col-odd" data-row="13" data-col="3"> <code class="koka"><span class="co">HX</span></code>                                           </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="4"> (handled effect type)        </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="14" data-col="1">          </td><td class="tbody tr-even tr-last col col-even" data-row="14" data-col="2"> &#124; </td><td class="tbody tr-even tr-last col col-odd" data-row="14" data-col="3"> <code class="koka"><span class="co">HX1</span></code>                                          </td><td class="tbody tr-even tr-last col col-even col-last" data-row="14" data-col="4"> (handled linear effect type) </td></tr></tbody></table><h3 id="sec-implementation" class="h3" data-heading-depth="3" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-implementation" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">3.4.14</span>.&#8194;</span>Implementation</h3>
<p class="p noindent">As a companion to the Flex lexical implementation, there is a full
Bison(Yacc) LALR(1)&nbsp;<a href="https://koka.codeplex.com/SourceControl/latest#doc/spec/grammar/parser.y" data-linkid="bisongrammar">implementation</a>
available. Again, the Bison parser functions
as <em class="em-low1">the</em> specification of the grammar and this document should always
be in agreement with that implementation.
</p>
<div class="bibl" style="bbl-file:./kokaspec-bib.bbl.mdk"><h1 id="sec-references" class="clearnum h1 heading-references" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">References</h1>
<div class="bibliography bib-numeric" data-hanging-indent="0" data-cite-style="numeric:&#39;[&#39;,&#39;]&#39;,&#39;, &#39;" data-style="madoko-numeric" style="bibstyle:madoko-numeric">
<div id="leijen:msfp" class="bibitem" data-cite-year="2014" data-cite-authors="Leijen" data-cite-authors-long="Leijen" data-cite-label="1" data-line="koka.bib:29" style="text-indent:-2rem;margin-left:2rem;searchterm:Koka%3A%20Programming%20with%20Row%20Polymorphic%20Effect%20Types%20Leijen%2C%202014;spellcheck:false;bibitem-label:\5C [1\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[1]</span>Daan Leijen. &#8220;Koka: Programming with Row Polymorphic Effect Types.&#8221; In <em class="em-low1">Mathematically Structured Functional Programming 2014</em>. EPTCS.&#160;Mar. 2014. <span class="bib-urlpre"><span class="etype">arXiv:</span></span><a href="http://arxiv.org/abs/1406.2061" class="bib-url">1406.2061</a>.&nbsp;<a href="http://www.bing.com/search?q=Koka%3A%20Programming%20with%20Row%20Polymorphic%20Effect%20Types%20Leijen%2C%202014" class="bibsearch">&#128270;</a></div>
<div id="leijen:algeff" class="bibitem" data-cite-year="2016" data-cite-authors="Leijen" data-cite-authors-long="Leijen" data-cite-label="2" data-line="koka.bib:40" style="text-indent:-2rem;margin-left:2rem;searchterm:Algebraic%20Effects%20for%20Functional%20Programming%20Leijen%2C%202016;spellcheck:false;bibitem-label:\5C [2\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[2]</span>Daan Leijen. <em class="em-low1">Algebraic Effects for Functional Programming</em>. MSR-TR-2016-29. Microsoft Research. Aug. 2016. <a href="https://www.microsoft.com/en-us/research/publication/algebraic-effects-for-functional-programming" class="bib-url texturl monospace">https://&#8203;www.&#8203;microsoft.&#8203;com/&#8203;en-&#8203;us/&#8203;research/&#8203;publication/&#8203;algebraic-&#8203;effects-&#8203;for-&#8203;functional-&#8203;programming</a>. Extended version of&nbsp;<span class="citations" style="target-element:bibitem">[<a href="#leijen:algeffpopl" title="Type Directed Compilation of Row-Typed Algebraic Effects
Leijen, 2017" class="bibref localref" style="target-element:bibitem"><span class="cite-number">3</span></a>]</span>.&nbsp;<a href="http://www.bing.com/search?q=Algebraic%20Effects%20for%20Functional%20Programming%20Leijen%2C%202016" class="bibsearch">&#128270;</a></div>
<div id="leijen:algeffpopl" class="bibitem" data-cite-year="2017" data-cite-authors="Leijen" data-cite-authors-long="Leijen" data-cite-label="3" data-line="koka.bib:51" style="text-indent:-2rem;margin-left:2rem;searchterm:Type%20Directed%20Compilation%20of%20RowTyped%20Algebraic%20Effects%20Leijen%2C%202017;spellcheck:false;bibitem-label:\5C [3\5C ]"><span class="bibitem-before" style="padding-right:0.5em;display: inline-block; width:calc(2rem - 0.5em);display: inline-block; text-align:right;font-size:90%">[3]</span>Daan Leijen. &#8220;Type Directed Compilation of Row-Typed Algebraic Effects.&#8221; In <em class="em-low1">Proceedings of Principles of Programming Languages (POPL’17)</em>. Paris, France. Jan. 2017.&nbsp;<a href="http://www.bing.com/search?q=Type%20Directed%20Compilation%20of%20RowTyped%20Algebraic%20Effects%20Leijen%2C%202017" class="bibsearch">&#128270;</a></div></div></div><h1 id="sec-appendix" class="clearnum h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif">Appendix</h1><h1 id="sec-full-grammar-specification" class="h1" data-heading-depth="1" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec-full-grammar-specification" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">A</span>.&#8194;</span>Full grammar specification</h1><h2 id="sec:full-lexical" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec:full-lexical" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">A.1</span>.&#8194;</span>Lexical syntax</h2>
<div id="full-lexical" class="div"></div><h2 id="sec:full-grammar" class="h2" data-heading-depth="2" style="display:block;font-family:&#39;Nunito&#39;, &#39;Segoe UI&#39;, sans-serif"><a href="#sec:full-grammar" class="entity-anchor localref">&#x1F517;</a><span class="heading-before"><span class="heading-label">A.2</span>.&#8194;</span>Context-free syntax</h2>
<div id="full-grammar" class="div"></div></div></div></div><span data-line=""></span></div>
</body>
<script type="text/javascript">
  // ---------------------------------------------
      // Classname helpers
      // ---------------------------------------------
      function hasClassName(elem,cname) {
        if (elem==null) return false;
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        return regex.test(elem.className);
      }
      
      function removeClassName(elem,cname) {
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        elem.className = elem.className.replace( regex, "" );
      }
      
      function addClassName(elem,cname) {
        if (!hasClassName(elem,cname)) elem.className = elem.className + " " + cname;
      }
      
      function toggleClassName(elem,cname) {
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        var classes = elem.className;
        if (regex.test(classes)) {
          elem.className = classes.replace( regex, "" );
          return false;
        }
        else {
          elem.className = classes + " " + cname;
          return true;
        }
      }
      
      // ---------------------------------------------
      // Reliable offset determination
      // ---------------------------------------------
      
      function getWindowOffset(elem) {
        var box;
        if (elem.getBoundingClientRect) {
          box = elem.getBoundingClientRect();
        }
        else if (elem.offsetParent && elem.offsetParent.getBoundingClientRect) {
          // text node
          box = elem.offsetParent.getBoundingClientRect();
          box.top = box.top + elem.offsetTop;
          box.left = box.left + elem.offsetLeft;
        }
        else {
          box = { top: 0, left : 0 };
        }
        return box;
      }
      
      // Return the viewport position: -1 (before), 0 (visible), 1 (after)
      function viewportPosition(elem) {
        var pos = getWindowOffset(elem)
        if (pos.top < 0 || pos.left < 0) 
          return -1;
        else if (pos.top > (window.innerHeight || document.documentElement.clientHeight) ||
                 pos.left > (window.innerWidth || document.documentElement.clientWidth)) 
          return 1;
        else 
          return 0;
      }
      
      // ---------------------------------------------
      // Expand the toc sections and align headers with the toc.
      // ---------------------------------------------
      
      var side = document.getElementsByClassName("sidepanel")[0];
      var afterScroll = null;
      
      // Align a heading at the top of the page with the toc
      function alignHeading( elem ) {
        var ofs     = getWindowOffset(elem).top;
        var sideofs = getWindowOffset(side).top;
        if (ofs >= 0 && ofs < sideofs) {
          window.scrollBy(0, ofs - sideofs);
        } 
      }
      
      // Expand, or unexpand, one toc item
      // The class is 'auto-expands' or 'click-expands'; the latter is sticky
      // as it is user induced and will not be automatically unexpanded.
      function itemExpand(item,cls,expand) {
        // get possible toc block (that follows the item)
        var tocblock = item.nextElementSibling;
        if (tocblock==null || !hasClassName(tocblock,"tocblock")) return;
       
        // set expand class
        if (expand===undefined) expand = !hasClassName(tocblock,"expands");
        if (cls===undefined) cls = "auto-expands" 
        if (cls==="click-expands") removeClassName(tocblock,"auto-expands");
        if (expand && !hasClassName(tocblock,cls)) {
          toggleClassName(tocblock,cls); 
        }
        else if (!expand && hasClassName(tocblock,cls)) {
          toggleClassName(tocblock,cls);
          item.firstElementChild.className = "unexpanded";
        }
        
        // set expansion icon
        if (hasClassName(tocblock,"auto-expands") || hasClassName(tocblock,"click-expands")) {
          item.firstElementChild.className = "expanded";   
        }
        else {
          item.firstElementChild.className = "unexpanded";
        }
      }
      
      // Expand a single item in the toc (and unexpand others).
      function itemExpandOne(item) {
        // unexpand anything that was expanded
        [].forEach.call( document.querySelectorAll(".tocitem"), function(item) {
          removeClassName(item,"current");
          itemExpand(item,"auto-expands",false);      
        });
        addClassName(item,"current");
        // expand the chain of parent blocks
        var tocblock = null;
        var toc = item.nextElementSibling;
        if (toc && hasClassName(toc,"tocblock")) { 
          tocblock = toc;
        }
        else {
          tocblock = item.parentElement;
        }
        while(tocblock != null && !hasClassName(tocblock,"toc")) {
          if (hasClassName(tocblock,"tocblock")) {
            item = tocblock.previousElementSibling;
            if (item != null) itemExpand(item,"auto-expands",true);
          }
          tocblock = tocblock.parentElement;
        }
      }
      
      // Auto expand the toc at current  position in the document 
      function expandToc() {
        // find the first section heading that is visible in the viewport 
        var current = null;
        [].every.call( document.querySelectorAll(".tocitem"), function(item) {
          var target = document.getElementById( item.getAttribute("data-toc-target") );
          var pos = viewportPosition(target);
          if (pos <= 0) current = item;
          return (pos < 0);
        });
        // if found, expand the corresponding item
        if (current != null) itemExpandOne(current);
      }
      
      document.addEventListener("load", function(ev) { expandToc(); });
      document.addEventListener("resize", function(ev) { expandToc(); });
      
      // fire at end of scrolling
      var scrollHandler = null;
      document.addEventListener("scroll", function(ev) {
        if (scrollHandler) clearTimeout(scrollHandler);
        scrollHandler = setTimeout( function() {
          scrollHandler = null;
          if (afterScroll) {
            afterScroll();
            afterScroll = null;
          }
          else {
            expandToc();
          }
        }, 50 );
      });
      
      // ---------------------------------------------
      // Install event handlers for all items in the TOC
      // ---------------------------------------------
      [].forEach.call( document.querySelectorAll(".tocitem"), function(item) {
        // only for toc items with a target
        var target = document.getElementById( item.getAttribute("data-toc-target") );
        if (!target) return;
        
        // ensure every tocblock has a expansion icon in front
        // (the optional nested tocblock follows the item)
        var tocblock = null;
        var toc = item.nextElementSibling;  
        if (toc && hasClassName(toc,"tocblock")) { 
          tocblock = toc;
          item.innerHTML = "<span class='unexpanded'></span>" + item.innerHTML;   
        } 
        
        // on a click
        item.addEventListener( "click", function() {
          // expand this toc item and set expansion icon
          itemExpand(item,"click-expands");
          // after navigation, align the heading with the toc
          afterScroll = (function() {
            alignHeading(target);
          });    
        }); 
      });
</script>

</html>
