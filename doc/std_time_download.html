
<!DOCTYPE html>
<html>
<!-- NO_CLICK_TRACKING -->

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>std/time/download documentation</title>
</head>

<body class="koka doc body"><div class="madoko">
<h1><a class="link" href="std_time_download-source.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>download</span></a><a class="link" href="toc.html"><span class="toc-link">&#x25b2;toc</span></a></h1>
<div class="toc code"><ul class="toc"><li><a class="link" href="#download_latest"><span class="kw">fun</span>&nbsp;download<span class="dash">-</span>latest</a></li><li><a class="link" href="#load_latest"><span class="kw">fun</span>&nbsp;load<span class="dash">-</span>latest</a></li><li><a class="link" href="#load_leaps_table"><span class="kw">fun</span>&nbsp;load<span class="dash">-</span>leaps<span class="dash">-</span>table</a></li><li><a class="link" href="#ts_utc_load"><span class="kw">fun</span>&nbsp;ts<span class="dash">-</span>utc<span class="dash">-</span>load</a></li></ul></div>
<div class="doc koka comment">

<p class="p noindent"> Automatic downloading of time information.
</p>
<p class="p indent">   Provides auto download functions to use the latest leap second tables,
   time zone information, and UT1 tables.
</p></div>
<div class="decl" id="download_latest"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_download-source.html#download_latest">download<span class="dash">-</span>latest</a></span>( <span class="tp tpp">url</span> <span class="tp sp">:</span>&nbsp;<a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">parse</span> <span class="tp sp">:</span>&nbsp;<span class="tp sp">(</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span>, <span class="tp tpp">expire</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <span class="tp tpp">cache</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_os_path.html#type_space_path"><span class="tp">path</span><span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp">V</span></span></a>, <span class="tp tpp">current</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span>, <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">error<span class="dash">-</span>prefix</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">verbose</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> ) <span class="tp sp">:</span>&nbsp;<span class="tp sp">&lt;</span><a class="pp" href="std_core.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core.html#type_space_file"><span class="tp">file</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>file: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core.html#type_space_net"><span class="tp">net</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>net: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">X</span></span></a><span class="tp sp">&gt;</span> <span class="tp tv">a</span></div><div class="doc koka comment">

<p class="p noindent">   Download a file from <code class="koka">url</code> and cache it locally in file <code class="koka">cache</code> (=<code class="koka"><a class="pp" href="std_os_path.html#path">path<span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">path</span></span></a>(<span class="st">&#34;&#34;</span>)</code>) if
   that path is not empty. The <code class="koka">parse</code> function parses the downloaded content. The
   optional <code class="koka"><a class="pp" href="std_time_utc.html#expire">expire<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>expire: <span class="tp sp">(</span><span class="tp">leaps<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">instant</span></span></a></code> (=<code class="koka">{<a class="pp" href="std_core.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a>}</code>) function can return an optional expiration date from the content
   which is used to check if the downloaded content is newer than the optional current
   data <code class="koka">current</code> (=<code class="koka"><a class="pp" href="std_core.html#con_space_Nothing"><span class="co">Nothing</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Nothing: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span></span></a></code>). The <code class="koka">download<span class="dash">-</span>timeout</code> gives the download timeout.
   The <code class="koka">error<span class="dash">-</span>prefix</code> is prepended to any error messages (=<code class="koka">download failed</code>).
   Set the optional parameter <code class="koka">verbose</code> to <code class="koka"><a class="pp" href="std_core.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code> to see trace messages on downloads or errors.
</p></div></div>
<div class="decl" id="load_latest"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_download-source.html#load_latest">load<span class="dash">-</span>latest</a></span>( <span class="tp tpp">fname</span> <span class="tp sp">:</span>&nbsp;<a class="pp" href="std_os_path.html#type_space_path"><span class="tp">path</span><span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp">V</span></span></a>, <span class="tp tpp">url</span> <span class="tp sp">:</span>&nbsp;<a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">parse</span> <span class="tp sp">:</span>&nbsp;<span class="tp sp">(</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span>, <span class="tp tpp">expire</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><a class="pp" href="std_time_instant.html#type_space_instant"><span class="tp">instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>instant: <span class="tp">V</span></span></a><span class="tp sp">&gt;</span>, <span class="tp tpp">current</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_maybe"><span class="tp">maybe</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>maybe: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">&gt;</span>, <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">error<span class="dash">-</span>prefix</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">verbose</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> ) <span class="tp sp">:</span>&nbsp;<span class="tp sp">&lt;</span><a class="pp" href="std_core.html#type_space_ndet"><span class="tp">ndet</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>ndet: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core.html#type_space_file"><span class="tp">file</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>file: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core.html#type_space_net"><span class="tp">net</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>net: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_core.html#type_space_exn"><span class="tp">exn</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>exn: <span class="tp">X</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <span class="tp tv">a</span></div><div class="doc koka comment">

<p class="p noindent">   Load a file from a cached file <code class="koka">fname</code> or URL <code class="koka">url</code>. The file is parsed with
   the <code class="koka">parse</code> function. Given the result of <code class="koka">parse</code>, a future expiration date may
   be given by the file through the <code class="koka"><a class="pp" href="std_time_utc.html#expire">expire<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>expire: <span class="tp sp">(</span><span class="tp">leaps<span class="dash">-</span>table</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">instant</span></span></a></code> function. This is used for example in leap second
   files to prevent downloading too often. There may also be a <code class="koka">current</code> value that is returned
   if any error occurs. The <code class="koka">download<span class="dash">-</span>timeout</code> gives the download time out, while the
   <code class="koka">download<span class="dash">-</span>delay</code> gives the minimum amount of time that must have passed before a newer
   file is downloaded again. The <code class="koka">error<span class="dash">-</span>prefix</code> is prepended to any error messages (=<code class="koka">load cached</code>).
   Set the optional parameter <code class="koka">verbose</code> to <code class="koka"><a class="pp" href="std_core.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code> to see trace messages on downloads or errors.
<br>
   The function first checks if the <code class="koka">current</code> data is not yet expired and returns it directly if
   it is still valid. Otherwise, it attempts to read and parse the file from <code class="koka">fname</code>. If it is
   valid and newer than <code class="koka">current</code> and not yet expired, it is returned.
   Otherwise, if <code class="koka">url</code> is not empty, it calls <code class="koka"><a class="pp" href="#download_latest">download<span class="dash">-</span>latest<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>download<span class="fslash last">/</span></span>download<span class="dash">-</span>latest: <span class="tp kw">forall</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span> <span class="tp sp">(</span><span class="tp tpp">url</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">parse</span> <span class="tp kw op">:</span> <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">expire</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp">instant</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">cache</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">path</span><span class="tp sp">,</span> <span class="tp tpp">current</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">maybe</span><span class="tp sp">&#60;</span><span class="tp tv">a</span><span class="tp sp">&#62;</span><span class="tp sp">,</span> <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">duration</span><span class="tp sp">,</span> <span class="tp tpp">error<span class="dash">-</span>prefix</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">verbose</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp sp">&#60;</span><span class="tp">ndet</span><span class="tp sp">,</span><span class="tp">file</span><span class="tp sp">,</span><span class="tp">net</span><span class="tp sp">,</span><span class="tp">async</span><span class="tp sp">,</span><span class="tp">exn</span><span class="tp sp">&#62;</span> <span class="tp tv">a</span></span></a></code> to download and cache the file.
</p></div></div>
<div class="decl" id="load_leaps_table"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_download-source.html#load_leaps_table">load<span class="dash">-</span>leaps<span class="dash">-</span>table</a></span>( <span class="tp tpp">fname</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_os_path.html#type_space_path"><span class="tp">path</span><span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp">V</span></span></a>, <span class="tp tpp">url</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">verbose</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> ) <span class="tp sp">:</span>&nbsp;<span class="tp sp">&lt;</span><a class="pp" href="std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_time_utc.html#type_space_leaps_table"><span class="tp">leaps<span class="dash">-</span>table</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc<span class="fslash last">/</span></span>leaps<span class="dash">-</span>table: <span class="tp">V</span></span></a></div><div class="doc koka comment">

<p class="p noindent">   Load the latest leap second information from file <code class="koka">fname</code>
   (= <code class="koka"><span class="st">&#34;config/leap-seconds.list&#34;</span></code> in the application directory).
   If the file is not present, it will be downloaded from <code class="koka">url</code>. The default <code class="koka">url</code> is:<br>
   <a href="https://www.ietf.org/timezones/data/leap-seconds.list" class="texturl monospace">https://&#8203;www.&#8203;ietf.&#8203;org/&#8203;timezones/&#8203;data/&#8203;leap-&#8203;seconds.&#8203;list</a><br>
   Set the <code class="koka">url</code> to the empty string to suppress automatic downloading.
   If the file is older than <code class="koka">download<span class="dash">-</span>delay</code> (=<code class="koka"><span class="number">4</span><span class="kw op">.</span><a class="pp" href="std_time_duration.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>) the file is automatically refreshed from <code class="koka">url</code>.
   The <code class="koka">download<span class="dash">-</span>timeout</code> (=<code class="koka"><span class="number">5</span><span class="kw op">.</span>seconds</code>) gives the maximum time for downloading to finish.
   Set the optional parameter <code class="koka">verbose</code> to <code class="koka"><a class="pp" href="std_core.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code> to see trace messages on downloads or errors.
</p></div></div>
<div class="decl" id="ts_utc_load"><div class="header code"><span class="def"><span class="kw">fun</span>&nbsp;<a class="link" href="std_time_download-source.html#ts_utc_load">ts<span class="dash">-</span>utc<span class="dash">-</span>load</a></span>( <span class="tp tpp">fname</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_os_path.html#type_space_path"><span class="tp">path</span><span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path<span class="fslash last">/</span></span>path: <span class="tp">V</span></span></a>, <span class="tp tpp">url</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>delay</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">download<span class="dash">-</span>timeout</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_time_duration.html#type_space_duration"><span class="tp">duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>duration: <span class="tp">V</span></span></a>, <span class="tp tpp">verbose</span> <span class="tp sp">:</span>&nbsp;<span class="tp op">?</span><a class="pp" href="std_core.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> ) <span class="tp sp">:</span>&nbsp;<span class="tp sp">&lt;</span><a class="pp" href="std_core.html#type_space_io"><span class="tp">io</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>io: <span class="tp">E</span></span></a><span class="tp sp">,</span><a class="pp" href="std_async.html#type_space_async"><span class="tp">async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async<span class="fslash last">/</span></span>async: <span class="tp">HX</span></span></a><span class="tp sp">&gt;</span> <a class="pp" href="std_time_instant.html#type_space_timescale"><span class="tp">timescale</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant<span class="fslash last">/</span></span>timescale: <span class="tp">V</span></span></a></div><div class="doc koka comment">

<p class="p noindent">   Construct a UTC time scale using the latest IERS leap second information from file <code class="koka">fname</code>
   (= <code class="koka"><span class="st">&#34;config/leap-seconds.list&#34;</span></code> in the application directory).
   If the file is not present, it will be downloaded from <code class="koka">url</code>. The default <code class="koka">url</code> is:<br>
   <a href="https://www.ietf.org/timezones/data/leap-seconds.list" class="texturl monospace">https://&#8203;www.&#8203;ietf.&#8203;org/&#8203;timezones/&#8203;data/&#8203;leap-&#8203;seconds.&#8203;list</a><br>
   Set the <code class="koka">url</code> to the empty string to suppress automatic downloading.
   If the file is older than <code class="koka">download<span class="dash">-</span>delay</code> (=<code class="koka"><span class="number">4</span><span class="kw op">.</span><a class="pp" href="std_time_duration.html#weeks">weeks<span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration<span class="fslash last">/</span></span>weeks: <span class="tp sp">(</span><span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-&gt;</span> <span class="tp">duration</span></span></a></code>) the file is automatically refreshed from <code class="koka">url</code>.
   The <code class="koka">download<span class="dash">-</span>timeout</code> (=<code class="koka"><span class="number">5</span><span class="kw op">.</span>seconds</code>) gives the maximum time for downloading to finish.
   Set the optional parameter <code class="koka">verbose</code> to <code class="koka"><a class="pp" href="std_core.html#con_space_True"><span class="co">True</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a></code> to see trace messages on downloads or errors.
</p></div></div>
<div class="decl" id="-private-imports"><div class="header code"><span class="def"><span class="kw">private import</span>&nbsp;<span class="code"><a class="pp" href="std_core.html"><span class="mo">std<span class="fslash">/</span>core</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core</span></span></a></span>, <span class="code"><a class="pp" href="std_async.html"><span class="mo">std<span class="fslash">/</span>async</span><span class="pc"><span class="mo">std<span class="fslash">/</span>async</span></span></a></span>, <span class="code"><a class="pp" href="std_os_file.html"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>file</span><span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>file</span></span></a></span>, <span class="code"><a class="pp" href="std_os_path.html"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path</span><span class="pc"><span class="mo">std<span class="fslash">/</span>os<span class="fslash">/</span>path</span></span></a></span>, <span class="code"><a class="pp" href="std_time_duration.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>duration</span></span></a></span>, <span class="code"><a class="pp" href="std_time_instant.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>instant</span></span></a></span>, <span class="code"><a class="pp" href="std_time_utc.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>utc</span></span></a></span>, <span class="code"><a class="pp" href="std_time_chrono.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>chrono</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>chrono</span></span></a></span>, <span class="code"><a class="pp" href="std_time_calendar.html"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar</span><span class="pc"><span class="mo">std<span class="fslash">/</span>time<span class="fslash">/</span>calendar</span></span></a></span></span></div></div>
</div></body>
</html>

<span data-line=""></span>